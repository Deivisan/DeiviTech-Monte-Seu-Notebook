<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeiviTech: Notebooks Personalizados (v3 - Merged Beta)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --color-bg-main-start: #073B4C; 
            --color-bg-main-end: #0B4F6C;
            --color-text-main: #F0F4F8;
            --color-text-card: #073B4C;
            --color-card-bg: #FFFFFF;
            --color-card-bg-alt: #F8F9FA; 
            --color-card-border: #D1E0E0; 
            --color-primary: #118AB2;
            --color-primary-hover: #0E6A8A;
            --color-primary-light: #E0F7FA;
            --color-secondary: #06D6A0;
            --color-secondary-hover: #05A980;
            --color-secondary-text: #073B4C;
            --color-accent-yellow: #FFD166;
            --color-accent-red: #FF6B6B;            --color-accent-red-hover: #E05050;
            --color-border-subtle: rgba(17, 138, 178, 0.2);
            --color-selected-bg: var(--color-primary);
            --color-selected-text: #FFFFFF;
            --color-selected-border: var(--color-primary);
            --color-disabled-bg: #F1F3F5;
            --color-disabled-text: #AEB6BF;
            --color-disabled-border: #E0E0E0;
            --color-text-secondary: #5A6B8C;
            --shadow-card: 0 8px 12px -4px rgba(0, 0, 0, 0.06), 0 3px 5px -3px rgba(0, 0, 0, 0.08);
            --shadow-card-hover: 0 15px 20px -5px rgba(0, 0, 0, 0.08), 0 6px 8px -5px rgba(0, 0, 0, 0.1);
        }        body.dark-mode {
            --color-bg-main-start: #0A192F; 
            --color-bg-main-end: #132F4C;
            --color-text-main: #CCD6F6;
            --color-text-card: #E0F7FA; 
            --color-card-bg: #112240; 
            --color-card-bg-alt: #0A192F; 
            --color-card-border: #233554; 
            --color-border-subtle: rgba(100, 255, 218, 0.1); 
            --color-primary: #64FFDA; 
            --color-primary-hover: #52D0B8;
            --color-primary-light: #1A3A5A; 
            --color-secondary: #FFD166; 
            --color-secondary-text: #0A192F;
            --color-text-secondary: #8B9DC3;
            --color-disabled-bg: #1A2A47;
            --color-disabled-text: #5A6B8C;
            --color-disabled-border: #2A3A5A;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--color-bg-main-start) 0%, var(--color-bg-main-end) 100%);
            color: var(--color-text-main);
            scroll-behavior: smooth;
            transition: background-color 0.3s ease, color 0.3s ease;
            position: relative;
            overflow-x: hidden;
        }        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(17, 138, 178, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(6, 214, 160, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 40% 80%, rgba(255, 209, 102, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 60% 20%, rgba(17, 138, 178, 0.08) 0%, transparent 15%),
                linear-gradient(45deg, transparent 40%, rgba(6, 214, 160, 0.02) 50%, transparent 60%),
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cg fill='%23118AB2' fill-opacity='0.06'%3E%3Cpath d='M40 40c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm-20-20c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm40 0c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm-20 40c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm-40 0c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4zm80 0c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z'/%3E%3C/g%3E%3C/svg%3E");
            z-index: -2;
            opacity: 1;
            animation: techBgAnimation 180s linear infinite;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 60%, rgba(6, 214, 160, 0.08) 70%, transparent 80%),
                linear-gradient(135deg, transparent 60%, rgba(17, 138, 178, 0.08) 70%, transparent 80%),
                linear-gradient(315deg, transparent 70%, rgba(255, 209, 102, 0.05) 80%, transparent 90%),
                conic-gradient(from 0deg at 50% 50%, transparent 0deg, rgba(17, 138, 178, 0.02) 90deg, transparent 180deg, rgba(6, 214, 160, 0.02) 270deg, transparent 360deg);
            z-index: -1;
            pointer-events: none;
            animation: techBgWaves 240s ease-in-out infinite alternate;
        }
        
        @keyframes techBgAnimation {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-5px, -10px) rotate(90deg); }
            50% { transform: translate(10px, 5px) rotate(180deg); }
            75% { transform: translate(-3px, 8px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }
        
        @keyframes techBgWaves {
            0% { 
                background-position: 0% 0%, 100% 100%, 50% 50%, 25% 75%;
                opacity: 0.6;
            }
            50% { 
                background-position: 100% 25%, 0% 75%, 75% 25%, 50% 50%;                opacity: 0.8;
            }
            100% { 
                background-position: 50% 50%, 50% 50%, 100% 100%, 75% 25%;
                opacity: 0.6;
            }
        }
        
        /* Part√≠culas flutuantes */
        .tech-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        
        .tech-particle {
            position: absolute;
            background: linear-gradient(45deg, rgba(17, 138, 178, 0.6), rgba(6, 214, 160, 0.6));
            border-radius: 50%;
            animation: float-up 15s linear infinite;
            opacity: 0;
        }
        
        .tech-particle:nth-child(odd) {
            background: linear-gradient(45deg, rgba(6, 214, 160, 0.5), rgba(255, 209, 102, 0.5));
            animation-duration: 12s;        }
        
        .tech-particle:nth-child(3n) {
            background: linear-gradient(45deg, rgba(255, 209, 102, 0.4), rgba(17, 138, 178, 0.4));
            animation-duration: 18s;
        }
        
        @keyframes float-up {
            0% {
                opacity: 0;
                transform: translateY(100vh) translateX(0px) scale(0);
            }
            10% {
                opacity: 1;
                transform: translateY(90vh) translateX(10px) scale(0.5);
            }
            50% {
                opacity: 0.8;
                transform: translateY(50vh) translateX(-20px) scale(1);
            }
            90% {
                opacity: 0.3;
                transform: translateY(10vh) translateX(30px) scale(0.8);
            }
            100% {
                opacity: 0;
                transform: translateY(-10vh) translateX(0px) scale(0);
            }
        }
        
        /* Efeito de ondas no fundo */
        @keyframes wave {
            0%, 100% { transform: translateX(0px) translateY(0px); }
            25% { transform: translateX(10px) translateY(-5px); }
            50% { transform: translateX(-5px) translateY(10px); }
            75% { transform: translateX(-10px) translateY(-10px); }
        }
        
        .tech-wave {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, transparent 30%, rgba(17, 138, 178, 0.03) 70%);
            z-index: -2;
            animation: wave 20s ease-in-out infinite;
        }
        
        .beta-watermark {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: rgba(255, 209, 102, 0.85);
            color: var(--color-text-card);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            z-index: 1000;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        h1 { color: var(--color-secondary); }
        h2, h3 { color: var(--color-primary); }
        h2 .section-icon, h3 .section-icon {
            margin-right: 0.75rem;
            font-size: 1.3em; 
            color: var(--color-secondary);
            vertical-align: middle;
        }
        body.dark-mode h2 .section-icon, body.dark-mode h3 .section-icon {
             color: var(--color-primary); /* Primary becomes the accent icon color in dark for titles */
        }
        body.dark-mode .option-item .section-icon, body.dark-mode .service-item .section-icon { color: var(--color-primary) !important;}


        .card {
            background-color: var(--color-card-bg);
            color: var(--color-text-card);
            border-radius: 0.85rem; 
            box-shadow: var(--shadow-card);
            padding: 1.75rem; 
            margin-bottom: 2.25rem; 
            transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease-out, background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            opacity: 0;
            transform: translateY(25px);
            border: 1px solid var(--color-card-border);
        }
        .card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-card-hover);
        }
        .card.in-view {
            opacity: 1;
            transform: translateY(0);
        }

        .option-item { 
            display: flex;
            flex-direction: column; 
            align-items: flex-start; 
            padding: 1rem; 
            border-radius: 0.6rem; 
            border: 1px solid var(--color-border-subtle);
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.25s ease-in-out, background-color 0.3s ease, border-color 0.3s ease;
            background-color: var(--color-card-bg-alt); 
        }
        .option-item:hover {
            background-color: var(--color-primary-light);
            border-color: var(--color-primary);
            transform: scale(1.02); 
            box-shadow: 0 4px 10px rgba(17, 138, 178, 0.15);
        }
        body.dark-mode .option-item:hover {
            box-shadow: 0 4px 10px rgba(100, 255, 218, 0.15); /* Adjust shadow for dark primary */
        }
        .option-item.selected {
            background-color: var(--color-selected-bg);
            border-color: var(--color-selected-border);
            box-shadow: 0 0 12px rgba(17, 138, 178, 0.6);
            transform: scale(1.01);
        }
        body.dark-mode .option-item.selected {
             box-shadow: 0 0 12px rgba(100, 255, 218, 0.6); /* Adjust shadow for dark primary */
        }
        .option-item.selected .option-content p,
        .option-item.selected .option-content .price-text,
        .option-item.selected .option-content .text-xs,
        .option-item.selected .option-content .text-name,
        .option-item.selected .option-content .text-description,
        .option-item.selected .option-content .text-details,
        .option-item.selected .option-content i { 
            color: var(--color-selected-text) !important;
        }
        body.dark-mode .option-item.selected .option-content p,
        body.dark-mode .option-item.selected .option-content .price-text,
        body.dark-mode .option-item.selected .option-content .text-xs,
        body.dark-mode .option-item.selected .option-content .text-name,
        body.dark-mode .option-item.selected .option-content .text-description,
        body.dark-mode .option-item.selected .option-content .text-details,
        body.dark-mode .option-item.selected .option-content i { 
            color: var(--color-secondary-text) !important; /* For bright primary in dark mode */
        }


        .option-item.disabled {
            background-color: var(--color-disabled-bg);
            border-color: var(--color-disabled-border);
            opacity: 0.55; 
            cursor: not-allowed;
            transform: scale(1); 
        }
        .option-item.disabled:hover {
            background-color: var(--color-disabled-bg);
            border-color: var(--color-disabled-border);
            box-shadow: none;
            transform: scale(1);
        }
        .option-item.disabled .option-content p,
        .option-item.disabled .option-content .price-text,
        .option-item.disabled .option-content .text-xs,
        .option-item.disabled .option-content i {
            color: var(--color-disabled-text) !important;
        }
        .option-content .text-name { color: var(--color-text-card); font-weight: 600; font-size: 1.05rem; }
        .option-content .text-description { color: #525252; font-size: 0.875rem; margin-top: 0.25rem; }
        body.dark-mode .option-content .text-description { color: #a8b2d1; }
        .option-content .price-text { color: var(--color-primary); font-weight: 700; font-size: 1rem; margin-top: 0.5rem; }
        .option-content .text-details { color: #555; font-size: 0.8rem; margin-top: 0.25rem; }
        body.dark-mode .option-content .text-details { color: #8892b0; }

        #performance-bar-container { width: 100%; background-color: #e0e0e0; border-radius: 0.5rem; margin-top: 0.5rem; height: 28px; overflow: hidden; border: 1px solid #ccc; }
        body.dark-mode #performance-bar-container { background-color: #2a3a5a; border-color: #45567d; }
        #performance-bar { width: 0%; height: 100%; background-color: var(--color-secondary); text-align: center; line-height: 28px; color: var(--color-secondary-text); font-weight: bold; font-size: 0.9rem; transition: width 0.6s cubic-bezier(0.25, 0.1, 0.25, 1), background-color 0.6s ease-in-out; white-space: nowrap; padding: 0 10px; }
        .performance-text { color: var(--color-text-card); font-size: 0.9rem; margin-top:0.35rem; font-weight:500; }
        .energy-tendency-text { color: var(--color-text-card); font-size: 0.85rem; margin-top:0.25rem; font-weight:500; }


        .sticky-summary { 
            position: sticky; top: 1.5rem; z-index: 10; 
            background-color: var(--color-card-bg-alt); 
            border: 2px solid var(--color-primary); 
            border-radius: 0.85rem; 
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        @media (max-width: 1023px) { .sticky-summary { position: relative; top: 0; margin-bottom: 2rem; }}
        .summary-item { display: flex; align-items: center; margin-bottom: 0.4rem; font-size: 0.9rem;}
        .summary-item i { color: var(--color-primary); margin-right: 0.6rem; width: 18px; text-align: center; }
        .summary-item-name { color: var(--color-text-card); flex-grow: 1; }
        .summary-tradein-price { color: var(--color-accent-red); font-weight: 600; }

        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(7, 59, 76, 0.9); backdrop-filter: blur(8px); justify-content: center; align-items: center; }
        body.dark-mode .modal { background-color: rgba(10, 25, 47, 0.9); }
        .modal-content { 
            background-color: var(--color-card-bg); 
            color: var(--color-text-card); 
            margin: auto; padding: 2rem 2.5rem; 
            border: 2px solid var(--color-primary); 
            border-radius: 0.85rem; width: 90%; max-width: 650px; 
            box-shadow: 0 0 30px rgba(17, 138, 178, 0.4); 
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        body.dark-mode .modal-content { box-shadow: 0 0 30px rgba(100, 255, 218, 0.4); }
        .close-button { color: var(--color-accent-red); float: right; font-size: 30px; font-weight: bold; transition: color 0.2s ease; }
        .close-button:hover, .close-button:focus { color: var(--color-accent-red-hover); text-decoration: none; cursor: pointer; }
        
        .mode-toggle-btn { background-color: transparent; color: var(--color-text-main); border: 2px solid var(--color-secondary); transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out; }
        .mode-toggle-btn.active { background-color: var(--color-secondary); color: var(--color-secondary-text); box-shadow: 0 2px 8px rgba(6, 214, 160, 0.4); }
        body.dark-mode .mode-toggle-btn.active { box-shadow: 0 2px 8px rgba(255, 209, 102, 0.4); } /* Adjust for dark mode secondary */
        .mode-toggle-btn:hover:not(.active) { background-color: rgba(6, 214, 160, 0.15); }
        body.dark-mode .mode-toggle-btn:hover:not(.active) { background-color: rgba(var(--color-secondaryRgbForAlpha), 0.15); } /* Adjust for dark mode secondary */
        
        /* Classes para bot√µes */
        .btn-primary {
            background-color: var(--color-primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-primary:hover {
            background-color: var(--color-primary-hover);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--color-secondary);
            color: var(--color-secondary-text);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            background-color: var(--color-secondary-hover);
            transform: translateY(-1px);
        }
        
        .btn-accent-yellow {
            background-color: var(--color-accent-yellow);
            color: var(--color-text-card);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-accent-yellow:hover {
            background-color: #E6BC47;
            transform: translateY(-1px);
        }
        /* Note: --color-secondaryRgbForAlpha would need to be defined in JS if secondary changes significantly */

        
        #quality-slider { -webkit-appearance: none; appearance: none; height: 10px; background: #ccc; outline: none; opacity: 0.9; transition: opacity .2s; border-radius: 5px; }
        body.dark-mode #quality-slider { background: #45567d; }
        #quality-slider:hover { opacity: 1; }
        #quality-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 22px; height: 22px; background: var(--color-secondary); cursor: pointer; border-radius: 50%; border: 3px solid var(--color-card-bg); box-shadow: 0 0 5px rgba(0,0,0,0.2); }
        #quality-slider::-moz-range-thumb { width: 22px; height: 22px; background: var(--color-secondary); cursor: pointer; border-radius: 50%; border: 3px solid var(--color-card-bg); box-shadow: 0 0 5px rgba(0,0,0,0.2); }
        .quality-label-active { font-weight: bold; color: var(--color-secondary); transform: scale(1.1); }

        .btn { padding: 0.85rem 1.75rem; border-radius: 0.6rem; font-weight: 600; transition: all 0.2s ease; text-align: center; }
        .btn:active { transform: scale(0.97); }
        .btn-primary { background-color: var(--color-primary); color: white; }
        body.dark-mode .btn-primary { color: var(--color-secondary-text); /* Ensure contrast for bright primary */}
        .btn-primary:hover { background-color: var(--color-primary-hover); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .btn-secondary { background-color: var(--color-secondary); color: var(--color-secondary-text); }
        .btn-secondary:hover { background-color: var(--color-secondary-hover); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .btn-danger { background-color: var(--color-accent-red); color: white; }
        .btn-danger:hover { background-color: var(--color-accent-red-hover); box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .btn-lg { padding: 1rem 2rem; font-size: 1.1rem;} /* New class for larger button */


        .file-input-styled { color: var(--color-text-card); }
        .file-input-styled::file-selector-button { background-color: var(--color-primary-light); color: var(--color-primary); border: 1px solid var(--color-primary); padding: 0.6rem 1.2rem; border-radius: 0.5rem; margin-right: 1rem; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease; font-weight: 500; }
        .file-input-styled::file-selector-button:hover { background-color: var(--color-primary); color: white; }
        body.dark-mode .file-input-styled::file-selector-button:hover { color: var(--color-secondary-text); }
        
        select.custom-select, input[type="number"].custom-input, input[type="text"].custom-input, textarea.custom-textarea {
            background-color: var(--color-card-bg-alt); color: var(--color-text-card); border: 1px solid var(--color-border-subtle);
            padding: 0.85rem; border-radius: 0.6rem; box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        select.custom-select { appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23118AB2'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1.5em 1.5em; }
        body.dark-mode select.custom-select { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%2364FFDA'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd'/%3E%3C/svg%3E");}
        select.custom-select:focus, input.custom-input:focus, textarea.custom-textarea:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(17, 138, 178, 0.25); }
        body.dark-mode select.custom-select:focus, body.dark-mode input.custom-input:focus, body.dark-mode textarea.custom-textarea:focus { box-shadow: 0 0 0 3px rgba(100,255,218,0.25); }


        .payment-logos i { font-size: 2.5rem; margin: 0 10px; color: var(--color-text-main); opacity:0.8; transition: color 0.3s ease, opacity 0.3s ease, transform 0.3s ease; }
        .payment-logos i:hover { color: var(--color-secondary); opacity:1; transform: scale(1.1); }
        
        .contact-links a { color: var(--color-secondary); text-decoration: none; transition: color 0.2s ease; margin: 0 0.5rem; }
        .contact-links a:hover { color: var(--color-primary-light); text-decoration: underline; }
        body.dark-mode .contact-links a:hover { color: var(--color-primary); /* Dark mode primary might be brighter */}

        .checkbox-option-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid var(--color-border-subtle);
            margin-bottom: 0.5rem;
            cursor: pointer;
            background-color: var(--color-card-bg-alt);
            transition: all 0.2s ease-in-out, background-color 0.3s ease, border-color 0.3s ease;
        }
        .checkbox-option-item:hover {
            border-color: var(--color-primary);
            background-color: var(--color-primary-light);
        }
        .checkbox-option-item input[type="checkbox"] {
            appearance: none;
            width: 1.25em;
            height: 1.25em;
            border: 2px solid var(--color-primary);
            border-radius: 0.25em;
            margin-right: 0.75em;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .checkbox-option-item input[type="checkbox"]:checked {
            background-color: var(--color-primary);
            border-color: var(--color-primary);
        }
        .checkbox-option-item input[type="checkbox"]:checked::before {
            content: '\\f00c'; 
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: white; /* Default checkmark color */
            font-size: 0.8em;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        body.dark-mode .checkbox-option-item input[type="checkbox"]:checked::before {
            color: var(--color-secondary-text); /* Checkmark color for dark mode bright primary */
        }

        .checkbox-option-item label { cursor: pointer; flex-grow: 1; }
        
        /* Custom checkbox style for services tab */
        .service-item input[type="checkbox"].custom-service-checkbox {
            appearance: none; width: 1.5em; height: 1.5em; border: 2px solid var(--color-primary); border-radius: 0.35em; cursor: pointer; position: relative; transition: background-color 0.2s, border-color 0.2s; flex-shrink: 0;
        }
        .service-item input[type="checkbox"].custom-service-checkbox:checked { background-color: var(--color-primary); border-color: var(--color-primary); }
        .service-item input[type="checkbox"].custom-service-checkbox:checked::before { content: '\\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: white; font-size: 1em; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        body.dark-mode .service-item input[type="checkbox"].custom-service-checkbox:checked::before { color: var(--color-secondary-text); }


        .tab-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem 0.5rem 0 0;
            font-weight: 600;
            cursor: pointer;
            background-color: var(--color-primary-light);
            color: var(--color-primary);
            border: 1px solid var(--color-border-subtle);
            border-bottom: none;
            margin-right: 0.25rem;
            transition: background-color 0.2s, color 0.2s, border-color 0.2s;
            white-space: nowrap; 
        }
        .tab-button.active {
            background-color: var(--color-primary);
            color: white; 
            border-bottom: 1px solid var(--color-primary); 
        }
        body.dark-mode .tab-button.active {
            color: var(--color-secondary-text); 
        }
        .tab-content {
            display: none;
            border: 1px solid var(--color-border-subtle);
            border-top: none; 
            padding: 1.5rem;
            border-radius: 0 0 0.5rem 0.5rem;
            background-color: var(--color-card-bg); 
            color: var(--color-text-card);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        .tab-content.active { display: block; }
        
        .login-btn-placeholder {
            background-color: transparent;
            color: var(--color-text-main);
            border: 2px solid var(--color-text-main);
            opacity: 0.7;
            cursor: help;
        }
        .tutorial-details { /* For trade-in and service details */
            background-color: var(--color-card-bg-alt);
            border: 1px solid var(--color-border-subtle);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 0.75rem;
            color: var(--color-text-card); /* Ensure text color matches */
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .service-item {
            padding: 1rem; /* More padding */
            border: 1px solid var(--color-border-subtle);
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            background-color: var(--color-card-bg-alt);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .service-item h4 {
            color: var(--color-primary);
            font-weight: 600;
        }
        .service-item p {
            font-size: 0.9rem;
            color: #525252;
        }
        body.dark-mode .service-item p { color: #a8b2d1; }
        .service-item .price {
            font-weight: bold;
            color: var(--color-secondary);
            margin-top: 0.25rem;
        }
        .service-item .details-toggle { color: var(--color-primary); cursor: pointer; font-size: 0.9em; }
        /* CORRECTION: Removed 'display: none' to allow the <details> tag to control visibility */
        .service-item .details-content { margin-top: 0.5rem; padding-left: 1rem; border-left: 2px solid var(--color-border-subtle); font-size: 0.85rem;}

        .theme-toggle-btn {
            background-color: transparent;
            color: var(--color-text-main);
            border: 2px solid var(--color-secondary);
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            font-size: 1.25rem; 
            transition: all 0.2s ease;
        }
        .theme-toggle-btn:hover {
            background-color: rgba(var(--color-secondaryRgbForAlpha, 6, 214, 160), 0.15); /* Fallback for secondary rgb */
            box-shadow: 0 0 8px rgba(var(--color-secondaryRgbForAlpha, 6, 214, 160), 0.3);
        }
        .advanced-mode-tab { 
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem 0.5rem 0 0;
            font-weight: 600;
            cursor: not-allowed;
            background-color: var(--color-disabled-bg);
            color: var(--color-disabled-text);
            border: 1px solid var(--color-disabled-border);
            border-bottom: none;
            margin-right: 0.25rem;
            opacity: 0.7;
        }
        .advanced-mode-tab.functional { 
             cursor: pointer;
             opacity: 1;
             background-color: var(--color-primary-light);
             color: var(--color-primary);
             border: 1px solid var(--color-border-subtle);
        }
        .advanced-mode-tab.functional.active { /* Style for active functional advanced tab */
            background-color: var(--color-primary);
            color: white;
            opacity: 1;
        }
         body.dark-mode .advanced-mode-tab.functional.active {
            color: var(--color-secondary-text);
        }

        .software-tabs-container {
            display: flex;
            border-bottom: 1px solid var(--color-border-subtle);
            margin-bottom: 1rem;
            flex-wrap: wrap; /* Allow tabs to wrap on smaller screens */
        }
        .software-tab-button {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            margin-right: 0.25rem;
            margin-bottom: -1px; /* Overlap bottom border */
            border-radius: 0.375rem 0.375rem 0 0;
            font-weight: 500;
            background-color: var(--color-card-bg-alt);
            color: var(--color-text-card);
            white-space: nowrap;
        }
        .software-tab-button.active {
            background-color: var(--color-primary);
            color: var(--color-selected-text);
            border-color: var(--color-border-subtle);
            border-bottom: 1px solid var(--color-primary); /* Ensure active tab bottom border matches */
        }
        body.dark-mode .software-tab-button.active {
            color: var(--color-secondary-text); 
        }
        .software-tab-content { display: none; }
        .software-tab-content.active { display: grid; }
        
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: var(--color-card-bg-alt); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--color-primary); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: var(--color-primary-hover); }

    </style>
</head>
<body>
    <div class="beta-watermark">
        <i class="fas fa-flask mr-1"></i> Site em Vers√£o Beta. Novas funcionalidades e componentes em breve!
    </div>

    <main class="container mx-auto px-4 py-8 md:py-12">
        <header class="text-center mb-12">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-xl md:text-2xl font-medium text-left tracking-wide" style="color: var(--color-text-main); opacity: 0.85; letter-spacing: 0.05em;"><i class="fas fa-laptop-code mr-2 text-sm opacity-70"></i>DeiviTech</h1>
                <div>
                    <button id="theme-toggle" class="theme-toggle-btn mr-3" title="Alternar Tema">
                        <i class="fas fa-lightbulb"></i> <!-- Changes to fa-moon in JS -->
                    </button>
                    <button id="login-placeholder-btn" class="login-btn-placeholder py-2 px-4 rounded-lg text-sm" title="Login (Em Breve): Futuramente para hist√≥rico de pedidos e autentica√ß√£o de trocas.">
                        <i class="fas fa-user mr-1"></i> Login (Em Breve)
                    </button>
                </div>
            </div>
            <h2 class="text-4xl md:text-5xl font-bold" style="color:var(--color-secondary); margin-top: -1rem;">Notebooks Personalizados</h2>
            <p class="mt-4 text-lg text-[var(--color-text-main)]">Escolha cada componente ou servi√ßo e veja o pre√ßo em tempo real!</p>            <div class="mt-8 flex justify-center gap-4">
                <button id="assisted-mode-btn" class="mode-toggle-btn py-2 px-6 rounded-lg font-semibold"><i class="fas fa-hands-helping mr-1"></i>MODO ASSISTIDO</button>
                <button id="basic-mode-btn" class="mode-toggle-btn py-2 px-6 rounded-lg font-semibold active">Modo B√°sico</button>
                <button id="advanced-mode-btn" class="mode-toggle-btn py-2 px-6 rounded-lg font-semibold">Modo Avan√ßado</button>
            </div>
            
            <!-- Se√ß√£o de Informa√ß√µes Avan√ßadas -->
            <div id="advanced-info-section" class="mt-8 hidden">
                <div class="bg-[var(--color-card-bg)] p-6 rounded-lg shadow-lg border border-[var(--color-primary)]">
                    <h3 class="text-2xl font-bold text-[var(--color-primary)] mb-4 text-center">
                        <i class="fas fa-microscope mr-2"></i>Modo Avan√ßado Ativado
                    </h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Pain√©is de Informa√ß√£o T√©cnica -->
                        <div class="space-y-4">
                            <div class="bg-[var(--color-card-bg-alt)] p-4 rounded-lg">
                                <h4 class="font-semibold mb-2 flex items-center">
                                    <i class="fas fa-tachometer-alt mr-2 text-[var(--color-secondary)]"></i>
                                    An√°lise T√©rmica e TDP
                                </h4>
                                <div id="thermal-analysis" class="text-sm space-y-2">
                                    <div class="flex justify-between">
                                        <span>TDP Total:</span>
                                        <span id="total-tdp" class="font-mono">0W</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Dissipa√ß√£o Necess√°ria:</span>
                                        <span id="heat-dissipation" class="font-mono">Baixa</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div id="thermal-bar" class="h-2 rounded-full bg-green-500" style="width: 30%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-[var(--color-card-bg-alt)] p-4 rounded-lg">
                                <h4 class="font-semibold mb-2 flex items-center">
                                    <i class="fas fa-bolt mr-2 text-[var(--color-accent-yellow)]"></i>
                                    Estimativa de Consumo
                                </h4>
                                <div id="power-analysis" class="text-sm space-y-2">
                                    <div class="flex justify-between">
                                        <span>Modo Idle:</span>
                                        <span id="idle-power" class="font-mono">0W</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Carga M√°xima:</span>
                                        <span id="max-power" class="font-mono">0W</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Autonomia Estimada:</span>
                                        <span id="battery-estimate" class="font-mono">0h</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gr√°ficos T√©cnicos -->
                        <div class="space-y-4">
                            <div class="bg-[var(--color-card-bg-alt)] p-4 rounded-lg">
                                <h4 class="font-semibold mb-2 text-center">Performance Score Detalhado</h4>
                                <div class="h-32">
                                    <canvas id="performanceRadarChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="bg-[var(--color-card-bg-alt)] p-4 rounded-lg">
                                <h4 class="font-semibold mb-2 text-center">Benchmark Comparativo</h4>
                                <div id="benchmark-comparison" class="text-xs space-y-1">
                                    <div class="flex justify-between">
                                        <span>Cinebench R23:</span>
                                        <span id="cinebench-score" class="font-mono">0 pts</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>3DMark Time Spy:</span>
                                        <span id="timespy-score" class="font-mono">0 pts</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>PCMark 10:</span>
                                        <span id="pcmark-score" class="font-mono">0 pts</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recomenda√ß√µes Inteligentes -->
                    <div class="mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border-l-4 border-[var(--color-primary)]">
                        <h4 class="font-semibold mb-2 flex items-center">
                            <i class="fas fa-lightbulb mr-2 text-[var(--color-primary)]"></i>
                            Recomenda√ß√µes Inteligentes
                        </h4>
                        <div id="smart-recommendations" class="text-sm">
                            <p class="mb-2">An√°lise baseada na sua configura√ß√£o atual:</p>
                            <ul id="recommendations-list" class="list-disc list-inside space-y-1 text-gray-700">
                                <li>Configure componentes para ver recomenda√ß√µes personalizadas</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="mb-8">
            <div id="main-tabs-container" class="flex border-b border-[var(--color-border-subtle)] flex-wrap">
                <button id="tab-concept" class="tab-button active" onclick="showTab('concept')"><i class="fas fa-lightbulb mr-2"></i>Conceito</button>
                <button id="tab-configure" class="tab-button" onclick="showTab('configure')"><i class="fas fa-cogs mr-2"></i>Configurar Novo</button>
                <button id="tab-ready" class="tab-button" onclick="showTab('ready')"><i class="fas fa-laptop-medical mr-2"></i>Notebooks Prontos</button>
                <button id="tab-tradein" class="tab-button" onclick="showTab('tradein')"><i class="fas fa-recycle mr-2"></i>Trocar Notebook Usado</button>
                <button id="tab-services" class="tab-button" onclick="showTab('services')"><i class="fas fa-tools mr-2"></i>Formata√ß√£o e Servi√ßos</button>
                <button id="tab-specific-budget" class="advanced-mode-tab functional hidden" onclick="showTab('specific-budget')"><i class="fas fa-comments-dollar mr-2"></i>Or√ßamento Espec√≠fico</button>
                <button id="tab-ai-integration" class="advanced-mode-tab hidden" title="Em Desenvolvimento"><i class="fas fa-brain mr-2"></i>Integra√ß√£o com IA (Em Breve)</button>
            </div>
        </div>

        <div id="concept-tab-content" class="tab-content active">
            <div class="p-6 bg-[var(--color-card-bg)] rounded-lg shadow-lg">                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-[var(--color-primary)] mb-4">Configurador Inteligente de Notebooks</h2>
                    <p class="text-lg text-[var(--color-text-secondary)]">Encontre o notebook perfeito para suas necessidades com nossa plataforma de configura√ß√£o assistida</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-10">
                    <div class="card p-6 border-t-4 border-[var(--color-primary)] hover:shadow-lg transition-all">
                        <div class="text-center mb-4">
                            <i class="fas fa-magic text-4xl text-[var(--color-primary)]"></i>
                            <h3 class="text-xl font-semibold mt-3">Configura√ß√£o Assistida</h3>
                        </div>
                        <p>Nosso sistema inteligente analisa suas necessidades e recomenda a configura√ß√£o ideal, otimizando desempenho e or√ßamento.</p>
                        <div class="mt-4 text-center">
                            <button onclick="showTab('configure'); document.getElementById('assisted-mode-btn').click()" class="btn-primary px-4 py-2 rounded-lg"><i class="fas fa-wand-magic-sparkles mr-2"></i>Experimentar</button>
                        </div>
                    </div>
                    
                    <div class="card p-6 border-t-4 border-[var(--color-secondary)] hover:shadow-lg transition-all">
                        <div class="text-center mb-4">
                            <i class="fas fa-sliders text-4xl text-[var(--color-secondary)]"></i>
                            <h3 class="text-xl font-semibold mt-3">Configura√ß√£o Personalizada</h3>
                        </div>
                        <p>Controle total sobre cada componente. Escolha processador, mem√≥ria, armazenamento e todos os detalhes do seu notebook ideal.</p>
                        <div class="mt-4 text-center">
                            <button onclick="showTab('configure'); document.getElementById('basic-mode-btn').click()" class="btn-secondary px-4 py-2 rounded-lg"><i class="fas fa-cogs mr-2"></i>Configurar</button>
                        </div>
                    </div>
                    
                    <div class="card p-6 border-t-4 border-[var(--color-accent-yellow)] hover:shadow-lg transition-all">
                        <div class="text-center mb-4">
                            <i class="fas fa-laptop-medical text-4xl text-[var(--color-accent-yellow)]"></i>
                            <h3 class="text-xl font-semibold mt-3">Notebooks Prontos</h3>
                        </div>
                        <p>Sele√ß√£o cuidadosa de notebooks pr√©-configurados para diferentes perfis: estudante, profissional, gamer e criativo.</p>
                        <div class="mt-4 text-center">
                            <button onclick="showTab('ready')" class="btn-accent-yellow px-4 py-2 rounded-lg"><i class="fas fa-laptop mr-2"></i>Ver Op√ß√µes</button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-[var(--color-card-bg-alt)] p-6 rounded-lg mb-8">
                    <h3 class="text-2xl font-bold mb-4 text-center">Como Funciona</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                        <div class="p-4">
                            <div class="w-12 h-12 bg-[var(--color-primary)] rounded-full flex items-center justify-center text-white text-xl font-bold mx-auto mb-3">1</div>
                            <h4 class="font-semibold mb-2">Escolha o Modo</h4>
                            <p class="text-sm">Selecione entre modo assistido ou configura√ß√£o manual</p>
                        </div>
                        <div class="p-4">
                            <div class="w-12 h-12 bg-[var(--color-primary)] rounded-full flex items-center justify-center text-white text-xl font-bold mx-auto mb-3">2</div>
                            <h4 class="font-semibold mb-2">Personalize</h4>
                            <p class="text-sm">Selecione os componentes ou responda √†s perguntas</p>
                        </div>
                        <div class="p-4">
                            <div class="w-12 h-12 bg-[var(--color-primary)] rounded-full flex items-center justify-center text-white text-xl font-bold mx-auto mb-3">3</div>
                            <h4 class="font-semibold mb-2">Revise</h4>
                            <p class="text-sm">Verifique o resumo e o desempenho estimado</p>
                        </div>
                        <div class="p-4">
                            <div class="w-12 h-12 bg-[var(--color-primary)] rounded-full flex items-center justify-center text-white text-xl font-bold mx-auto mb-3">4</div>
                            <h4 class="font-semibold mb-2">Finalize</h4>
                            <p class="text-sm">Adicione servi√ßos extras e finalize seu pedido</p>
                        </div>
                    </div>
                </div>
                  <!-- Se√ß√£o de Gr√°ficos e Informa√ß√µes -->
                <div class="bg-[var(--color-card-bg-alt)] p-6 rounded-lg mb-8">
                    <h3 class="text-2xl font-bold mb-4 text-center">Entenda a Performance dos Notebooks Modernos</h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-6">
                        <!-- Gr√°fico de Compara√ß√£o CPU Mobile vs Desktop -->
                        <div class="bg-white p-4 rounded-lg shadow">
                            <h4 class="font-semibold mb-3 text-center">CPUs Mobile vs Desktop - Efici√™ncia Energ√©tica</h4>
                            <div class="chart-container" style="position: relative; height:250px;">
                                <canvas id="cpuEfficiencyChart"></canvas>
                            </div>
                            <p class="text-sm mt-3 text-center text-gray-600">Processadores mobile modernos oferecem excelente performance com menor consumo de energia</p>
                        </div>
                        
                        <!-- Gr√°fico de Autonomia de Bateria -->
                        <div class="bg-white p-4 rounded-lg shadow">
                            <h4 class="font-semibold mb-3 text-center">Autonomia de Bateria por Tipo de Uso</h4>
                            <div class="chart-container" style="position: relative; height:250px;">
                                <canvas id="batteryLifeChart"></canvas>
                            </div>
                            <p class="text-sm mt-3 text-center text-gray-600">A autonomia varia significativamente dependendo do perfil de uso do notebook</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-6">
                        <!-- Gr√°fico de Performance GPU Mobile -->
                        <div class="bg-white p-4 rounded-lg shadow">
                            <h4 class="font-semibold mb-3 text-center">Performance GPUs Mobile - Gaming 1080p</h4>
                            <div class="chart-container" style="position: relative; height:250px;">
                                <canvas id="gpuPerformanceChart"></canvas>
                            </div>
                            <p class="text-sm mt-3 text-center text-gray-600">GPUs modernas para notebook oferecem performance competitiva para gaming</p>
                        </div>
                        
                        <!-- Gr√°fico de Velocidade de Armazenamento -->
                        <div class="bg-white p-4 rounded-lg shadow">
                            <h4 class="font-semibold mb-3 text-center">Velocidade de Armazenamento - Impacto no Sistema</h4>
                            <div class="chart-container" style="position: relative; height:250px;">
                                <canvas id="storageSpeedChart"></canvas>
                            </div>
                            <p class="text-sm mt-3 text-center text-gray-600">SSDs NVMe oferecem velocidades at√© 10x maiores que HDDs tradicionais</p>
                        </div>
                    </div>
                    
                    <!-- Informa√ß√µes de Escolha de Notebooks -->
                    <div class="bg-white p-6 rounded-lg shadow mb-6">
                        <h4 class="font-semibold mb-4 text-center">Guia de Escolha - Notebook Ideal por Perfil</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="text-center p-4 border border-gray-200 rounded-lg">
                                <i class="fas fa-graduation-cap text-3xl text-blue-500 mb-2"></i>
                                <h5 class="font-semibold mb-2">Estudante</h5>
                                <ul class="text-sm text-left space-y-1">
                                    <li>‚Ä¢ i3/Ryzen 3 + 8GB RAM</li>
                                    <li>‚Ä¢ SSD 256GB</li>
                                    <li>‚Ä¢ Tela 14-15.6" FHD</li>
                                    <li>‚Ä¢ Bateria 50Wh+</li>
                                </ul>
                            </div>
                            <div class="text-center p-4 border border-gray-200 rounded-lg">
                                <i class="fas fa-briefcase text-3xl text-green-500 mb-2"></i>
                                <h5 class="font-semibold mb-2">Profissional</h5>
                                <ul class="text-sm text-left space-y-1">
                                    <li>‚Ä¢ i5/Ryzen 5 + 16GB RAM</li>
                                    <li>‚Ä¢ SSD 512GB NVMe</li>
                                    <li>‚Ä¢ Tela 14-16" FHD/QHD</li>
                                    <li>‚Ä¢ Bateria 65Wh+</li>
                                </ul>
                            </div>
                            <div class="text-center p-4 border border-gray-200 rounded-lg">
                                <i class="fas fa-gamepad text-3xl text-red-500 mb-2"></i>
                                <h5 class="font-semibold mb-2">Gamer</h5>
                                <ul class="text-sm text-left space-y-1">
                                    <li>‚Ä¢ i7/Ryzen 7 + 16-32GB RAM</li>
                                    <li>‚Ä¢ SSD 1TB NVMe Gen4</li>
                                    <li>‚Ä¢ GPU RTX 4060+</li>
                                    <li>‚Ä¢ Tela 144Hz+</li>
                                </ul>
                            </div>
                            <div class="text-center p-4 border border-gray-200 rounded-lg">
                                <i class="fas fa-palette text-3xl text-purple-500 mb-2"></i>
                                <h5 class="font-semibold mb-2">Criativo</h5>
                                <ul class="text-sm text-left space-y-1">
                                    <li>‚Ä¢ i7/Ryzen 7 + 32GB RAM</li>
                                    <li>‚Ä¢ SSD 1TB+ NVMe</li>
                                    <li>‚Ä¢ GPU RTX 4070+</li>
                                    <li>‚Ä¢ Tela 4K/OLED</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dicas de Otimiza√ß√£o -->
                    <div class="bg-white p-4 rounded-lg shadow mb-6">
                        <h4 class="font-semibold mb-3">Dicas para Maximizar Performance e Autonomia</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h5 class="font-medium mb-2 text-green-600">‚úì Para Maior Autonomia</h5>
                                <ul class="list-disc pl-5 space-y-1 text-sm">
                                    <li>Escolha CPUs da s√©rie H ou U (baixo consumo)</li>
                                    <li>Prefira RAM em dual-channel (2x8GB ao inv√©s de 1x16GB)</li>
                                    <li>SSD consome menos que HDD</li>
                                    <li>Telas IPS consomem menos que OLED</li>
                                    <li>Baterias 60Wh+ s√£o ideais para uso prolongado</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-medium mb-2 text-blue-600">‚ö° Para Maior Performance</h5>
                                <ul class="list-disc pl-5 space-y-1 text-sm">
                                    <li>CPUs i7/Ryzen 7 para multitarefas intensas</li>
                                    <li>32GB RAM para edi√ß√£o de v√≠deo/3D</li>
                                    <li>SSDs NVMe Gen4 para transfer√™ncias r√°pidas</li>
                                    <li>GPUs RTX 4060+ para jogos modernos</li>
                                    <li>Telas 144Hz+ para gaming competitivo</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="showTab('configure')" class="btn-primary px-6 py-3 text-lg rounded-lg"><i class="fas fa-arrow-right mr-2"></i>Come√ßar Agora</button>
                </div>
            </div>
        </div>
        
        <div id="configure-tab-content" class="tab-content">
            <!-- Layout principal com grid para conte√∫do principal e painel lateral -->
            <div class="lg:grid lg:grid-cols-4 lg:gap-8">
                <!-- Painel lateral integrado de recursos -->
                <div class="lg:col-span-1 order-last lg:order-first">
                    <div id="integrated-performance-display" class="card sticky top-24 p-4 bg-[var(--color-card-bg-alt)] border-l-4 border-[var(--color-primary)]">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="text-lg font-bold font-orbitron text-[var(--color-primary)]"><i class="fas fa-chart-line mr-2"></i>Status</h3>
                            <div class="text-xs px-2 py-1 bg-[var(--color-primary)] text-white rounded-full">Live</div>
                        </div>
                        <div class="mb-4">
                            <div class="flex justify-between text-sm mb-1">
                                <span>Desempenho</span>
                                <span id="integrated-performance-percentage">45%</span>
                            </div>
                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mb-1">
                                <div id="integrated-performance-bar" class="h-2.5 rounded-full" style="width: 45%; background-color: var(--color-secondary);"></div>
                            </div>
                            <p id="integrated-performance-text" class="text-xs text-gray-600 dark:text-gray-400 italic">N√≠vel: Intermedi√°rio</p>
                        </div>
                        <div class="mb-4">
                            <h4 class="text-sm font-semibold mb-2 flex items-center">
                                <i class="fas fa-microchip mr-2 text-[var(--color-primary)]"></i>Componentes
                            </h4>
                            <div id="integrated-components-list" class="text-xs space-y-2 max-h-48 overflow-y-auto pr-1 border-l-2 border-gray-200 dark:border-gray-700 pl-2">
                                <!-- Componentes ser√£o adicionados dinamicamente via JavaScript -->
                            </div>
                        </div>
                        <div class="pt-3 border-t border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <p class="text-sm font-semibold">Total:</p>
                                <p id="integrated-total-price" class="text-lg font-bold text-[var(--color-primary)]">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Coluna principal com componentes de configura√ß√£o -->
                <div class="lg:col-span-3 space-y-8">            <section id="quality-slider-section" class="card mb-12">
                <h2 class="text-2xl font-bold mb-4 text-center"><span class="section-icon"><i class="fas fa-sliders-h"></i></span>Configura√ß√£o R√°pida por Preset</h2>
                <div class="flex flex-col items-center">
                    <div class="w-full max-w-xl px-4">
                        <input type="range" id="quality-slider" min="0" max="2" value="1" class="w-full cursor-pointer">
                        <div class="flex justify-between text-sm text-[var(--color-text-card)] mt-2 px-1">
                            <span id="quality-label-0">Econ√¥mico</span>
                            <span id="quality-label-1" class="quality-label-active">Balanceado</span>
                            <span id="quality-label-2">Performance</span>
                        </div>
                    </div>
                    <p id="current-preset-display" class="mt-3 text-md text-[var(--color-text-card)] font-semibold">Preset Ativo: Balanceado</p>
                </div>
            </section>
                    
                    <section id="platform-selection-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-layer-group"></i></span>1. Escolha a Plataforma</h2>
                        <div id="platform-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>                    <section id="casing-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-laptop"></i></span>2. Escolha a Carca√ßa</h2>
                        <div id="casing-options" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </section>

                    <section id="motherboard-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-microchip"></i></span>3. Selecione a Placa M√£e</h2>
                        <p id="motherboard-helper-text" class="text-sm text-gray-500 dark:text-gray-400 mb-4">Selecione uma plataforma (Intel/AMD) acima primeiro.</p>
                        <div id="motherboard-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>

                    <section id="cpu-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-brain"></i></span>4. Selecione o Processador (CPU)</h2>
                        <p id="cpu-helper-text" class="text-sm text-gray-500 dark:text-gray-400 mb-4">Selecione uma placa m√£e compat√≠vel primeiro.</p>
                        <div id="cpu-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>                    <section id="ram-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-microchip"></i></span>5. Configure a Mem√≥ria RAM</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="ram-type-select" class="block text-sm font-medium text-[var(--color-text-card)] mb-2">M√≥dulos de RAM (DDR):</label>
                                <select id="ram-type-select" class="block w-full custom-select"> </select>
                                <p id="ram-type-helper-text" class="text-xs text-gray-500 body.dark-mode:text-gray-400 mt-1">O tipo de DDR √© definido pela placa m√£e.</p>
                            </div>
                            <div>
                                <label for="ram-quantity-input" class="block text-sm font-medium text-[var(--color-text-card)] mb-2">Quantidade de M√≥dulos:</label>
                                <input type="number" id="ram-quantity-input" value="1" min="1" max="4" class="block w-full custom-input">
                                <p class="text-xs text-gray-500 body.dark-mode:text-gray-400 mt-1">M√°ximo de <span id="ram-max-modules">X</span> m√≥dulos (definido pela placa-m√£e).</p>
                            </div>
                        </div>
                         <p class="mt-3 text-sm text-gray-600 body.dark-mode:text-gray-400">Oferecemos m√≥dulos DDR4 (Ex: 3200MHz, 3600MHz) e DDR5 (Ex: 5200MHz, 5600MHz, 6000MHz+), incluindo op√ß√µes ECC para workstations. A compatibilidade e velocidade exata dependem da placa m√£e selecionada.</p>
                    </section>                    <section id="storage1-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-hdd"></i></span>6. Armazenamento Principal (SSD/NVMe)</h2>
                        <div id="storage1-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                         <p class="mt-3 text-sm text-gray-600 body.dark-mode:text-gray-400">Dispomos de SSDs SATA, NVMe PCIe Gen3, Gen4 e Gen5 para m√°xima performance. HDDs dispon√≠veis para armazenamento secund√°rio ou necessidades espec√≠ficas.</p>
                    </section>

                    <section id="storage2-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-database"></i></span>7. Armazenamento Secund√°rio (Opcional)</h2>
                        <div id="storage2-options" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                             <div class="option-item" data-id="none" data-price="0" data-category="storage2">
                                <input type="radio" id="storage2-none" name="storage2" value="none" class="hidden">
                                <div class="option-content w-full">
                                    <p class="font-semibold text-name"><i class="fas fa-ban section-icon mr-2 text-lg"></i>Nenhum</p>
                                    <p class="text-sm text-description">N√£o adicionar armazenamento secund√°rio.</p>
                                    <p class="text-sm price-text mt-auto">R$ 0,00</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <section id="os-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fab fa-linux"></i></span>8. Sistema Operacional</h2>
                        <p class="text-sm text-gray-600 body.dark-mode:text-gray-400 mb-3">Personalize seu Windows com perfis (Multim√≠dia, Gamer, Corporativo) ou escolha sua distro Linux favorita. Software adicional pode ser selecionado na se√ß√£o "Software Adicional Detalhado" abaixo.</p>
                        <div id="os-options" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                        <div id="dualboot-section" class="mt-6 hidden">
                            <h3 class="text-xl font-semibold mb-3"><i class="fas fa-columns mr-2"></i>Op√ß√£o de Dual Boot</h3>
                            <div class="checkbox-option-item">
                                <input type="checkbox" id="dualboot-checkbox" class="mr-3">
                                <label for="dualboot-checkbox" class="text-md">Ativar Dual Boot com um segundo Sistema Operacional?</label>
                            </div>
                            <div id="dualboot-os2-selection" class="mt-4 hidden">
                                <label for="os2-select" class="block text-sm font-medium mb-2">Selecione o Segundo SO:</label>
                                <select id="os2-select" class="custom-select w-full mb-3"></select>
                                <label for="dualboot-disk-select" class="block text-sm font-medium mb-2">Instalar Segundo SO em:</label>
                                <select id="dualboot-disk-select" class="custom-select w-full">
                                    <option value="same">Mesmo Disco (Principal)</option>
                                    <option value="additional" id="dualboot-additional-disk-option" disabled>Disco Adicional (Secund√°rio)</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <section id="detailed-software-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-puzzle-piece"></i></span>9. Software Adicional Detalhado</h2>
                        <p id="detailed-software-helper-text" class="text-sm text-gray-500 body.dark-mode:text-gray-400 mb-4">Selecione um SO para ver op√ß√µes de software. Softwares gratuitos n√£o alteram o pre√ßo.</p>
                        <div id="software-tabs-container" class="software-tabs-container">
                            <button class="software-tab-button active" data-tab="multimedia">Multim√≠dia</button>
                            <button class="software-tab-button" data-tab="design">Design/Cria√ß√£o</button>
                            <button class="software-tab-button" data-tab="development">Desenvolvimento (TI)</button>
                            <button class="software-tab-button" data-tab="productivity">Produtividade/Outros</button>
                        </div>
                        <div id="software-multimedia-tab" class="software-tab-content active grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                        <div id="software-design-tab" class="software-tab-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                        <div id="software-development-tab" class="software-tab-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                        <div id="software-productivity-tab" class="software-tab-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </section>                    <section id="gpu-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-gamepad"></i></span>10. Placa de V√≠deo (GPU)</h2>
                        <div id="gpu-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>

                    <section id="display-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-desktop"></i></span>11. Tela</h2>
                        <div id="display-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>

                    <section id="keyboard-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-keyboard"></i></span>12. Teclado</h2>
                        <div id="keyboard-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>

                    <section id="network-adapter-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-wifi"></i></span>13. Conectividade Wi-Fi e Bluetooth</h2>
                        <p class="text-sm text-gray-600 body.dark-mode:text-gray-400 mb-3">A conectividade Wi-Fi e Bluetooth ser√° fornecida diretamente pela placa m√£e selecionada.</p>
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                            <p class="text-sm"><i class="fas fa-info-circle mr-2"></i>Informa√ß√£o: O adaptador de rede Wi-Fi e Bluetooth j√° est√° integrado na placa m√£e selecionada. N√£o √© necess√°rio escolher um adaptador separadamente.</p>
                            <p class="mt-2 text-sm text-gray-600 body.dark-mode:text-gray-400">Porta Ethernet: <span id="ethernet-info" class="font-semibold">Integrada na placa m√£e</span></p>
                        </div>
                    </section>                    <section id="battery-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-battery-full"></i></span>14. Bateria</h2>
                        <div id="battery-options" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </section>

                    <section id="peripherals-section" class="card">
                        <h2 class="text-2xl font-bold mb-6"><span class="section-icon"><i class="fas fa-mouse"></i></span>15. Perif√©ricos (M√∫ltipla Escolha)</h2>
                        <div id="peripherals-options" class="grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3"></div>
                    </section>
                     <div class="mt-10 text-center">
                        <button id="finalize-config-button" class="btn btn-primary btn-lg">
                            <i class="fas fa-shopping-cart mr-2"></i>Revisar e Encomendar Configura√ß√£o
                        </button>
                    </div>
                </div>

                <div class="lg:col-span-1 mt-8 lg:mt-0">                    <div class="sticky-summary card p-6">
                        <h2 class="text-2xl font-bold mb-2"><span class="section-icon"><i class="fas fa-shopping-cart"></i></span>Seu Carrinho DeiviTech</h2>
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold text-center mb-1">N√≠vel de Performance Estimado</h3>
                            <div id="performance-bar-container"><div id="performance-bar">0%</div></div>
                            <p id="performance-text-display" class="performance-text text-center">-</p>
                            <p id="energy-tendency-display" class="energy-tendency-text text-center mt-1">-</p>
                        </div>
                        <div id="summary-details" class="text-sm space-y-1 mb-6 max-h-[30rem] overflow-y-auto pr-2 custom-scrollbar"></div>
                        <div class="border-t-2 border-[var(--color-primary)] pt-4 mt-4">
                            <p class="text-2xl font-bold">Total Notebook: <span id="total-price-display" class="text-[var(--color-primary)]">R$ 0,00</span></p>
                        </div>
                        <button id="whatsapp-order-button" class="mt-6 w-full btn btn-secondary flex items-center justify-center">
                            <i class="fab fa-whatsapp mr-2 text-xl"></i> Encomendar Notebook via WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="ready-tab-content" class="tab-content">
            <h2 class="text-3xl font-bold mb-8 text-center text-[var(--color-text-card)]"><i class="fas fa-laptop-medical mr-3"></i>Notebooks Prontos para Voc√™!</h2>
            <div id="ready-notebooks-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Notebooks prontos ser√£o inseridos aqui -->
            </div>
        </div>
        
        <div id="tradein-tab-content" class="tab-content">             <section id="tradein-section" class="card"> 
                <h2 class="text-2xl font-bold mb-6 text-[var(--color-accent-red)]"><span class="section-icon" style="color: var(--color-accent-red);"><i class="fas fa-recycle"></i></span>Troque Seu Notebook Usado e Ganhe Desconto!</h2>
                <p class="mb-4 text-sm text-gray-600 body.dark-mode:text-gray-400">Avalie seu notebook usado e obtenha um cr√©dito para sua nova m√°quina DeiviTech. Siga os passos abaixo.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div> <label for="tradein-condition" class="block text-sm font-medium text-[var(--color-text-card)] mb-2">Condi√ß√£o Geral:</label> <select id="tradein-condition" class="block w-full custom-select"> <option value="excellent">Excelente (Como novo)</option> <option value="good">Boa (Pequenas marcas de uso)</option> <option value="fair">Razo√°vel (Marcas vis√≠veis, funcional)</option> <option value="poor">Ruim (Defeitos, pe√ßas faltando)</option> </select> </div>
                    <div> <label for="tradein-age" class="block text-sm font-medium text-[var(--color-text-card)] mb-2">Idade Aproximada:</label> <select id="tradein-age" class="block w-full custom-select"> <option value="<1year">< 1 ano</option> <option value="1-2years">1-2 anos</option> <option value="2-3years">2-3 anos</option> <option value=">3years">> 3 anos</option> </select> </div>
                    <div class="md:col-span-2"> <label for="tradein-specs" class="block text-sm font-medium text-[var(--color-text-card)] mb-2">N√≠vel de Especifica√ß√µes Originais:</label> <select id="tradein-specs" class="block w-full custom-select"> <option value="high-end">Alto Desempenho (Ex: Core i7/Ryzen 7+, GPU dedicada)</option> <option value="mid-range">M√©dio Desempenho (Ex: Core i5/Ryzen 5, GPU b√°sica ou integrada)</option> <option value="low-end">Baixo Desempenho (Ex: Celeron/Atom, uso b√°sico)</option> </select> </div>
                </div>
                <button id="calculate-tradein" class="w-full btn btn-danger mb-4">Calcular Valor de Troca Estimado</button>
                <p id="tradein-value-display" class="text-center text-lg font-bold text-[var(--color-accent-red)]">Valor Estimado: R$ 0,00</p>
                
                <div class="mt-8 border-t border-[var(--color-border-subtle)] pt-6">
                    <h3 class="text-xl font-bold text-[var(--color-accent-red)] mb-2">Avalia√ß√£o Detalhada com Relat√≥rio do Sistema (Opcional, Maior Precis√£o)</h3>
                    <p class="text-sm text-gray-600 body.dark-mode:text-gray-400 mb-3">Para uma avalia√ß√£o mais precisa, gere um relat√≥rio do seu sistema e envie o arquivo. Nossa I.A. (simulada) analisar√° e poder√° oferecer um valor melhor. Estimamos um cr√©dito de at√© 50% do valor de mercado das pe√ßas principais usadas.</p>
                    
                    <details class="mb-4">
                        <summary class="cursor-pointer text-[var(--color-primary)] hover:underline">Como gerar o relat√≥rio do sistema? (Clique para expandir)</summary>
                        <div class="tutorial-details text-sm space-y-2">
                            <p><strong>Op√ß√£o 1: Usando o DxDiag (Windows)</strong></p>
                            <ol class="list-decimal list-inside ml-4">
                                <li>Pressione as teclas `Windows + R` para abrir a caixa "Executar".</li>
                                <li>Digite `dxdiag` e pressione Enter.</li>
                                <li>Aguarde a ferramenta carregar. Se perguntar sobre drivers assinados digitalmente, pode clicar em Sim ou N√£o.</li>
                                <li>Clique no bot√£o "Salvar informa√ß√µes..." ou "Save All Information...".</li>
                                <li>Salve o arquivo como `.txt` (ex: `meu_pc_specs.txt`).</li>
                                <li>Fa√ßa o upload deste arquivo abaixo.</li>
                            </ol>
                            <p><strong>Op√ß√£o 2: Usando CPU-Z (Windows)</strong></p>
                             <ol class="list-decimal list-inside ml-4">
                                <li>Baixe e instale o CPU-Z (gratuito em cpuid.com).</li>
                                <li>Abra o CPU-Z.</li>
                                <li>V√° na aba "About" (ou "Sobre").</li>
                                <li>Na se√ß√£o "Tools" (ou "Ferramentas"), clique em "Save Report (.TXT)" ou "Save Report (.HTML)".</li>
                                <li>Salve o arquivo e fa√ßa o upload abaixo.</li>
                            </ol>
                             <p><strong>Outras Ferramentas:</strong> Relat√≥rios de ferramentas como Speccy, HWiNFO, ou informa√ß√µes do sistema do Linux (`lshw`, `inxi`) tamb√©m podem ser √∫teis, preferencialmente em formato .txt ou .html.</p>
                        </div>
                    </details>

                    <input type="file" id="system-info-file" accept=".txt,.html,.json" class="block w-full text-sm file-input-styled mb-3">
                    <button id="upload-info-btn" class="mt-1 w-full btn btn-danger">Processar Relat√≥rio para Avalia√ß√£o Detalhada</button>
                    <p id="file-evaluation-result" class="mt-4 text-center text-md text-[var(--color-accent-red)]"></p>
                </div>
            </section>
        </div>

        <div id="services-tab-content" class="tab-content">
            <h2 class="text-3xl font-bold mb-6 text-center text-[var(--color-text-card)]"><i class="fas fa-tools mr-3"></i>Formata√ß√£o, Upgrades e Servi√ßos DeiviTech</h2>
            <p class="text-center text-gray-600 body.dark-mode:text-gray-400 mb-8">Precisa dar um UP no seu notebook atual ou apenas de uma formata√ß√£o caprichada? Confira nossos servi√ßos! Selecione os desejados para or√ßamento.</p>
            
            <div id="services-options-container" class="space-y-4">
                <!-- Services will be populated here by JS -->
            </div>

            <div class="mt-8 border-t border-[var(--color-border-subtle)] pt-4">
                <p class="text-xl font-bold text-right">Total Servi√ßos: <span id="total-services-price-display" class="text-[var(--color-primary)]">R$ 0,00</span></p>
                 <button id="whatsapp-services-order-button" class="mt-6 w-full btn btn-primary flex items-center justify-center"> <!-- Changed to btn-primary for more emphasis -->
                    <i class="fab fa-whatsapp mr-2 text-xl"></i> Solicitar Or√ßamento de Servi√ßos
                </button>
            </div>
            <p class="mt-8 text-sm text-gray-500 body.dark-mode:text-gray-400 text-center">Todos os servi√ßos s√£o realizados com pe√ßas de qualidade e garantia. Respeitamos integralmente a Lei Geral de Prote√ß√£o de Dados (LGPD) em todos os procedimentos que envolvem dados do cliente.</p>
        </div>

        <div id="specific-budget-tab-content" class="tab-content">
            <h2 class="text-3xl font-bold mb-6 text-center text-[var(--color-text-card)]"><i class="fas fa-comments-dollar mr-3"></i>Or√ßamento Espec√≠fico</h2>
            <p class="text-center text-gray-600 body.dark-mode:text-gray-400 mb-6">Tem uma necessidade muito espec√≠fica, um componente que n√£o encontrou, ou um projeto especial em mente (Ex: Hackintosh, servidor caseiro)? Descreva abaixo e solicite um or√ßamento personalizado diretamente conosco.</p>
            <div class="max-w-lg mx-auto">
                <textarea id="specific-budget-request" class="custom-textarea w-full h-40 mb-4" placeholder="Descreva sua necessidade, componentes desejados, casos de uso, ou qualquer detalhe para seu or√ßamento personalizado..."></textarea>
                <button id="send-specific-budget-request" class="w-full btn btn-primary">
                    <i class="fab fa-whatsapp mr-2"></i>Solicitar Or√ßamento Personalizado via WhatsApp
                </button>
            </div>
        </div>
        
        <div id="ai-integration-tab-content" class="tab-content">
            <div class="p-6 bg-[var(--color-card-bg)] rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold mb-4 text-[var(--color-primary)]"><i class="fas fa-brain mr-2"></i>Integra√ß√£o com IA</h2>
                <p class="mb-6">Utilize a intelig√™ncia artificial para analisar sua configura√ß√£o atual e receber recomenda√ß√µes personalizadas.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <!-- An√°lise de Performance -->                    
                    <div class="card p-5 border border-[var(--color-border-subtle)] rounded-lg">
                        <h3 class="text-xl font-semibold mb-3"><i class="fas fa-chart-line text-[var(--color-primary)] mr-2"></i>An√°lise de Performance</h3>
                        <p class="mb-4">Identifique poss√≠veis gargalos na sua configura√ß√£o atual e receba uma an√°lise detalhada do desempenho esperado.</p>
                        <button id="analyzeBtn" class="btn btn-primary w-full py-2 mb-4"><i class="fas fa-magnifying-glass mr-2"></i>Analisar Configura√ß√£o</button>
                        <div id="ai-result" class="p-4 bg-[var(--color-card-bg-alt)] rounded-lg min-h-[100px] text-[var(--color-text-secondary)]">
                            <p class="italic text-center">A an√°lise aparecer√° aqui ap√≥s clicar no bot√£o acima.</p>
                        </div>
                    </div>
                    
                    <!-- Recomenda√ß√µes de Upgrade -->                    
                    <div class="card p-5 border border-[var(--color-border-subtle)] rounded-lg">
                        <h3 class="text-xl font-semibold mb-3"><i class="fas fa-arrow-trend-up text-[var(--color-primary)] mr-2"></i>Recomenda√ß√µes de Upgrade</h3>
                        <p class="mb-4">Receba sugest√µes personalizadas de melhorias com o melhor custo-benef√≠cio para o seu caso de uso.</p>
                        <button id="upgradeBtn" class="btn btn-primary w-full py-2 mb-4"><i class="fas fa-wand-magic-sparkles mr-2"></i>Sugerir Upgrades</button>
                        <div id="upgrade-result" class="p-4 bg-[var(--color-card-bg-alt)] rounded-lg min-h-[100px] text-[var(--color-text-secondary)]">
                            <p class="italic text-center">As recomenda√ß√µes aparecer√£o aqui ap√≥s clicar no bot√£o acima.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Gr√°ficos de Performance -->                
                <div class="mt-8">
                    <h3 class="text-xl font-semibold mb-4"><i class="fas fa-chart-bar text-[var(--color-primary)] mr-2"></i>Gr√°ficos de Performance</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="card p-4 border border-[var(--color-border-subtle)] rounded-lg">
                            <h4 class="text-lg font-medium mb-3">Performance em Jogos (1080p)</h4>
                            <div class="h-[250px]">
                                <canvas id="gaming-chart"></canvas>
                            </div>
                        </div>
                        <div class="card p-4 border border-[var(--color-border-subtle)] rounded-lg">
                            <h4 class="text-lg font-medium mb-3">Comparativo de Sistemas Operacionais</h4>
                            <div class="h-[250px]">
                                <canvas id="os-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="text-center mt-16 pt-8 border-t border-[var(--color-primary-light)] opacity-90">
            <div class="mb-6">
                <h3 class="text-xl font-semibold text-[var(--color-secondary)] mb-4">Pagamento Facilitado</h3>
                <div class="flex justify-center items-center space-x-1 payment-logos">
                    <a href="https://www.visa.com.br" target="_blank" title="Visa"><i class="fab fa-cc-visa"></i></a>
                    <a href="https://www.mastercard.com.br" target="_blank" title="Mastercard"><i class="fab fa-cc-mastercard"></i></a>
                    <a href="https://www.elo.com.br" target="_blank" title="Elo"><i class="fab fa-cc-elo"></i></a>
                    <a href="https://www.americanexpress.com/pt-br/" target="_blank" title="American Express"><i class="fab fa-cc-amex"></i></a>
                    <a href="https://www.hipercard.com.br" target="_blank" title="Hipercard"><i class="fas fa-credit-card"></i></a> <!-- Generic card for Hipercard -->
                    <a href="https://www.paypal.com/br" target="_blank" title="PayPal"><i class="fab fa-cc-paypal"></i></a>
                    <a href="https://www.mercadopago.com.br/" target="_blank" title="Mercado Pago"><i class="fas fa-handshake"></i></a> <!-- Handshake for MercadoPago -->
                </div>
                 <p class="text-xs text-[var(--color-text-main)] opacity-70 mt-3">Este site √© um configurador para or√ßamento. Nenhuma transa√ß√£o financeira √© realizada aqui.</p>
            </div>

            <div class="contact-links space-x-4 mb-4 text-lg">
                <a href="https://www.linkedin.com/in/deivilsantana/" target="_blank"><i class="fab fa-linkedin"></i> LinkedIn</a>
                <a href="https://github.com/Deivisan" target="_blank"><i class="fab fa-github"></i> GitHub</a>
                <a href="mailto:deivilsantana@outlook.com"><i class="fas fa-envelope"></i> E-mail</a>
                <a href="https://wa.me/5575981231019" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                <a href="https://t.me/+5575981231019" target="_blank"><i class="fab fa-telegram"></i> Telegram</a>
            </div>
            <p class="text-[var(--color-text-main)] text-sm">¬© <span id="current-year"></span> DeiviTech por Deivison Santana. Todos os direitos reservados.</p>
            <p class="text-xs text-[var(--color-text-main)] opacity-70 mt-1">Pre√ßos e disponibilidade s√£o estimativas e sujeitos a confirma√ß√£o.</p>
        </footer>
    </main>

    <div id="order-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">√ó</span>
            <h2 id="modal-title" class="text-2xl font-bold mb-4">Confirma√ß√£o</h2>
            <div id="modal-message-content" class="mb-4"></div>
            <div id="modal-order-summary" class="bg-[var(--color-card-bg-alt)] p-4 rounded-lg border border-[var(--color-border-subtle)] text-sm max-h-60 overflow-y-auto custom-scrollbar"></div>
            <p class="text-lg font-bold mt-4">Total Estimado: <span id="modal-total-price" class="text-[var(--color-primary)]">R$ 0,00</span></p>
            <!-- WhatsApp button will be inserted here by JS -->
            <button id="modal-close-button" class="mt-6 w-full btn btn-secondary">Fechar</button>
        </div>
    </div>

    <script>
        // GENERAL INITIALIZATION
        document.getElementById('current-year').textContent = new Date().getFullYear();
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('in-view'); observer.unobserve(entry.target); }});
        }, { threshold: 0.05 });
        function observeSections() { document.querySelectorAll('section.card, .ready-notebook-card, .service-item, .tab-content').forEach(section => { observer.observe(section); }); }

        // GLOBAL STATE VARIABLES
        let selectedPlatform = null;
        let selectedComponents = {
            platform: null, casing: null, motherboard: null, cpu: null,
            ram: { type: null, quantity: 1 },
            storage1: { type: null }, storage2: { type: 'none' },
            gpu: null, display: null, keyboard: null, os: null,
            os2: null, dualboot_disk: 'same', 
            network_adapter: null, battery: null,
            peripherals: [], 
            software: [] // Consolidated array for all selected software
        };
        let selectedServices = []; // Array of service IDs
        let tradeInCredit = 0;
        let currentMode = 'basic';
        let currentPresetName = "Balanceado";
        let activeTab = 'configure'; 
        let currentSoftwareTab = 'multimedia'; // Default software sub-tab


        // DATA (Components, Presets, Ready Notebooks, Software Categories, Services)
        const components = {
            platform: [
                { id: 'intel', name: 'Plataforma Intel', price: 0, stock: 50, performance_score: 0, icon: 'fab fa-intel', description_basic: 'Processadores e chipsets Intel.', description_advanced: 'Ideal para uma vasta gama de aplica√ß√µes, desde produtividade a gaming de ponta, com tecnologias como Thunderbolt e suporte a mem√≥rias DDR4/DDR5 dependendo do chipset. √ìtima compatibilidade de software.' },
                { id: 'amd', name: 'Plataforma AMD', price: 0, stock: 45, performance_score: 0, icon: 'fa-brands fa-amd', description_basic: 'Processadores e chipsets AMD.', description_advanced: 'Foco em multitarefas e efici√™ncia energ√©tica com CPUs Ryzen. Excelente performance em jogos e cria√ß√£o de conte√∫do, especialmente com APUs potentes (gr√°ficos integrados). Suporte a DDR4/DDR5.' }
            ],            casing: [ 
                { id: 'casing-eco', name: 'Carca√ßa EcoFlex Preta', price: 75, stock: 20, performance_score: 5, icon: 'fas fa-box-open', description_basic: 'Funcional e leve.', description_advanced: 'Policarbonato reciclado, ventila√ß√£o b√°sica, design minimalista, 1x USB 3.0, 2x USB 2.0.' },
                { id: 'casing-silverstone', name: 'Carca√ßa SilverStone Slim Prata', price: 95, stock: 18, performance_score: 10, icon: 'fas fa-laptop', description_basic: 'Elegante e port√°til.', description_advanced: 'Liga de alum√≠nio escovado fina, ideal para portabilidade com estilo. 2x USB 3.1, 1x USB-C.' },
                { id: 'casing-pro-alum', name: 'Carca√ßa Pro Alum√≠nio Grafite', price: 220, stock: 12, performance_score: 15, icon: 'fas fa-laptop-code', description_basic: 'Robusta, alum√≠nio premium.', description_advanced: 'Chassi unibody em alum√≠nio aeroespacial, dissipa√ß√£o t√©rmica superior, durabilidade extra. 2x USB 3.2, 1x Thunderbolt 4 (se mobo suportar).' },
                { id: 'casing-gamer-rgb', name: 'Carca√ßa Gamer RGB Fusion X', price: 280, stock: 10, performance_score: 20, icon: 'fas fa-gamepad', description_basic: 'Design agressivo, RGB.', description_advanced: 'Comp√≥sito com zonas RGB personaliz√°veis, fluxo de ar otimizado para gaming intenso, m√∫ltiplas portas USB 3.2, √°udio aprimorado.' },
                { id: 'casing-ultrabook-mag', name: 'Carca√ßa Ultrabook Magn√©sio Sky', price: 320, stock: 8, performance_score: 18, icon: 'fas fa-feather-alt', description_basic: 'Ultra fina e leve.', description_advanced: 'Liga de magn√©sio, perfil <13mm, peso <1.1kg, m√°xima portabilidade e design sofisticado. 2x USB-C (Thunderbolt opcional).' },
                { id: 'casing-workstation', name: 'Carca√ßa Workstation Titan Pro', price: 380, stock: 6, performance_score: 22, advanced_only: true, icon: 'fas fa-briefcase', description_basic: 'Durabilidade e expans√£o.', description_advanced: 'Estrutura refor√ßada, m√∫ltiplas baias internas (se aplic√°vel ao form factor), ventila√ß√£o robusta, ideal para workstations m√≥veis de alta performance. Suporte a m√∫ltiplas conex√µes I/O.' },
                { id: 'casing-convertible', name: 'Carca√ßa Convert√≠vel Stylus Air', price: 420, stock: 7, performance_score: 16, advanced_only: true, icon: 'fas fa-tablet-alt', description_basic: '2-em-1 com caneta.', description_advanced: 'Dobradi√ßa 360¬∞, tela touch (requer tela compat√≠vel), chassi leve e vers√°til para criatividade. Inclui slot para caneta stylus (caneta opcional).' },
            ],             motherboard: [ 
                { id: 'intel-h610m', name: 'Intel H610M Chipset Mobile', price: 140, platform: 'intel', cpu_socket: 'LGA1700-Mobile', ram_type: 'DDR4', ram_slots: 2, nvme_slots: 1, sata_ports: 2, pcie_gen: 'Gen4', ethernet_speed: '1Gbps', stock: 20, performance_score: 20, basic_only: true, icon: 'fas fa-microchip', description_basic: 'Entrada, DDR4.', description_advanced: 'Chipset H610 para notebooks, 2x DDR4 SO-DIMM (m√°x 64GB @3200MHz), 1x M.2 PCIe 3.0 x4, 2x SATA III, USB 3.2 Gen1. Ideal para tarefas b√°sicas.' },
                { id: 'intel-b760m-wifi', name: 'Intel B760M Mobile Wi-Fi', price: 220, platform: 'intel', cpu_socket: 'LGA1700-Mobile', ram_type: 'DDR4', ram_slots: 2, nvme_slots: 2, sata_ports: 2, pcie_gen: 'Gen4', ethernet_speed: '2.5Gbps', stock: 15, performance_score: 35, icon: 'fas fa-wifi', description_basic: 'Intermedi√°ria, DDR4, Wi-Fi.', description_advanced: 'Chipset B760 para notebooks, 2x DDR4 SO-DIMM (m√°x 64GB @3200MHz+), 2x M.2 PCIe 4.0 x4, Wi-Fi 6 integrado, Bluetooth 5.2. Bom para jogos e produtividade.' }, 
                { id: 'intel-z790-pro-wifi', name: 'Intel Z790 Pro Mobile Wi-Fi DDR5', price: 380, platform: 'intel', cpu_socket: 'LGA1700-Mobile', ram_type: 'DDR5', ram_slots: 2, nvme_slots: 2, sata_ports: 2, pcie_gen: 'Gen5', ethernet_speed: '2.5Gbps', stock: 10, performance_score: 60, advanced_only: true, icon: 'fas fa-broadcast-tower', description_basic: 'Avan√ßada, DDR5, Wi-Fi 6E.', description_advanced: 'Chipset Z790 para notebooks, 2x DDR5 SO-DIMM (m√°x 64GB @5600MHz+), 2x M.2 (1x PCIe 5.0 x4, 1x PCIe 4.0 x4), Wi-Fi 6E, Bluetooth 5.3, Thunderbolt 4 header. Para notebooks high-end.' },
                { id: 'amd-a620m', name: 'AMD A620M Mobile Chipset', price: 130, platform: 'amd', cpu_socket: 'AM5-Mobile', ram_type: 'DDR5', ram_slots: 2, nvme_slots: 1, sata_ports: 2, pcie_gen: 'Gen4', ethernet_speed: '1Gbps', stock: 18, performance_score: 22, basic_only: true, icon: 'fas fa-microchip', description_basic: 'Entrada AM5, DDR5.', description_advanced: 'Chipset A620 para notebooks AMD, 2x DDR5 SO-DIMM (m√°x 32GB @5200MHz), 1x M.2 PCIe 4.0 x4, USB 3.2 Gen2. Entrada para notebooks Ryzen 7000/8000.' },
                { id: 'amd-b650m-plus-wifi', name: 'AMD B650M Mobile Plus Wi-Fi', price: 240, platform: 'amd', cpu_socket: 'AM5-Mobile', ram_type: 'DDR5', ram_slots: 2, nvme_slots: 2, sata_ports: 2, pcie_gen: 'Gen4', ethernet_speed: '2.5Gbps', stock: 14, performance_score: 40, icon: 'fas fa-wifi', description_basic: 'Intermedi√°ria AM5, DDR5, Wi-Fi.', description_advanced: 'Chipset B650 para notebooks, 2x DDR5 SO-DIMM (m√°x 64GB @6000MHz+), 2x M.2 (1x PCIe 5.0 x4, 1x PCIe 4.0 x4), Wi-Fi 6E, Bluetooth 5.2. √ìtimo custo-benef√≠cio para Ryzen m√≥vel.' }, 
                { id: 'amd-x670e-extreme', name: 'AMD X670E Extreme Mobile Gaming', price: 460, platform: 'amd', cpu_socket: 'AM5-Mobile', ram_type: 'DDR5', ram_slots: 2, nvme_slots: 2, sata_ports: 2, pcie_gen: 'Gen5', ethernet_speed: '10Gbps', stock: 7, performance_score: 68, advanced_only: true, icon: 'fas fa-dragon', description_basic: 'High-end AM5, PCIe 5.0.', description_advanced: 'Chipset X670E para notebooks gaming, 2x DDR5 SO-DIMM (suporte a EXPO), Dual M.2 PCIe 5.0, 10GbE LAN, Wi-Fi 7, √°udio de alta defini√ß√£o. VRM robusto para notebooks de alto desempenho.' },
            ],            cpu: [ 
                { id: 'intel-i3-13100h', name: 'Intel Core i3-13100H Mobile', price: 320, socket: 'LGA1700-Mobile', performance_score: 40, stock: 25, icon: 'fas fa-brain', description_basic: 'Entrada eficiente (4C/8T).', description_advanced: '4 Cores, 8 Threads, at√© 4.5GHz. CPU m√≥vel otimizada para notebooks com efici√™ncia energ√©tica. Bom para tarefas do dia a dia e navega√ß√£o.' }, 
                { id: 'intel-i5-13500h', name: 'Intel Core i5-13500H Mobile', price: 520, socket: 'LGA1700-Mobile', performance_score: 65, stock: 20, icon: 'fas fa-brain', description_basic: 'Bom custo-benef√≠cio (12C/16T).', description_advanced: '8 Performance-cores + 4 Efficient-cores, 16 Threads, at√© 4.7GHz. Excelente para notebooks gaming e produtividade.' }, 
                { id: 'intel-i7-13700h', name: 'Intel Core i7-13700H Mobile', price: 880, socket: 'LGA1700-Mobile', performance_score: 85,stock: 10, advanced_only: true, icon: 'fas fa-brain', description_basic: 'Alta performance (16C/24T).', description_advanced: '8 Performance-cores + 8 Efficient-cores, 24 Threads, at√© 5.0GHz. Perfeito para notebooks gaming high-end e cria√ß√£o de conte√∫do.' },
                { id: 'intel-i9-13900h', name: 'Intel Core i9-13900H Mobile', price: 1400, socket: 'LGA1700-Mobile', performance_score: 100, stock: 5, advanced_only: true, icon: 'fas fa-brain', description_basic: 'Performance extrema (20C/28T).', description_advanced: '8 Performance-cores + 12 Efficient-cores, 28 Threads, at√© 5.4GHz. M√°ximo desempenho m√≥vel para notebooks workstation e gaming premium.' },
                { id: 'amd-r5-7535h', name: 'AMD Ryzen 5 7535H Mobile', price: 480, socket: 'AM5-Mobile', performance_score: 62, stock: 18, icon: 'fas fa-brain', description_basic: '√ìtimo p/ notebooks (6C/12T).', description_advanced: '6 Cores, 12 Threads, at√© 4.55GHz. Excelente performance em notebooks com efici√™ncia energ√©tica. Ideal para jogos e produtividade.' }, 
                { id: 'amd-r7-7735h', name: 'AMD Ryzen 7 7735H Mobile', price: 750, socket: 'AM5-Mobile', performance_score: 78, stock: 12, icon: 'fas fa-brain', description_basic: 'CPU m√≥vel potente (8C/16T).', description_advanced: '8 Cores, 16 Threads, at√© 4.75GHz. Ideal para notebooks gaming e cria√ß√£o de conte√∫do com √≥tima efici√™ncia energ√©tica.' }, 
                { id: 'amd-r9-7940h', name: 'AMD Ryzen 9 7940H Mobile', price: 1200, socket: 'AM5-Mobile', performance_score: 95, stock: 6, advanced_only: true, icon: 'fas fa-brain', description_basic: 'Gaming mobile m√°ximo (8C/16T).', description_advanced: '8 Cores, 16 Threads, at√© 5.2GHz. CPU m√≥vel high-end para notebooks gaming premium e workstations m√≥veis.' },
            ],            ram: [                { id: 'ddr4-8gb-3200-1pk', name: '8GB DDR4 3200MHz SO-DIMM (1x8GB)', price: 75, type: 'DDR4', performance_score: 20, stock: 30, icon: 'fas fa-microchip', description_advanced: 'M√≥dulo √∫nico de 8GB DDR4 SO-DIMM a 3200MHz. Ideal para tarefas b√°sicas e sistemas de entrada.' }, 
                { id: 'ddr4-16gb-3200-2pk', name: '16GB DDR4 3200MHz SO-DIMM (2x8GB)', price: 130, type: 'DDR4', performance_score: 30, stock: 25, icon: 'fas fa-microchip', description_advanced: 'Kit dual-channel de 16GB (2x8GB) DDR4 SO-DIMM a 3200MHz. Bom para multitarefas e jogos.' }, 
                { id: 'ddr4-32gb-3600-2pk', name: '32GB DDR4 3600MHz SO-DIMM (2x16GB)', price: 250, type: 'DDR4', performance_score: 40, stock: 12,icon: 'fas fa-microchip', description_advanced: 'Kit dual-channel de 32GB (2x16GB) DDR4 SO-DIMM a 3600MHz. Para usu√°rios avan√ßados e multitarefas intensas.' }, 
                { id: 'ddr5-16gb-5200-1pk', name: '16GB DDR5 5200MHz SO-DIMM (1x16GB)', price: 150, type: 'DDR5', performance_score: 38, stock: 22, icon: 'fas fa-microchip', description_advanced: 'M√≥dulo √∫nico de 16GB DDR5 SO-DIMM a 5200MHz. Padr√£o mais recente para melhor largura de banda.' }, 
                { id: 'ddr5-32gb-5600-2pk', name: '32GB DDR5 5600MHz SO-DIMM (2x16GB)', price: 290, type: 'DDR5', performance_score: 55, stock: 18, icon: 'fas fa-microchip', description_advanced: 'Kit dual-channel de 32GB (2x16GB) DDR5 SO-DIMM a 5600MHz. Excelente para gaming e aplica√ß√µes exigentes.' }, 
                { id: 'ddr5-64gb-6000-2pk', name: '64GB DDR5 6000MHz SO-DIMM (2x32GB)', price: 580, type: 'DDR5', performance_score: 70, stock: 8, advanced_only: true, icon: 'fas fa-microchip', description_advanced: 'Kit dual-channel de 64GB (2x32GB) DDR5 SO-DIMM a 6000MHz. Para notebooks workstation e tarefas que demandam muita mem√≥ria.' },
            ],            storage: [ 
                { id: 'sata-ssd-500gb', name: 'SSD SATA 500GB Econ√¥mico', price: 100, interface: 'SATA', performance_score: 30, stock: 25, icon: 'fas fa-hdd', description_advanced: 'SSD de 500GB com interface SATA III (at√© 550MB/s). Bom para upgrade de HDDs e sistemas de entrada.' }, 
                { id: 'sata-ssd-1tb', name: 'SSD SATA 1TB Plus', price: 170, interface: 'SATA', performance_score: 35, stock: 20, icon: 'fas fa-hdd', description_advanced: 'SSD de 1TB com interface SATA III. Mais espa√ßo com boa velocidade para o padr√£o SATA.' }, 
                { id: 'nvme-gen3-512gb', name: 'SSD NVMe 512GB (PCIe 3.0)', price: 130, interface: 'NVMe', pcie_gen: 'Gen3', performance_score: 48, stock: 22, icon: 'fas fa-compact-disc', description_advanced: 'SSD NVMe de 512GB, interface PCIe 3.0 x4 (at√© 3500MB/s). Velocidade significativamente maior que SATA.' }, 
                { id: 'nvme-gen4-1tb', name: 'SSD NVMe 1TB (PCIe 4.0) Veloz', price: 250, interface: 'NVMe', pcie_gen: 'Gen4', performance_score: 70, stock: 15, icon: 'fas fa-compact-disc', description_advanced: 'SSD NVMe de 1TB, interface PCIe 4.0 x4 (at√© 7000MB/s). Ideal para jogos, edi√ß√£o de v√≠deo e SO.' },
                { id: 'nvme-gen4-2tb', name: 'SSD NVMe 2TB (PCIe 4.0) Ultra', price: 420, interface: 'NVMe', pcie_gen: 'Gen4', performance_score: 80, stock: 10, advanced_only: true, icon: 'fas fa-compact-disc', description_advanced: 'SSD NVMe de 2TB, interface PCIe 4.0 x4. Grande capacidade com velocidades alt√≠ssimas.' },
                 { id: 'nvme-gen4-512gb', name: 'SSD NVMe 512GB (PCIe 4.0) R√°pido', price: 180, interface: 'NVMe', pcie_gen: 'Gen4', performance_score: 65, stock: 10, icon: 'fas fa-compact-disc', description_advanced: 'SSD NVMe de 512GB, interface PCIe 4.0 x4 (at√© 7000MB/s). Ponto de entrada veloz para sistemas Gen4.' },
                { id: 'nvme-gen5-1tb', name: 'SSD NVMe 1TB (PCIe 5.0) Extreme', price: 380, interface: 'NVMe', pcie_gen: 'Gen5', performance_score: 95, stock: 7, advanced_only: true, icon: 'fas fa-rocket', description_advanced: 'SSD NVMe de 1TB, interface PCIe 5.0 x4 (at√© 12000MB/s+). Tecnologia de ponta para m√°xima performance, requer placa-m√£e compat√≠vel.' },
                { id: 'nvme-gen5-2tb', name: 'SSD NVMe 2TB (PCIe 5.0) Monstro', price: 680, interface: 'NVMe', pcie_gen: 'Gen5', performance_score: 110, stock: 5, advanced_only: true, icon: 'fas fa-rocket', description_advanced: 'SSD NVMe de 2TB, interface PCIe 5.0 x4. Capacidade e velocidade extremas para os usu√°rios mais exigentes.' },
            ],            gpu: [ 
                { id: 'integrated', name: 'GPU Integrada (Processador)', price: 0, pcie_gen: 'N/A', performance_score: 15, stock: 999, icon: 'fas fa-image', description_advanced: 'Utiliza os gr√°ficos integrados ao processador (Intel Iris Xe, AMD Radeon Graphics). Adequada para tarefas b√°sicas, multim√≠dia e jogos muito leves. O desempenho varia conforme a CPU.' }, 
                { id: 'nvidia-gtx-1650-mobile', name: 'NVIDIA GTX 1650 Mobile (4GB GDDR6)', price: 380, pcie_gen: 'Gen3', performance_score: 40, stock: 12, icon: 'fas fa-gamepad', description_advanced: 'NVIDIA GeForce GTX 1650 para notebooks com 4GB de mem√≥ria GDDR6. Boa para jogos em 1080p com configura√ß√µes m√©dias. Efici√™ncia energ√©tica otimizada.' }, 
                { id: 'nvidia-rtx-3050-mobile', name: 'NVIDIA RTX 3050 Mobile (6GB GDDR6)', price: 520, pcie_gen: 'Gen4', performance_score: 58, stock: 15, icon: 'fas fa-gamepad', description_advanced: 'NVIDIA GeForce RTX 3050 Mobile com 6GB GDDR6. Suporte a Ray Tracing e DLSS. Boa para jogos em 1080p (m√©dio-alto) em notebooks.' }, 
                { id: 'nvidia-rtx-4060-mobile', name: 'NVIDIA RTX 4060 Mobile (8GB GDDR6)', price: 850, pcie_gen: 'Gen4', performance_score: 80, stock: 10, icon: 'fas fa-gamepad', description_advanced: 'NVIDIA GeForce RTX 4060 Mobile com 8GB GDDR6. Arquitetura Ada Lovelace, eficiente e com DLSS 3. Excelente para 1080p/1440p gaming em notebooks.' },
                { id: 'nvidia-rtx-4070-mobile', name: 'NVIDIA RTX 4070 Mobile (8GB GDDR6X)', price: 1280, pcie_gen: 'Gen4', performance_score: 100, stock: 7, advanced_only: true, icon: 'fas fa-fighter-jet', description_advanced: 'NVIDIA GeForce RTX 4070 Mobile com 8GB GDDR6X. Alto desempenho para notebooks gaming com Ray Tracing e DLSS 3 em 1440p.' },
                { id: 'nvidia-rtx-4080-mobile', name: 'NVIDIA RTX 4080 Mobile (12GB GDDR6X)', price: 1850, pcie_gen: 'Gen4', performance_score: 130, stock: 3, advanced_only: true, icon: 'fas fa-space-shuttle', description_advanced: 'NVIDIA GeForce RTX 4080 Mobile com 12GB GDDR6X. Performance m√°xima para notebooks gaming premium, ideal para 1440p/4K gaming com Ray Tracing.' },
                { id: 'amd-rx-6600m', name: 'AMD RX 6600M Mobile (8GB GDDR6)', price: 450, pcie_gen: 'Gen4', performance_score: 55, stock: 13, icon: 'fas fa-gamepad', description_advanced: 'AMD Radeon RX 6600M com 8GB GDDR6. Placa m√≥vel RDNA2 para jogos em 1080p (m√©dio-alto) com boa efici√™ncia energ√©tica.' }, 
                { id: 'amd-rx-7600m', name: 'AMD RX 7600M Mobile (8GB GDDR6)', price: 720, pcie_gen: 'Gen4', performance_score: 75, stock: 9, icon: 'fas fa-gamepad', description_advanced: 'AMD Radeon RX 7600M com 8GB GDDR6. Arquitetura RDNA3 m√≥vel. √ìtima para jogos em 1080p (alto) e bom desempenho em 1440p em notebooks.' },
                { id: 'amd-rx-7700m', name: 'AMD RX 7700M Mobile (12GB GDDR6)', price: 1100, pcie_gen: 'Gen4', performance_score: 95, stock: 6, advanced_only: true, icon: 'fas fa-fighter-jet', description_advanced: 'AMD Radeon RX 7700M com 12GB GDDR6. Excelente performance em notebooks gaming para 1440p e competente em 4K.' },
            ],
            display: [ 
                { id: 'disp-15fhd60', name: '15.6" FHD IPS (1920x1080, 60Hz)', price: 200, performance_score: 20, stock: 18, icon: 'fas fa-desktop', description_advanced: 'Tela de 15.6 polegadas, resolu√ß√£o Full HD (1920x1080), painel IPS para boas cores e √¢ngulos de vis√£o, taxa de atualiza√ß√£o de 60Hz. Padr√£o para uso geral.' }, 
                { id: 'disp-15fhd144', name: '15.6" FHD IPS (1920x1080, 144Hz)', price: 320, performance_score: 35, stock: 15, icon: 'fas fa-desktop', description_advanced: 'Tela de 15.6" FHD IPS com alta taxa de atualiza√ß√£o de 144Hz para maior fluidez em jogos e movimentos r√°pidos. Ideal para gamers.' }, 
                { id: 'disp-17qhd165', name: '17.3" QHD IPS (2560x1440, 165Hz)', price: 580, performance_score: 55, stock: 9, advanced_only: true, icon: 'fas fa-desktop', description_advanced: 'Tela maior de 17.3", resolu√ß√£o QHD (2.5K) para maior nitidez, painel IPS e taxa de atualiza√ß√£o de 165Hz. Imersiva para jogos e produtividade.' },
                { id: 'disp-16oled4k60', name: '16" OLED 4K (3840x2160, 60Hz)', price: 850, performance_score: 70, stock: 6, advanced_only: true, icon: 'fas fa-palette', description_advanced: 'Tela de 16" com painel OLED para pretos perfeitos e cores vibrantes, resolu√ß√£o 4K UHD. Ideal para criadores de conte√∫do (DCI-P3 100%). 60Hz.' },
                { id: 'disp-14touch', name: '14" FHD IPS Touchscreen (1920x1080, 60Hz)', price: 400, performance_score: 28, stock: 8, icon: 'fas fa-hand-pointer', description_advanced: 'Tela de 14" FHD IPS com funcionalidade touchscreen. Vers√°til para navega√ß√£o e intera√ß√£o direta. Ideal para notebooks 2-em-1 se a carca√ßa for compat√≠vel.' }, 
                { id: 'disp-ultrawide-qhd', name: '15.6" QHD Ultrawide (2560x1080, 120Hz) Curva', price: 700, performance_score: 60, stock: 4, advanced_only: true, icon: 'fas fa-arrows-alt-h', description_advanced: 'Tela de 15.6" com propor√ß√£o ultrawide e leve curvatura para maior imers√£o. Resolu√ß√£o QHD estendida e 120Hz. (Nota: Formato incomum para notebooks, mais conceitual).'},
                { id: 'disp-16miniled-qhd240', name: '16" Mini-LED QHD (2560x1440, 240Hz) HDR1000', price: 1100, performance_score: 85, stock: 3, advanced_only: true, icon: 'fas fa-sun', description_advanced: 'Tela de 16" QHD com retroilumina√ß√£o Mini-LED para alto contraste e brilho (HDR1000). Taxa de atualiza√ß√£o de 240Hz para m√°xima fluidez. Ideal para gaming HDR e profissionais de imagem.'}
            ],
            keyboard: [ 
                { id: 'kbd-membrane-br', name: 'Teclado Membrana ABNT2 Simples', price: 40, performance_score: 5, stock: 25, icon: 'fas fa-keyboard', description_advanced: 'Teclado de membrana padr√£o ABNT2, funcional para digita√ß√£o do dia a dia. Sem retroilumina√ß√£o.' }, 
                { id: 'kbd-backlit-br', name: 'Teclado Retroiluminado ABNT2 (Branco)', price: 70, performance_score: 10, stock: 18, icon: 'fas fa-keyboard', description_advanced: 'Teclado ABNT2 com retroilumina√ß√£o LED na cor branca para melhor visibilidade em ambientes escuros.' }, 
                { id: 'kbd-mech-rgb-br', name: 'Teclado Mec√¢nico RGB ABNT2 (Switch Red)', price: 160, performance_score: 22, stock: 11, icon: 'fas fa-keyboard', description_advanced: 'Teclado mec√¢nico ABNT2 com switches lineares (ex: Red), retroilumina√ß√£o RGB por tecla personaliz√°vel. Ideal para gamers e digita√ß√£o responsiva.' },
                { id: 'kbd-lowprofile-rgb', name: 'Teclado Low-Profile RGB ABNT2 Silencioso', price: 200, performance_score: 18, stock: 8, advanced_only: true, icon: 'fas fa-keyboard', description_advanced: 'Teclado ABNT2 de perfil baixo, com switches mais silenciosos e atua√ß√£o r√°pida. Retroilumina√ß√£o RGB. Design elegante e confort√°vel.' },
                { id: 'kbd-optical-gamer', name: 'Teclado √ìptico Gamer RGB (Resposta R√°pida)', price: 280, performance_score: 28, stock: 5, advanced_only: true, icon: 'fas fa-keyboard', description_advanced: 'Teclado ABNT2 com switches √≥pticos para resposta ultra-r√°pida (menor debounce). Retroilumina√ß√£o RGB e macros program√°veis. Foco em performance competitiva.' },
            ],
            os: [
                { id: 'os-deivios', name: 'Linux DeiviOS (Otimizado)', price: 70, description_basic: 'Leve, r√°pido e customizado para devs.', description_advanced: 'Base Debian com XFCE, focado em performance e ferramentas de desenvolvimento. Kernel otimizado. Ideal para quem busca controle e efici√™ncia. RAM M√≠n: 500MB.', storage_impact: '~10GB', ram_min: '500MB', performance_score: 10, stock: 999, icon: 'fab fa-dev' },
                { id: 'os-ubuntu', name: 'Linux Ubuntu Desktop LTS', price: 0, description_basic: 'Popular, amig√°vel e com grande suporte.', description_advanced: 'Vers√£o LTS mais recente. Interface GNOME. √ìtimo para iniciantes e usu√°rios que buscam estabilidade e vasta comunidade. Perfis de uso podem ser aplicados.', storage_impact: '~20GB', ram_min: '2GB', performance_score: 8, stock: 999, icon: 'fab fa-ubuntu' },
                { id: 'os-mint', name: 'Linux Mint Cinnamon', price: 0, description_basic: 'Elegante, f√°cil de usar, codecs inclusos.', description_advanced: 'Base Ubuntu LTS, interface Cinnamon similar ao Windows. Conhecido pela facilidade de uso e codecs multim√≠dia pr√©-instalados.', storage_impact: '~20GB', ram_min: '1GB', performance_score: 7, stock: 999, icon: 'fab fa-linux' }, 
                { id: 'os-fedora', name: 'Linux Fedora Workstation', price: 0, description_basic: 'Inovador, com software de ponta.', description_advanced: 'Focado em software livre e tecnologias recentes. Interface GNOME padr√£o. Para entusiastas e desenvolvedores que gostam de novidades.', storage_impact: '~18GB', ram_min: '2GB', performance_score: 9, stock: 999, icon: 'fab fa-fedora' },
                { id: 'os-manjaro', name: 'Linux Manjaro XFCE', price: 0, description_basic: 'Base Arch, amig√°vel e poderoso.', description_advanced: 'Rolling release baseado no Arch Linux, mas com foco na facilidade de uso. XFCE √© leve e customiz√°vel.', storage_impact: '~15GB', ram_min: '1GB', performance_score: 10, stock: 999, icon: 'fas fa-kiwi-bird' }, 
                { id: 'os-endeavouros', name: 'Linux EndeavourOS (Arch Based)', price: 0, description_basic: 'Arch Linux com instalador amig√°vel.', description_advanced: 'Para quem quer a experi√™ncia Arch com uma instala√ß√£o mais simples. V√°rias op√ß√µes de DEs durante a instala√ß√£o.', storage_impact: '~10GB + DE', ram_min: '1GB', performance_score: 11, stock: 999, icon: 'fas fa-rocket' },
                { id: 'os-win10-home', name: 'Windows 10 Home', price: 50, description_basic: 'Windows est√°vel e conhecido.', description_advanced: 'Ideal para quem prefere a interface e compatibilidade do Windows 10. Perfis de uso (Multim√≠dia, Gamer, Corporativo) e softwares adicionais podem ser solicitados.', storage_impact: '~30GB', ram_min: '2GB', performance_score: 4, stock: 50, icon: 'fab fa-windows' },
                { id: 'os-win11-home', name: 'Windows 11 Home', price: 50, description_basic: 'Interface moderna e novos recursos.', description_advanced: 'Suporte a DirectX 12 Ultimate, ideal para jogos e aplica√ß√µes gerais. Requisitos de TPM 2.0. Perfis de uso (Multim√≠dia, Gamer, Corporativo) e softwares adicionais podem ser solicitados.', storage_impact: '~30GB', ram_min: '4GB', performance_score: 5, stock: 60, icon: 'fab fa-windows' },
                { id: 'os-win11-pro', name: 'Windows 11 Pro', price: 80, description_basic: 'Recursos avan√ßados para profissionais.', description_advanced: 'Inclui BitLocker, √Årea de Trabalho Remota, Hyper-V. Para uso corporativo e usu√°rios avan√ßados. Perfis de uso e softwares adicionais podem ser solicitados.', storage_impact: '~32GB', ram_min: '4GB', performance_score: 6, stock: 40, advanced_only: true, icon: 'fab fa-windows' },
                { id: 'os-chromeos-flex', name: 'ChromeOS Flex', price: 0, description_basic: 'R√°pido, simples e seguro para nuvem.', description_advanced: 'Baseado na nuvem, inicializa√ß√£o r√°pida, atualiza√ß√µes autom√°ticas. Perfeito para navega√ß√£o e apps web em hardware mais modesto.', storage_impact: '~10GB', ram_min: '2GB', performance_score: 2, stock: 999, basic_only: true, icon: 'fab fa-chrome' },
                { id: 'os-brunch-chromeos', name: 'Brunch ChromeOS (Full)', price: 15, description_basic: 'ChromeOS com Play Store e Linux.', description_advanced: 'Framework para instalar ChromeOS em PCs gen√©ricos, habilitando Google Play Store e ambiente Linux (Crostini). Requer mais configura√ß√£o.', storage_impact: '~25GB', ram_min: '4GB', performance_score: 3, stock: 30, advanced_only: true, icon: 'fab fa-google-play' },
                { id: 'os-none', name: 'Nenhum (Traga sua licen√ßa/SO)', price: 0, description_basic: 'Voc√™ instala seu pr√≥prio SO.', description_advanced: 'Nenhum sistema operacional pr√©-instalado. Requer que voc√™ tenha sua pr√≥pria licen√ßa e m√≠dia de instala√ß√£o. Ideal para usu√°rios avan√ßados ou com licen√ßas espec√≠ficas.', storage_impact: '0GB', ram_min: 'N/A', performance_score: 0, stock: 999, icon: 'fas fa-times-circle' }
            ],
            // Adaptador de rede removido pois est√° integrado na placa m√£e
            network_adapter: [],
            battery: [ 
                { id: 'bat-45wh', name: 'Bateria 45Wh (Padr√£o)', price: 80, performance_score: 5, stock: 20, icon: 'fas fa-battery-half', description_advanced: 'Bateria de √≠on-l√≠tio com capacidade de 45 Watt-hora. Autonomia padr√£o para uso leve a moderado.' }, 
                { id: 'bat-60wh', name: 'Bateria 60Wh (Longa Dura√ß√£o)', price: 140, performance_score: 10, stock: 12, icon: 'fas fa-battery-full', description_advanced: 'Bateria de 60Wh para maior autonomia, permitindo mais tempo de uso longe da tomada. Ideal para portabilidade.' },
                { id: 'bat-75wh-pro', name: 'Bateria 75Wh (Profissional)', price: 200, performance_score: 15, stock: 8, advanced_only: true, icon: 'fas fa-battery-full', description_advanced: 'Bateria de alta capacidade (75Wh) para uso profissional prolongado ou sess√µes de gaming mais longas.' },
                { id: 'bat-99wh-max', name: 'Bateria 99.9Wh (M√°x. Voo)', price: 260, performance_score: 20, stock: 6, advanced_only: true, icon: 'fas fa-plane-departure', description_advanced: 'Bateria de 99.9Wh, a maior capacidade permitida em voos comerciais. M√°xima autonomia para quem est√° sempre em movimento.' },
            ],
            peripherals: [ 
                { id: 'peri-mouse-basic', name: 'Mouse √ìptico B√°sico USB', price: 25, performance_score: 2, stock: 25, icon: 'fas fa-mouse', description: 'Mouse √≥ptico com fio, conex√£o USB, 3 bot√µes. Funcional para navega√ß√£o.' },
                { id: 'peri-mouse-gamer-rgb', name: 'Mouse Gamer RGB ProSensor', price: 80, performance_score: 8, stock: 15, icon: 'fas fa-mouse-pointer', description: 'Mouse gamer com sensor de alta precis√£o (DPI ajust√°vel), bot√µes program√°veis e ilumina√ß√£o RGB.' },
                { id: 'peri-headset-p2', name: 'Headset P2 Confort com Mic', price: 55, performance_score: 5, stock: 18, icon: 'fas fa-headset', description: 'Headset com conex√£o P2 (3.5mm), almofadas confort√°veis e microfone para chamadas e jogos.' },
                { id: 'peri-headset-usb-71', name: 'Headset USB Gamer 7.1 Surround', price: 130, performance_score: 10, stock: 9, advanced_only: true, icon: 'fas fa-headphones-alt', description: 'Headset gamer USB com som surround virtual 7.1, microfone com cancelamento de ru√≠do e ilumina√ß√£o.' },
                { id: 'peri-webcam-hd', name: 'Webcam HD 720p (Integrada/USB)', price: 60, performance_score: 4, stock: 12, icon: 'fas fa-video', description: 'Webcam com resolu√ß√£o HD 720p. Pode ser integrada √† carca√ßa (se compat√≠vel) ou externa via USB.' },
                { id: 'peri-webcam-fhd-pro', name: 'Webcam Full HD 1080p Pro USB com Mic', price: 110, performance_score: 7, stock: 7, advanced_only: true, icon: 'fas fa-camera-retro', description: 'Webcam USB com resolu√ß√£o Full HD 1080p, foco autom√°tico e microfone embutido de melhor qualidade.' },
                { id: 'peri-hub-usbc-multi', name: 'Hub USB-C Multiportas Essencial (HDMI, USB-A)', price: 95, performance_score: 3, stock: 10, icon: 'fas fa-plug', description: 'Hub USB-C compacto com sa√≠das HDMI, portas USB-A adicionais e, possivelmente, leitor de cart√£o.' },
                { id: 'peri-cooler-base-led', name: 'Base Cooler para Notebook com LED', price: 70, performance_score: 6, stock: 8, icon: 'fas fa-fan', description: 'Base refrigeradora com ventoinhas para auxiliar na dissipa√ß√£o de calor do notebook. Ilumina√ß√£o LED.' },
                { id: 'peri-mochila-nb', name: 'Mochila Acolchoada para Notebook at√© 17"', price: 120, performance_score: 1, stock: 11, icon: 'fas fa-briefcase', description: 'Mochila com compartimento acolchoado para proteger notebooks de at√© 17 polegadas. M√∫ltiplos bolsos.' },
                { id: 'peri-ssd-externo-500gb', name: 'SSD Externo USB 3.2 500GB Port√°til', price: 220, performance_score: 9, stock: 6, icon: 'fas fa-external-link-square-alt', description: 'Unidade SSD externa de 500GB com conex√£o USB 3.2 para transfer√™ncias r√°pidas. Port√°til e resistente.' },
            ]
        }; 
        
         const softwareCategories = {
            multimedia: [
                { id: 'sw-vlc', name: 'VLC Media Player', price: 0, description: 'Reprodutor multim√≠dia vers√°til, suporta quase todos os formatos.', icon: 'fas fa-play-circle', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-spotify', name: 'Spotify Desktop', price: 0, description: 'Cliente desktop para streaming de m√∫sica.', icon: 'fab fa-spotify', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-ubuntu', 'os-mint', 'os-fedora'], stock: 999 },
                { id: 'sw-kodi', name: 'Kodi Media Center', price: 0, description: 'Software de media center de c√≥digo aberto.', icon: 'fas fa-tv', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint'], stock: 999 },
                { id: 'sw-netflix-app', name: 'App Netflix (Windows)', price: 0, description: 'App da loja para Netflix (requer assinatura).', icon: 'fas fa-film', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro'], stock: 999 },
            ],
            design: [
                { id: 'sw-gimp', name: 'GIMP', price: 0, description: 'Editor de imagens poderoso, alternativa ao Photoshop.', icon: 'fas fa-paint-brush', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-blender', name: 'Blender', price: 0, description: 'Su√≠te de cria√ß√£o 3D: modelagem, anima√ß√£o, renderiza√ß√£o.', icon: 'fas fa-cube', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-krita', name: 'Krita', price: 0, description: 'Software de pintura digital profissional e gratuito.', icon: 'fas fa-palette', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora'], stock: 999 },
                { id: 'sw-davinciresolve', name: 'DaVinci Resolve (Gr√°tis)', price: 0, description: 'Editor de v√≠deo profissional com corre√ß√£o de cor avan√ßada.', stock: 999, icon: 'fas fa-video', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-ubuntu', 'os-mint', 'os-fedora'] },
                { id: 'sw-inkscape', name: 'Inkscape', price: 0, description: 'Editor de gr√°ficos vetoriais de c√≥digo aberto.', icon: 'fas fa-vector-square', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora'], stock: 999 },
            ],
            development: [
                { id: 'sw-vscode', name: 'VS Code', price: 0, description: 'Editor de c√≥digo fonte popular e extens√≠vel.', icon: 'fas fa-code', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-git', name: 'Git SCM', price: 0, description: 'Sistema de controle de vers√£o distribu√≠do.', icon: 'fab fa-git-alt', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-docker', name: 'Docker Desktop', price: 0, description: 'Plataforma de cont√™ineres Light (pode requerer Pro no Windows).', icon: 'fab fa-docker', os_req: ['os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora'], stock: 999 },
                { id: 'sw-python', name: 'Python (√öltima Vers√£o)', price: 0, description: 'Linguagem de programa√ß√£o Python e pip.', icon: 'fab fa-python', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                { id: 'sw-nodejs', name: 'Node.js (LTS)', price: 0, description: 'Ambiente de execu√ß√£o JavaScript (Node.js e npm).', icon: 'fab fa-node-js', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
            ],
            productivity: [ // Changed from productivity/corp to productivity/Outros based on target UI
                 { id: 'sw-libreoffice', name: 'LibreOffice Suite', price: 0, description: 'Alternativa gratuita e de c√≥digo aberto ao Microsoft Office.', icon: 'fas fa-file-alt', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                 { id: 'sw-office365-personal-trial', name: 'Microsoft 365 Personal (Trial 1 M√™s)', price: 20, description: 'Word, Excel, PowerPoint, Outlook. Requer ativa√ß√£o.', icon: 'fas fa-file-word', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro'], stock: 999 },
                 { id: 'sw-msoffice-home-student-2021', name: 'Microsoft Office Home & Student 2021', price: 350, description: 'Word, Excel, PowerPoint (Licen√ßa Perp√©tua).', icon: 'fas fa-user-graduate', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro'], stock: 20 },
                 { id: 'sw-qbittorrent', name: 'qBittorrent', price: 0, description: 'Cliente BitTorrent leve, r√°pido e sem an√∫ncios.', icon: 'fas fa-cloud-download-alt', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
                 { id: 'sw-7zip', name: '7-Zip', price: 0, description: 'Compactador/Descompactador de arquivos gratuito.', icon: 'fas fa-file-archive', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora'], stock: 999 },
                 { id: 'sw-powertoys', name: 'Microsoft PowerToys (Windows)', price: 0, description: 'Conjunto de utilit√°rios para customiza√ß√£o e produtividade.', icon: 'fas fa-tools', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro'], stock: 999 },
                 { id: 'sw-steam', name: 'Steam Client', price: 0, description: 'Plataforma de jogos digitais.', icon: 'fab fa-steam', os_req: ['os-win10-home', 'os-win11-home', 'os-win11-pro', 'os-deivios', 'os-ubuntu', 'os-mint', 'os-fedora', 'os-manjaro', 'os-endeavouros'], stock: 999 },
            ]
        };

        const services = [
            { 
                id: 'serv-os-install-win', name: 'Instala√ß√£o Windows (Home/Pro)', basePrice: 80, 
                description: 'Instala√ß√£o limpa do Windows 10 ou 11 (licen√ßa n√£o inclusa se n√£o adquirida conosco). Inclui drivers b√°sicos e otimiza√ß√µes.',
                details: `<strong>Procedimento:</strong><br>1. Backup de dados (se aplic√°vel, cobrado √† parte).<br>2. Formata√ß√£o da unidade de destino.<br>3. Instala√ß√£o do Windows a partir de m√≠dia oficial.<br>4. Instala√ß√£o de drivers essenciais da placa-m√£e e componentes.<br>5. Otimiza√ß√µes b√°sicas (inicializa√ß√£o, servi√ßos).<br>6. Ativa√ß√£o do Windows (com chave do cliente ou adquirida).<br><i>Perfis de uso (Multim√≠dia +R$30, Gamer +R$40, Corporativo +R$50) podem ser adicionados.</i>`,
                icon: 'fab fa-windows'
            },
            { 
                id: 'serv-os-install-linux', name: 'Instala√ß√£o Linux (Ubuntu, Mint, DeiviOS etc.)', basePrice: 70, 
                description: 'Instala√ß√£o da sua distribui√ß√£o Linux preferida, com ambiente desktop padr√£o e drivers.',
                details: `<strong>Procedimento:</strong><br>1. Backup de dados (se aplic√°vel).<br>2. Particionamento adequado (manual ou autom√°tico).<br>3. Instala√ß√£o da distribui√ß√£o Linux escolhida.<br>4. Configura√ß√£o de drivers e reposit√≥rios.<br>5. Instala√ß√£o de codecs e apps b√°sicos (se solicitado).<br><i>Dual boot com Windows existente: +R$40.</i>`,
                icon: 'fab fa-linux' 
            },
            {
                id: 'serv-ram-upgrade', name: 'Upgrade de Mem√≥ria RAM', basePrice: 50,
                description: 'Instala√ß√£o de novos m√≥dulos de RAM (custo do(s) m√≥dulo(s) de RAM n√£o incluso).',
                details: `<strong>Procedimento:</strong><br>1. Verifica√ß√£o de compatibilidade (tipo DDR, velocidade, capacidade m√°xima).<br>2. Abertura segura do notebook.<br>3. Instala√ß√£o dos novos m√≥dulos de RAM nos slots corretos.<br>4. Teste de reconhecimento e estabilidade.<br><u>Custo da RAM a ser adicionado</u>. Ex: 8GB DDR4 ~R$100-150. 16GB DDR5 ~R$200-300. Valores variam.`,
                icon: 'fas fa-microchip'
            },
            {
                id: 'serv-storage-upgrade', name: 'Upgrade de Armazenamento (HDD p/ SSD/NVMe)', basePrice: 70,
                description: 'Substitui√ß√£o ou adi√ß√£o de SSD/NVMe (custo do dispositivo n√£o incluso). Clonagem opcional.',
                details: `<strong>Procedimento:</strong><br>1. Verifica√ß√£o de compatibilidade (SATA, M.2 NVMe/SATA, PCIe Gen).<br>2. Opcional: Clonagem do sistema antigo para o novo SSD (+R$50, se vi√°vel tecnicamente).<br>3. Instala√ß√£o f√≠sica do novo SSD/NVMe.<br>4. Formata√ß√£o e inicializa√ß√£o (se instala√ß√£o limpa) ou verifica√ß√£o da clonagem.<br><u>Custo do SSD/NVMe a ser adicionado</u>. Ex: SSD SATA 1TB ~R$250. NVMe 1TB Gen4 ~R$350. Valores variam.`,
                icon: 'fas fa-hdd'
            },
            {
                id: 'serv-wifi-upgrade', name: 'Upgrade de Adaptador Wi-Fi/Bluetooth', basePrice: 60,
                description: 'Substitui√ß√£o do m√≥dulo Wi-Fi/BT por um mais moderno (custo do m√≥dulo n√£o incluso).',
                details: `<strong>Procedimento:</strong><br>1. Identifica√ß√£o do m√≥dulo atual e compatibilidade do slot (geralmente M.2 A+E Key).<br>2. Remo√ß√£o cuidadosa do m√≥dulo antigo e suas antenas.<br>3. Instala√ß√£o do novo m√≥dulo e reconex√£o das antenas.<br>4. Instala√ß√£o de drivers e teste de conex√£o.<br><u>Custo do m√≥dulo a ser adicionado</u>. Ex: Wi-Fi 6/BT5.2 ~R$100-180. Valores variam.`,
                icon: 'fas fa-wifi'
            },
             {
                id: 'serv-internal-cleaning', name: 'Limpeza Interna de Componentes + Pasta T√©rmica', basePrice: 90,
                description: 'Limpeza de poeira em coolers, dissipadores e placa m√£e. Troca de pasta t√©rmica (CPU/GPU).',
                details: `<strong>Procedimento:</strong><br>1. Abertura segura do notebook.<br>2. Remo√ß√£o de poeira acumulada com ar comprimido e pinc√©is antiest√°ticos.<br>3. Limpeza de ventoinhas e sa√≠das de ar.<br>4. Remo√ß√£o da pasta t√©rmica antiga de CPU e GPU.<br>5. Aplica√ß√£o de nova pasta t√©rmica de qualidade (ex: Arctic MX-4 ou similar).<br>6. Remontagem e teste de temperaturas.`,
                icon: 'fas fa-broom'
            },
            {
                id: 'serv-data-backup', name: 'Backup de Dados (at√© 500GB)', basePrice: 80,
                description: 'Backup de seus arquivos pessoais para m√≠dia externa ou nuvem (m√≠dia/armazenamento n√£o incluso).',
                details: `<strong>Procedimento:</strong><br>1. Identifica√ß√£o das pastas e arquivos a serem backupeados (Ex: Documentos, Imagens, Desktop).<br>2. C√≥pia dos dados para um HD externo do cliente ou para novo dispositivo.<br>3. Verifica√ß√£o b√°sica da integridade do backup.<br>Para volumes maiores ou backup de sistema completo (imagem), valor sob consulta.`,
                icon: 'fas fa-save'
            },
            {
                id: 'serv-consultancy', name: 'Consultoria e Diagn√≥stico Completo Avan√ßado', basePrice: 120,
                description: 'An√°lise profunda, testes de stress, identifica√ß√£o de gargalos, relat√≥rio detalhado e plano de otimiza√ß√£o/upgrade.',
                details: `<strong>Inclui:</strong><br>1. Entrevista para entender necessidades e problemas.<br>2. Testes de hardware (CPU, GPU, RAM, Storage, Temperaturas).<br>3. An√°lise de software e performance do sistema.<br>4. Identifica√ß√£o de gargalos e poss√≠veis falhas.<br>5. Relat√≥rio com diagn√≥stico e sugest√µes personalizadas.<br><i>Valor pode ser parcialmente abatido em servi√ßos/produtos adquiridos no mesmo atendimento.</i>`,
                icon: 'fas fa-stethoscope'
            },
            {
                id: 'serv-iptv-test', name: 'Solicitar Teste IPTV Gr√°tis (7 dias)', basePrice: 0,
                description: 'Experimente nosso servi√ßo de IPTV parceiro por 7 dias. Sujeito √† disponibilidade e termos.',
                details: `<strong>Como funciona:</strong><br>1. Ap√≥s selecionar este "servi√ßo", entraremos em contato via WhatsApp.<br>2. Forneceremos as credenciais e instru√ß√µes para o teste.<br>3. O teste √© v√°lido por 7 dias corridos.<br>4. Requer aplicativo compat√≠vel (ex: para SmartTV, Celular, TV Box) e boa conex√£o de internet.<br><i>Este √© um teste sem compromisso de um servi√ßo parceiro. A DeiviTech n√£o se responsabiliza pelo conte√∫do ou estabilidade do servi√ßo de IPTV.</i>`,
                icon: 'fas fa-tv-alt' // Specific IPTV icon from Font Awesome: fas fa-tv-alt / fas fa-satellite-dish
            }
        ];
        
        const qualityPresets = { 
            0: { 
                name: 'Econ√¥mico', platform: 'intel', casing: 'casing-eco', motherboard: 'intel-h610m', cpu: 'intel-i3-13100f',
                ram_type: 'ddr4-8gb-3200-1pk', ram_quantity: 1, storage1_type: 'sata-ssd-500gb', storage2_type: 'none',
                gpu: 'integrated', display: 'disp-15fhd60', keyboard: 'kbd-membrane-br', battery: 'bat-45wh',
                os: 'os-deivios', network_adapter: 'wifi5-bt4', peripherals: [], software: ['sw-libreoffice', 'sw-vlc'], mode_target: 'basic'
            },
            1: { 
                name: 'Balanceado', platform: 'amd', casing: 'casing-silverstone', motherboard: 'amd-b650m-plus-wifi', cpu: 'amd-r5-7500f',
                ram_type: 'ddr5-16gb-5200-1pk', ram_quantity: 1, storage1_type: 'nvme-gen4-1tb', storage2_type: 'none',
                gpu: 'nvidia-rtx-3050-6gb', display: 'disp-15fhd144', keyboard: 'kbd-backlit-br', battery: 'bat-60wh',
                os: 'os-win11-home', network_adapter: 'wifi6-bt5', peripherals: ['peri-mouse-gamer-rgb'], software: ['sw-libreoffice', 'sw-vlc', 'sw-steam'], mode_target: 'basic'
            },
            2: { 
                name: 'Performance', platform: 'intel', casing: 'casing-gamer-rgb', motherboard: 'intel-z790-pro-wifi', cpu: 'intel-i7-14700k',
                ram_type: 'ddr5-32gb-5600-2pk', ram_quantity: 1, storage1_type: 'nvme-gen5-1tb', storage2_type: 'nvme-gen4-1tb',
                gpu: 'nvidia-rtx-4070ti-12gb', display: 'disp-17qhd165', keyboard: 'kbd-mech-rgb-br', battery: 'bat-75wh-pro',
                os: 'os-win11-pro', network_adapter: 'wifi6e-bt53', peripherals: ['peri-mouse-gamer-rgb', 'peri-headset-usb-71'], software: ['sw-steam', 'sw-davinciresolve', 'sw-blender', 'sw-office365-personal-trial'], mode_target: 'advanced'
            }
        };

        const readyNotebooks = [
            {
                id: 'ready-office-basic', name: 'DeiviTech OfficeStart Linux', hardwarePrice: 310, defaultOsId: 'os-deivios', 
                image: 'https://placehold.co/300x200/7f8c8d/ffffff?text=OfficeStart',
                specs: { platform: 'intel', casing: 'casing-eco', motherboard: 'intel-h610m', cpu: 'intel-i3-13100f', ram_type: 'ddr4-8gb-3200-1pk', ram_quantity: 1, storage1: 'sata-ssd-500gb', gpu: 'integrated', display: 'disp-15fhd60', keyboard: 'kbd-membrane-br', battery: 'bat-45wh' },
                description: "Notebook b√°sico e eficiente para estudos e trabalho com Linux. SSD para agilidade."
            },
            {
                id: 'ready-student-plus-win', name: 'DeiviTech StudentPlus Windows', hardwarePrice: 1600, defaultOsId: 'os-win11-home', 
                image: 'https://placehold.co/300x200/2ecc71/ffffff?text=StudentPlus',
                specs: { platform: 'amd', casing: 'casing-silverstone', motherboard: 'amd-a620m', cpu: 'amd-r5-7500f', ram_type: 'ddr5-16gb-5200-1pk', ram_quantity: 1, storage1: 'nvme-gen3-512gb', gpu: 'integrated', display: 'disp-15fhd60', keyboard: 'kbd-backlit-br', battery: 'bat-60wh'},
                description: "Ideal para estudantes: Port√°til, bom desempenho com Ryzen 5, SSD NVMe e Windows 11 Home. Tela Full HD e teclado retroiluminado."
            },
             {
                id: 'ready-devmaster-linux', name: 'DeiviTech DevMaster Linux', hardwarePrice: 2780, defaultOsId: 'os-deivios',
                image: 'https://placehold.co/300x200/1abc9c/ffffff?text=DevMaster+Linux',
                specs: { platform: 'amd', casing: 'casing-pro-alum', motherboard: 'amd-b650m-plus-wifi', cpu: 'amd-r7-8700g', ram_type: 'ddr5-32gb-5600-2pk', ram_quantity: 1, storage1: 'nvme-gen4-1tb', gpu: 'integrated', display: 'disp-15fhd144', keyboard: 'kbd-backlit-br', battery: 'bat-60wh' },
                description: "Pot√™ncia e leveza para desenvolvedores Linux. CPU AMD Ryzen com NPU, 32GB RAM DDR5 e SSD NVMe r√°pido. Tela Full HD 144Hz e DeiviOS otimizado."
            },
            {
                id: 'ready-gamer-rtx4060', name: 'DeiviTech GamerBlast RTX4060', hardwarePrice: 4250, defaultOsId: 'os-win11-home',
                image: 'https://placehold.co/300x200/e74c3c/ffffff?text=GamerBlast+4060',
                specs: { platform: 'intel', casing: 'casing-gamer-rgb', motherboard: 'intel-b760m-wifi', cpu: 'intel-i5-14400f', ram_type: 'ddr4-16gb-3200-2pk', ram_quantity: 1, storage1: 'nvme-gen4-1tb', gpu: 'nvidia-rtx-4060-8gb', display: 'disp-15fhd144', keyboard: 'kbd-mech-rgb-br', battery: 'bat-60wh'},
                description: "Domine seus jogos com a RTX 4060 e CPU Intel de 14¬™ gera√ß√£o. 16GB RAM, SSD NVMe veloz e tela 144Hz para uma experi√™ncia fluida."
            },
            { 
                id: 'ready-ultralight-copilot', name: 'DeiviTech Air Copilot+', hardwarePrice: 1500, defaultOsId: 'os-win11-home', // Hardware price is mobo + chip + ram etc.
                image: 'https://placehold.co/300x200/3498db/ecf0f1?text=Air+Copilot%2B',
                specs: { platform: 'arm', casing: 'casing-ultrabook-mag', motherboard: 'custom-arm-copilot', cpu: 'snapdragon-x-elite', ram_type: 'lpddr5x-16gb', ram_quantity: 1, storage1: 'nvme-gen4-512gb', gpu: 'adreno-copilot', display: 'disp-14touch', keyboard: 'kbd-lowprofile-rgb', battery: 'bat-75wh-pro' },
                description: "O futuro da computa√ß√£o m√≥vel com Snapdragon X Elite e NPU. Ultraleve, bateria de longa dura√ß√£o e Windows 11 otimizado para IA. (Modelo conceitual)"
            }
        ];


        // HELPER FUNCTIONS
        const formatPrice = (price) => `R$ ${Number(price).toFixed(2).replace('.', ',')}`;
        
        const getComponentById = (category, id) => {
            if (!id || id === 'none' || id === 'peri-none') return null;
            if (category === 'software') {
                for (const softCat in softwareCategories) {
                    const found = softwareCategories[softCat].find(s => s.id === id);
                    if (found) return found;
                }
                return null;
            }
            return components[category]?.find(c => c.id === id) || null;
        };
        
        const getComponentPrice = (category, id) => {
             const comp = getComponentById(category, id);
             if (comp && comp.hasOwnProperty('price')) return comp.price; // Check if price property exists
             return 0; // Return 0 if no price is found (e.g. for conceptual or bundled items)
        };
        const getServiceById = (id) => services.find(s => s.id === id);
        const getServicePrice = (id) => getServiceById(id)?.basePrice || 0;

        const getComponentDescription = (item, mode) => {
            if (!item) return 'N/A';
            const desc = mode === 'basic' ? (item.description_basic || item.description || item.description_advanced) : (item.description_advanced || item.description || item.description_basic); 
            return desc || 'Descri√ß√£o n√£o dispon√≠vel.';
        };

        const isComponentVisible = (item, mode, currentPlatform) => { // currentPlatform is mostly for motherboards at this stage
            if (!item) return false;
            
            // Platform filtering for motherboard is handled in getFilteredOptions.
            // This function's main role for visibility is basic/advanced mode.
            const showInBasic = item.basic_only === true;
            const showInAdvanced = item.advanced_only === true;

            if (mode === 'basic') {
                // If it's specifically for basic OR if it's not specified for basic/advanced (general component)
                // AND it's not advanced_only
                return (showInBasic || (!showInBasic && !showInAdvanced)) && !showInAdvanced;
            }
            if (mode === 'advanced') {
                // Show if it's advanced_only OR if it's not specified for basic/advanced (general component)
                // OR if it's not basic_only (advanced users can see basic components too)
                return true; // Simplification: Advanced mode sees everything
            }
            // Fallback for an unknown mode (should not happen)
            return !showInBasic && !showInAdvanced; 
        };        // CORE LOGIC FUNCTIONS        
        function showTab(tabName) {
            activeTab = tabName;
            ['concept', 'configure', 'ready', 'tradein', 'services', 'specific-budget'].forEach(id => {
                const contentEl = document.getElementById(`${id}-tab-content`);
                const tabBtnEl = document.getElementById(`tab-${id}`);
                if (contentEl) contentEl.style.display = tabName === id ? 'block' : 'none';
                if (tabBtnEl) {
                    if (tabBtnEl.classList.contains('advanced-mode-tab') && !tabBtnEl.classList.contains('functional')) {
                        // Do not toggle active for non-functional advanced tabs
                    } else {
                        tabBtnEl.classList.toggle('active', tabName === id);
                    }
                }
            });
            
            // Scroll para o topo quando trocar de aba, especialmente para 'configure'
            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 100);
            
            if (tabName === 'configure') {
                populateOptions(); 
                populateDetailedSoftwareOptions();
            }
            
            if(tabName === 'ready') populateReadyNotebooks();
            if(tabName === 'services') populateServices();
            if(tabName === 'concept') {
                // Inicializa os gr√°ficos na aba de conceito
                setTimeout(() => {
                    const conceptTabContent = document.getElementById('concept-tab-content');
                    if (conceptTabContent && conceptTabContent.style.display !== 'none') {
                        initNotebookCharts();
                    }
                }, 300);
            }
            if(['concept', 'configure', 'ready', 'tradein', 'services', 'specific-budget'].includes(tabName)) {
                 setTimeout(observeSections, 100); 
            }
        }
        
        function populateReadyNotebooks() {
            const container = document.getElementById('ready-notebooks-container');
            container.innerHTML = '';
            readyNotebooks.forEach(nb => {
                const card = document.createElement('div');
                card.className = 'ready-notebook-card card flex flex-col justify-between';
                
                let specsHtml = '<ul class="text-xs space-y-1 mt-2 mb-3 list-disc list-inside">';
                if(nb.specs.cpu) specsHtml += `<li><strong>CPU:</strong> ${getComponentById('cpu', nb.specs.cpu)?.name || nb.specs.cpu}</li>`;
                if(nb.specs.ram_type) {
                    const ramComp = getComponentById('ram', nb.specs.ram_type);
                    specsHtml += `<li><strong>RAM:</strong> ${ramComp ? ramComp.name : nb.specs.ram_type}</li>`;
                }
                if(nb.specs.gpu) specsHtml += `<li><strong>GPU:</strong> ${getComponentById('gpu', nb.specs.gpu)?.name || nb.specs.gpu}</li>`;
                if(nb.specs.storage1) specsHtml += `<li><strong>Armazen.:</strong> ${getComponentById('storage', nb.specs.storage1)?.name || nb.specs.storage1}</li>`;
                if(nb.specs.display) specsHtml += `<li><strong>Tela:</strong> ${getComponentById('display', nb.specs.display)?.name || nb.specs.display}</li>`;
                
                const defaultOsInfo = getComponentById('os', nb.defaultOsId);
                const defaultOsPrice = defaultOsInfo ? defaultOsInfo.price : 0;
                const initialTotalPrice = nb.hardwarePrice + defaultOsPrice;

                specsHtml += `<li><strong>SO Padr√£o:</strong> ${defaultOsInfo?.name || nb.defaultOsId}</li>`;
                specsHtml += '</ul>';

                let osSelectorHtml = `<div class="mt-2 mb-3">
                    <label for="ready-os-${nb.id}" class="block text-sm font-medium text-[var(--color-text-card)] mb-1">Sistema Operacional:</label>
                    <select id="ready-os-${nb.id}" data-notebook-id="${nb.id}" data-hardware-price="${nb.hardwarePrice}" data-default-os-price="${defaultOsPrice}" class="ready-notebook-os-select block w-full custom-select text-sm">`;
                
                components.os.forEach(os => {
                    if (os.id !== 'os-none') {
                        const osHardwareTotal = nb.hardwarePrice + os.price;
                        let priceDiffIndicator = "";
                        if (os.price > defaultOsPrice) priceDiffIndicator = ` (+${formatPrice(os.price - defaultOsPrice)})`;
                        else if (os.price < defaultOsPrice) priceDiffIndicator = ` (-${formatPrice(defaultOsPrice - os.price)})`;
                        
                        osSelectorHtml += `<option value="${os.id}" data-total-price="${osHardwareTotal}" ${os.id === nb.defaultOsId ? 'selected' : ''}>
                            ${os.name}${priceDiffIndicator}
                        </option>`;
                    }
                });
                osSelectorHtml += `</select></div>`;

                card.innerHTML = `
                     <div class="flex-grow flex flex-col"> <!-- Ensure card content can grow -->
                        <div class="flex justify-between items-start mb-2"> <!-- Image and Title Row -->
                            <img src="${nb.image}" alt="${nb.name}" class="w-2/5 h-auto object-cover rounded-md mr-3">
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-xl font-bold text-[var(--color-primary)] mb-1">${nb.name}</h3>
                                    <a href="#" onclick="alert('V√≠deo demonstrativo em breve!'); return false;" title="Ver v√≠deo do notebook em funcionamento (em breve)">
                                        <i class="fas fa-video text-xl text-[var(--color-primary)] hover:text-[var(--color-primary-hover)]"></i>
                                    </a>
                                </div>
                                <p class="text-sm text-gray-600 body.dark-mode:text-gray-400 min-h-[50px]">${nb.description}</p>
                            </div>
                        </div>
                        <div class="flex-grow"> <!-- Specs and OS selector, allowing it to take space -->
                            ${specsHtml}
                            ${osSelectorHtml}
                        </div>
                    </div>
                    <div class="mt-auto pt-3"> <!-- Ensure this is at the bottom -->
                        <p class="text-2xl font-bold text-[var(--color-secondary)] text-center mb-3" id="price-display-${nb.id}">${formatPrice(initialTotalPrice)}</p>
                        <button class="btn btn-secondary w-full" onclick="selectReadyNotebook('${nb.id}')">Ver Detalhes e Encomendar</button>
                    </div>
                `;
                container.appendChild(card);
                observer.observe(card); 

                document.getElementById(`ready-os-${nb.id}`).addEventListener('change', function() {
                    const selectedOption = this.options[this.selectedIndex];
                    const newTotalPrice = parseFloat(selectedOption.dataset.totalPrice);
                    document.getElementById(`price-display-${this.dataset.notebookId}`).textContent = formatPrice(newTotalPrice);
                });
                document.getElementById(`ready-os-${nb.id}`).dispatchEvent(new Event('change'));
            });
        }

        function selectReadyNotebook(notebookId) {
            const nb = readyNotebooks.find(n => n.id === notebookId);
            if (!nb) return;

            const osSelectEl = document.getElementById(`ready-os-${notebookId}`);
            const selectedOsId = osSelectEl.value;
            const selectedOsOption = osSelectEl.options[osSelectEl.selectedIndex];
            const finalPrice = parseFloat(selectedOsOption.dataset.totalPrice);

            selectedPlatform = null;
            Object.keys(selectedComponents).forEach(cat => {
                if (cat === 'ram') selectedComponents.ram = { type: null, quantity: 1 };
                else if (cat === 'storage1') selectedComponents.storage1 = { type: null };
                else if (cat === 'storage2') selectedComponents.storage2 = { type: 'none' };
                else if (cat === 'peripherals' || cat === 'software') selectedComponents[cat] = [];
                else selectedComponents[cat] = null;
            });

            selectedPlatform = nb.specs.platform;
            selectedComponents.platform = nb.specs.platform;
            Object.keys(nb.specs).forEach(specCat => {
                if (nb.specs.hasOwnProperty(specCat)) {
                    if (specCat === 'ram_type') {
                        selectedComponents.ram.type = nb.specs.ram_type;
                        selectedComponents.ram.quantity = nb.specs.ram_quantity || 1;
                    } else if (specCat === 'storage1') {
                        selectedComponents.storage1.type = nb.specs.storage1;
                    } else if (selectedComponents.hasOwnProperty(specCat)) {
                        selectedComponents[specCat] = nb.specs[specCat];
                    }
                }
            });
            selectedComponents.os = selectedOsId; 
            
            currentPresetName = `Pronto: ${nb.name} (${getComponentById('os', selectedOsId)?.name})`;
            document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;
            
            showTab('configure'); 
            populateOptions(); 
            populateDetailedSoftwareOptions();
            updateVisualSelections(); 
            updateTotal(); 
            
            window.scrollTo({ top: document.getElementById('quality-slider-section').offsetTop - 20, behavior: 'smooth' });
            
            openOrderModalForReadyNotebook(nb, selectedOsId, finalPrice);
        }
        
        function openOrderModalForReadyNotebook(notebook, finalOsId, finalPrice) {
            const modalTitleEl = document.getElementById('modal-title');
            const modalMessageContentEl = document.getElementById('modal-message-content');
            const modalOrderSummaryEl = document.getElementById('modal-order-summary');
            const modalTotalPriceEl = document.getElementById('modal-total-price');
            const orderModal = document.getElementById('order-modal');

            modalTitleEl.textContent = `Encomendar Notebook Pronto: ${notebook.name}`;
            modalMessageContentEl.innerHTML = `<p>Voc√™ selecionou o notebook pronto <strong>${notebook.name}</strong> com <strong>${getComponentById('os', finalOsId)?.name || finalOsId}</strong>. Verifique os detalhes abaixo.</p>`;
            
            let summaryHtml = `<strong>Configura√ß√£o Principal:</strong><br>`;
            const specs = notebook.specs;
            const getCompName = (cat, id) => getComponentById(cat, id)?.name || id || 'N/A';

            summaryHtml += `* Plataforma: ${getCompName('platform', specs.platform)}<br>`;
            summaryHtml += `* Carca√ßa: ${getCompName('casing', specs.casing)}<br>`;
            summaryHtml += `* Placa M√£e: ${getCompName('motherboard', specs.motherboard)}<br>`;
            summaryHtml += `* CPU: ${getCompName('cpu', specs.cpu)}<br>`;
            summaryHtml += `* RAM: ${specs.ram_quantity || 1}x ${getCompName('ram', specs.ram_type)}<br>`;
            summaryHtml += `* Armazenamento: ${getCompName('storage', specs.storage1)}<br>`;
            summaryHtml += `* GPU: ${getCompName('gpu', specs.gpu)}<br>`;
            summaryHtml += `* Tela: ${getCompName('display', specs.display)}<br>`;
            summaryHtml += `* Teclado: ${getCompName('keyboard', specs.keyboard)}<br>`;
            summaryHtml += `* SO: ${getCompName('os', finalOsId)} (Selecionado)<br>`;
            summaryHtml += `* Rede: ${getCompName('network_adapter', specs.network_adapter)}<br>`;
            summaryHtml += `* Bateria: ${getCompName('battery', specs.battery)}<br>`;
            
            modalOrderSummaryEl.innerHTML = summaryHtml;
            modalTotalPriceEl.textContent = formatPrice(finalPrice);
            orderModal.style.display = 'flex';

            let sendToWhatsAppButton = orderModal.querySelector('#send-whatsapp-btn');
            if (sendToWhatsAppButton) sendToWhatsAppButton.remove(); 

            sendToWhatsAppButton = document.createElement('button');
            sendToWhatsAppButton.id = 'send-whatsapp-btn';
            sendToWhatsAppButton.className = 'mt-4 w-full btn btn-primary flex items-center justify-center';
            sendToWhatsAppButton.innerHTML = '<i class="fab fa-whatsapp mr-2"></i> Confirmar e Enviar para WhatsApp';
            
            const modalCloseButtonEl = document.getElementById('modal-close-button'); // Renamed to avoid conflict with var name.
            modalCloseButtonEl.parentNode.insertBefore(sendToWhatsAppButton, modalCloseButtonEl);

            sendToWhatsAppButton.onclick = () => {
                let message = `Ol√° DeiviTech! Gostaria de solicitar um or√ßamento para o Notebook Pronto:\n\n`;
                message += `*MODELO: ${notebook.name}*\n\n`;
                message += `*ESPECIFICA√á√ïES PRINCIPAIS (com SO selecionado):*\n`;
                message += summaryHtml.replace(/<br>/g, '\n').replace(/<strong>(.*?)<\/strong>/g, '*$1*');
                message += `\n*PRE√áO TOTAL: ${formatPrice(finalPrice)}*\n\n`;
                message += `Aguardo o contato!`;
                const whatsappUrl = `https://wa.me/5575981231019?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
                orderModal.style.display = 'none';
            };
        }
        
        function calculateTotalPerformance() {
            let totalScore = 0;
            // Removido network_adapter dos pesos e redistribu√≠do para motherboard
            const weights = { cpu: 0.25, gpu: 0.30, ram: 0.15, storage1: 0.12, motherboard: 0.05, display: 0.03, os: 0.02, casing:0.01, battery:0.01, npu_bonus: 0.06 };
            let hasNPU = false;
            let powerProfileScore = 0; 

            const addScore = (category, selectedId, quantity = 1) => {
                const item = getComponentById(category, selectedId);
                if (item && item.performance_score) {
                    if (weights[category]) totalScore += (item.performance_score * quantity) * weights[category];
                    if (item.npu) hasNPU = true;
                    if (['cpu', 'gpu', 'display', 'battery'].includes(category)) {
                         powerProfileScore += item.performance_score * (weights[category] || 0.01);
                    }
                }
            };
            
            addScore('cpu', selectedComponents.cpu);
            addScore('gpu', selectedComponents.gpu);
            addScore('ram', selectedComponents.ram.type, selectedComponents.ram.quantity);
            addScore('storage1', selectedComponents.storage1.type);
            addScore('motherboard', selectedComponents.motherboard);
            addScore('display', selectedComponents.display);
            addScore('os', selectedComponents.os);
            // Adaptador de rede removido pois est√° integrado na placa-m√£e
            addScore('casing', selectedComponents.casing);
            addScore('battery', selectedComponents.battery);

            if (hasNPU) {
                const cpuComp = getComponentById('cpu', selectedComponents.cpu);
                const npuCapableScore = cpuComp ? cpuComp.performance_score : 50; // Default if CPU not found
                totalScore += npuCapableScore * weights.npu_bonus;
            }
            
            const maxTheoreticalScore = 155; 
            let percentage = (totalScore / maxTheoreticalScore) * 100;
            percentage = Math.min(Math.max(Math.round(percentage), 0), 100); // Round before clamping

            const bar = document.getElementById('performance-bar');
            const barTextDisplay = document.getElementById('performance-text-display');
            bar.style.width = `${percentage}%`;
            
            let performanceTier = "Entrada";
            if (percentage >= 90) { bar.style.backgroundColor = 'var(--color-secondary)'; performanceTier = "Monstro!";} 
            else if (percentage >= 75) { bar.style.backgroundColor = '#20BF6B'; performanceTier = "Extremo!"; } /* Dark Green */
            else if (percentage >= 60) { bar.style.backgroundColor = 'var(--color-accent-yellow)'; performanceTier = "Alto Desempenho"; } 
            else if (percentage >= 40) { bar.style.backgroundColor = '#F7B731'; performanceTier = "Intermedi√°rio"; } /* Orange-Yellow */
            else if (percentage > 0) { bar.style.backgroundColor = 'var(--color-accent-red)'; performanceTier = "Entrada"; }
            else {bar.style.backgroundColor = 'transparent'; performanceTier = "Indefinido";}


            bar.textContent = `${percentage}%`;
            barTextDisplay.textContent = `N√≠vel: ${performanceTier}`;

            const energyDisplay = document.getElementById('energy-tendency-display');
            if (selectedComponents.cpu || selectedComponents.gpu || selectedComponents.battery){ // Only show if core components influencing power are selected
                if (powerProfileScore > 30) { energyDisplay.innerHTML = `Tend√™ncia de Energia: <span style="color:var(--color-accent-red);">Alta</span> <i class="fas fa-bolt"></i>`; }
                else if (powerProfileScore > 15) { energyDisplay.innerHTML = `Tend√™ncia de Energia: <span style="color:var(--color-accent-yellow);">Moderada</span> <i class="fas fa-leaf"></i>`; }
                else { energyDisplay.innerHTML = `Tend√™ncia de Energia: <span style="color:var(--color-secondary);">Baixa</span> <i class="fas fa-battery-quarter"></i>`; }
            } else {
                 energyDisplay.innerHTML = `Tend√™ncia de Energia: -`;
            }
            
            // Atualizar o painel integrado
            updateIntegratedDisplay();
            
            // Retornar o valor de percentage para uso em outras fun√ß√µes
            return percentage;
        }

        function applyQualityPreset(presetValue) {
            const preset = qualityPresets[presetValue];
            if (!preset) return;

            currentPresetName = preset.name;
            document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;

            if (preset.mode_target && preset.mode_target !== currentMode) {
                currentMode = preset.mode_target;
                document.getElementById('basic-mode-btn').classList.toggle('active', currentMode === 'basic');
                document.getElementById('advanced-mode-btn').classList.toggle('active', currentMode === 'advanced');
                toggleAdvancedModeTabs();
            }
            
            selectedPlatform = null; 
            Object.keys(selectedComponents).forEach(cat => {
                if (cat === 'ram') selectedComponents.ram = { type: null, quantity: 1 };
                else if (cat === 'storage1') selectedComponents.storage1 = { type: null };
                else if (cat === 'storage2') selectedComponents.storage2 = { type: 'none' };
                else if (cat === 'peripherals' || cat === 'software') selectedComponents[cat] = [];
                else selectedComponents[cat] = null;
            });

            if (preset.platform) {
                selectedPlatform = preset.platform; 
                selectedComponents.platform = preset.platform;
            }
            
            const setComponent = (category, id, quantity = null) => {
                const item = getComponentById(category, id);
                // For Presets, visibility considers the preset's target mode and platform.
                if (item && isComponentVisible(item, preset.mode_target || currentMode, preset.platform) && (item.stock === undefined || item.stock === 999 || item.stock > 0)) { //Undefined stock means available
                    if (category === 'ram' && quantity) {
                        const selectedMb = getComponentById('motherboard', preset.motherboard); 
                        if(selectedMb && item.type === selectedMb.ram_type && quantity <= selectedMb.ram_slots){
                           selectedComponents.ram.type = id;
                           selectedComponents.ram.quantity = quantity;
                        } else if (!selectedMb && quantity <= 4) { 
                            selectedComponents.ram.type = id;
                            selectedComponents.ram.quantity = quantity;
                        }
                    } else if (category === 'storage1') selectedComponents.storage1.type = id;
                    else if (category === 'storage2') selectedComponents.storage2.type = id;
                    else if (category === 'peripherals' && Array.isArray(id)) selectedComponents.peripherals = id.filter(pId => getComponentById('peripherals', pId));
                    else if (category === 'software' && Array.isArray(id)) { 
                        selectedComponents.software = id.filter(sId => getComponentById('software', sId));
                    }
                    else selectedComponents[category] = id;
                    return true;
                }
                return false;
            };
            
            setComponent('casing', preset.casing);
            setComponent('motherboard', preset.motherboard);
            setComponent('cpu', preset.cpu);
            setComponent('ram', preset.ram_type, preset.ram_quantity);
            setComponent('storage1', preset.storage1_type);
            setComponent('storage2', preset.storage2_type);
            setComponent('gpu', preset.gpu);
            setComponent('display', preset.display);
            setComponent('keyboard', preset.keyboard);
            
            if(setComponent('os', preset.os)){ // If OS is set
                if(preset.software) setComponent('software', preset.software); // Then attempt to set software
            }

            // Adaptador de rede removido pois est√° integrado na placa m√£e
            setComponent('battery', preset.battery);
            if(preset.peripherals) setComponent('peripherals', preset.peripherals);


            populateOptions(); 
            populateDetailedSoftwareOptions(); 
            updateVisualSelections(); 
            updateTotal();
        }
        
         function updateVisualSelections() {
            document.querySelectorAll('.option-item').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.checkbox-option-item input[type="checkbox"]').forEach(el => el.checked = false);
            // Specifically reset software checkboxes as they are in a different section
            document.querySelectorAll('#detailed-software-section input[type="checkbox"]').forEach(cb => cb.checked = false);


            if (selectedPlatform) {
                 const platformEl = document.querySelector(`#platform-options .option-item[data-id="${selectedPlatform}"]`);
                 if (platformEl) platformEl.classList.add('selected');
            }

            for (const category in selectedComponents) {
                let selectedIdOrArray = selectedComponents[category];
                if (category === 'ram') selectedIdOrArray = selectedComponents.ram.type;
                else if (category === 'storage1') selectedIdOrArray = selectedComponents.storage1.type;
                else if (category === 'storage2') selectedIdOrArray = selectedComponents.storage2.type;
                
                if (category === 'software') { 
                    selectedIdOrArray.forEach(id => {
                        const el = document.querySelector(`#detailed-software-section input[type="checkbox"][data-id="${id}"]`);
                        if (el) el.checked = true;
                    });
                } else if (category === 'peripherals' && Array.isArray(selectedIdOrArray)) { 
                    selectedIdOrArray.forEach(id => {
                        const el = document.querySelector(`#peripherals-options .checkbox-option-item input[type="checkbox"][data-id="${id}"]`);
                        if (el) el.checked = true;
                    });
                } else if (selectedIdOrArray && typeof selectedIdOrArray === 'string') { // Ensure it's not an object
                    const el = document.querySelector(`#${category}-options .option-item[data-id="${selectedIdOrArray}"]`);
                    if (el) {
                        el.classList.add('selected');
                        const radio = el.querySelector('input[type="radio"]');
                        if(radio) radio.checked = true;
                    }
                }
            }
            document.getElementById('ram-type-select').value = selectedComponents.ram.type || "";
            document.getElementById('ram-quantity-input').value = selectedComponents.ram.quantity;
            
            const noneStorage2El = document.querySelector(`#storage2-options .option-item[data-id="none"]`);
            if (selectedComponents.storage2.type === 'none') {
                if (noneStorage2El) {
                    noneStorage2El.classList.add('selected');
                    const radio = noneStorage2El.querySelector('input[type="radio"]');
                    if (radio) radio.checked = true;
                }
            } else {
                 if (noneStorage2El) {
                    noneStorage2El.classList.remove('selected');
                    const radio = noneStorage2El.querySelector('input[type="radio"]');
                    if (radio) radio.checked = false;
                 }
            }
            
            updateEthernetInfo();
            updateDualBootUI();
        }

        function updateEthernetInfo() {
            const mobo = getComponentById('motherboard', selectedComponents.motherboard);
            const ethernetInfoEl = document.getElementById('ethernet-info');
            if (mobo && mobo.ethernet_speed && mobo.ethernet_speed !== 'N/A') {
                ethernetInfoEl.innerHTML = `${mobo.ethernet_speed} (via placa m√£e) `;
                if (mobo.ethernet_speed.includes('10Gbps') || mobo.ethernet_speed.includes('5Gbps')) ethernetInfoEl.innerHTML += ' <i class="fas fa-rocket text-green-500" title="Ultra R√°pida!"></i>';
                else if (mobo.ethernet_speed.includes('2.5Gbps')) ethernetInfoEl.innerHTML += ' <i class="fas fa-tachometer-alt text-blue-500" title="R√°pida"></i>';
                else ethernetInfoEl.innerHTML += ' <i class="fas fa-network-wired text-gray-500 body.dark-mode:text-gray-400" title="Padr√£o"></i>';
            } else {
                ethernetInfoEl.textContent = "Verifique a placa m√£e ou Indispon√≠vel";
            }
        }

        function updateTotal() {
            let componentsTotalPrice = 0;
            for (const category in selectedComponents) {
                if (category === 'platform') continue; // Platform itself has no price contribution here
                if (category === 'ram') {
                    if (selectedComponents.ram.type) {
                        const ramItem = getComponentById('ram', selectedComponents.ram.type);
                        if (ramItem) componentsTotalPrice += ramItem.price * selectedComponents.ram.quantity;
                    }
                } else if (category === 'storage1') componentsTotalPrice += getComponentPrice('storage', selectedComponents.storage1.type);
                else if (category === 'storage2' && selectedComponents.storage2.type !== 'none') componentsTotalPrice += getComponentPrice('storage', selectedComponents.storage2.type);
                else if (category === 'peripherals') selectedComponents.peripherals.forEach(id => componentsTotalPrice += getComponentPrice('peripherals', id));
                else if (category === 'software') {
                    selectedComponents.software.forEach(id => componentsTotalPrice += getComponentPrice('software', id));
                }
                else if (selectedComponents[category] && category !== 'os2' && category !== 'dualboot_disk') {
                    componentsTotalPrice += getComponentPrice(category, selectedComponents[category]);
                }
            }
            if (selectedComponents.os2 && document.getElementById('dualboot-checkbox').checked) {
                componentsTotalPrice += getComponentPrice('os', selectedComponents.os2);
            }
            
            // Atualizar o painel integrado
            updateIntegratedDisplay();

            let finalNotebookPrice = componentsTotalPrice - tradeInCredit;
            document.getElementById('total-price-display').textContent = formatPrice(Math.max(0, finalNotebookPrice));
            
            let servicesTotalPrice = 0;
            selectedServices.forEach(serviceId => {
                servicesTotalPrice += getServicePrice(serviceId);
            });
            document.getElementById('total-services-price-display').textContent = formatPrice(servicesTotalPrice);            updateSummary();
            calculateTotalPerformance();
            
            // Atualizar informa√ß√µes avan√ßadas se o modo avan√ßado estiver ativo
            if (currentMode === 'advanced') {
                updateAdvancedInfo();
            }
        }

        function updateSummary() {
            const summaryDetails = document.getElementById('summary-details');
            summaryDetails.innerHTML = '';
            const getCompName = (cat, id) => getComponentById(cat, id)?.name || 'N/A';
            const getCompIcon = (cat, id) => getComponentById(cat, id)?.icon || 'fas fa-question-circle';

            const addItem = (label, value, iconClass) => {
                if (value && value !== 'N/A') {
                     const iconHtml = iconClass ? `<i class="${iconClass}"></i>` : `<i class="fas fa-ellipsis-h"></i>`;
                     summaryDetails.innerHTML += `<div class="summary-item">${iconHtml}<span class="summary-item-name"><strong>${label}:</strong> ${value}</span></div>`;
                }
            };
            
            if(selectedComponents.platform) addItem('Plataforma', getCompName('platform', selectedComponents.platform), getCompIcon('platform',selectedComponents.platform));
            if(selectedComponents.casing) addItem('Carca√ßa', getCompName('casing', selectedComponents.casing), getCompIcon('casing',selectedComponents.casing));
            if(selectedComponents.motherboard) addItem('Placa M√£e', getCompName('motherboard', selectedComponents.motherboard), getCompIcon('motherboard',selectedComponents.motherboard));
            if(selectedComponents.cpu) addItem('CPU', getCompName('cpu', selectedComponents.cpu), getCompIcon('cpu',selectedComponents.cpu));
            if (selectedComponents.ram.type) { const ram = getComponentById('ram', selectedComponents.ram.type); if(ram) addItem('RAM', `${selectedComponents.ram.quantity}x ${ram.name}`, ram.icon); }
            if (selectedComponents.storage1.type) addItem('Armazenamento 1', getCompName('storage', selectedComponents.storage1.type), getCompIcon('storage',selectedComponents.storage1.type) || 'fas fa-hdd');
            if (selectedComponents.storage2.type && selectedComponents.storage2.type !== 'none') addItem('Armazenamento 2', getCompName('storage', selectedComponents.storage2.type), getCompIcon('storage',selectedComponents.storage2.type) || 'fas fa-compact-disc');
            else if (selectedComponents.storage2.type === 'none' && selectedComponents.platform) addItem('Armazenamento 2', 'Nenhum', 'fas fa-ban');
            
            if(selectedComponents.gpu) addItem('GPU', getCompName('gpu', selectedComponents.gpu), getCompIcon('gpu',selectedComponents.gpu));
            if(selectedComponents.display) addItem('Tela', getCompName('display', selectedComponents.display), getCompIcon('display',selectedComponents.display));
            if(selectedComponents.keyboard) addItem('Teclado', getCompName('keyboard', selectedComponents.keyboard), getCompIcon('keyboard',selectedComponents.keyboard));
            if(selectedComponents.os) addItem('Sistema Op.', getCompName('os', selectedComponents.os), getCompIcon('os',selectedComponents.os));
            if (document.getElementById('dualboot-checkbox').checked && selectedComponents.os2) {
                addItem('Dual Boot com', getCompName('os', selectedComponents.os2) + (selectedComponents.dualboot_disk === 'additional' ? ' (disco adicional)' : ' (mesmo disco)'), getCompIcon('os', selectedComponents.os2));
            }
            if (selectedComponents.software.length > 0) { 
                addItem('Software Adicional', selectedComponents.software.map(id => getComponentById('software', id)?.name).filter(name => name).join(', ') || 'Nenhum', 'fas fa-cogs');
            }
            // Adaptador de rede removido pois est√° integrado na placa m√£e
            addItem('Conectividade', 'Wi-Fi/Bluetooth integrado na placa m√£e', 'fas fa-wifi');
            if(selectedComponents.battery) addItem('Bateria', getCompName('battery', selectedComponents.battery), getCompIcon('battery',selectedComponents.battery));
            
            if (selectedComponents.peripherals.length > 0) {
                addItem('Perif√©ricos', selectedComponents.peripherals.map(id => getCompName('peripherals', id)).join(', '), 'fas fa-plus-circle');
            } else if (selectedComponents.platform) { // Only show 'peripherals: none' if a configuration is started
                addItem('Perif√©ricos', 'Nenhum', 'fas fa-ban'); 
            }

            if (tradeInCredit > 0) summaryDetails.innerHTML += `<div class="summary-item"><i class="fas fa-tags text-[var(--color-accent-red)]"></i><span class="summary-item-name text-[var(--color-accent-red)]"><strong>Cr√©dito de Troca:</strong> ${formatPrice(tradeInCredit)}</span></div>`;
        }
        
        function createOptionElement(item, category) { 
            const container = document.createElement('div');
            container.className = 'option-item';
            container.dataset.id = item.id;
            container.dataset.price = item.price;
            container.dataset.category = category;

            const iconHtml = item.icon ? `<i class="${item.icon} section-icon mr-2 text-lg"></i>` : ''; // Removed inline style color
            const descriptionText = getComponentDescription(item, currentMode);
            const stockText = item.stock !== undefined && item.stock !== 999 ? ` (Estoque: ${item.stock})` : (item.stock === 999 ? ' (Dispon√≠vel)' : '');
            const isOutOfStock = item.stock !== undefined && item.stock <= 0;

            if (isOutOfStock) container.classList.add('disabled');

            let detailsHtml = '';
            if (category === 'os' && item.id !== 'os-none') {
                detailsHtml = `<p class="text-xs text-details mt-1">Armaz.: ${item.storage_impact || 'N/A'} | RAM M√≠n.: ${item.ram_min || 'N/A'}</p>`;
            } else if (category === 'cpu' && item.npu) {
                detailsHtml = `<p class="text-xs text-details mt-1 text-blue-600 dark:text-blue-400 font-semibold"><i class="fas fa-brain-circuit mr-1"></i> Inclui NPU para IA / Copilot+</p>`;
            }


            container.innerHTML = `
                <div class="option-content w-full">
                    <p class="font-semibold text-name">${iconHtml}${item.name} <span class="text-xs text-gray-500 dark:text-gray-400 font-normal">${stockText}</span></p>
                    <p class="text-sm text-description">${descriptionText}</p>
                    ${detailsHtml}
                    <p class="text-sm price-text mt-auto">${formatPrice(item.price)}</p>
                </div>
            `;
            const input = document.createElement('input'); input.type = 'radio'; input.id = `${category}-${item.id}`; input.name = category; input.value = item.id; input.className = 'hidden';
            container.appendChild(input);

            container.addEventListener('click', () => {
                if (container.classList.contains('disabled')) return;
                currentPresetName = "Personalizado";
                document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;

                const prevSelectedPlatform = selectedPlatform;
                const prevSelectedMotherboard = selectedComponents.motherboard;
                const prevSelectedOS = selectedComponents.os;


                if (category === 'platform') {
                    selectedPlatform = item.id;
                    selectedComponents.platform = item.id;
                    if (prevSelectedPlatform && prevSelectedPlatform !== selectedPlatform) {
                        ['motherboard', 'cpu', 'ram', 'storage1', 'storage2', 'gpu', 'network_adapter'].forEach(depCat => { // Broader reset when platform changes
                            if (depCat === 'ram') selectedComponents.ram = {type: null, quantity: 1};
                            else if (depCat === 'storage1') selectedComponents.storage1 = {type: null};
                            else if (depCat === 'storage2') selectedComponents.storage2 = {type: 'none'};
                            else selectedComponents[depCat] = null;
                        });
                    }
                } else if (category === 'storage1') selectedComponents.storage1.type = item.id;
                else if (category === 'storage2') selectedComponents.storage2.type = item.id;
                else selectedComponents[category] = item.id;
                
                if (category === 'os') {
                    if (prevSelectedOS !== item.id) { 
                        selectedComponents.os2 = null; 
                        document.getElementById('dualboot-checkbox').checked = false;
                        selectedComponents.software = []; 
                    }
                    populateDetailedSoftwareOptions(); 
                }


                if (category === 'motherboard' && selectedComponents.motherboard !== prevSelectedMotherboard) {
                    const newMobo = getComponentById('motherboard', selectedComponents.motherboard);
                    if (newMobo) {
                        const currentCpu = getComponentById('cpu', selectedComponents.cpu);
                        if (currentCpu && currentCpu.socket !== newMobo.cpu_socket) selectedComponents.cpu = null;
                        
                        const currentRamType = selectedComponents.ram.type;
                        const currentRamComp = getComponentById('ram', currentRamType);
                        if (currentRamComp && currentRamComp.type !== newMobo.ram_type) {
                            selectedComponents.ram.type = null; 
                        }

                        document.getElementById('ram-max-modules').textContent = newMobo.ram_slots;
                        document.getElementById('ram-quantity-input').max = newMobo.ram_slots;
                        if(selectedComponents.ram.quantity > newMobo.ram_slots) selectedComponents.ram.quantity = newMobo.ram_slots;

                        // Reset storage if motherboard changed, as slot availability might differ
                        selectedComponents.storage1.type = null;
                        selectedComponents.storage2.type = 'none';

                        populateDetailedSoftwareOptions(); // OS compatibility with mobo (e.g. TPM for Win11) might be a factor later
                        
                    } else { 
                        selectedComponents.cpu = null; selectedComponents.ram.type = null;
                        selectedComponents.storage1.type = null; selectedComponents.storage2.type = 'none';
                    }
                }
                if (category === 'cpu') { // If CPU selection forces motherboard change (highly unlikely with current UI flow, but good practice)
                    const newCpu = getComponentById('cpu', selectedComponents.cpu);
                    const currentMobo = getComponentById('motherboard', selectedComponents.motherboard);
                    if (newCpu && currentMobo && newCpu.socket !== currentMobo.cpu_socket) {
                        // This case implies an error in filtering logic upstream if a CPU incompatible with selected mobo was shown/clicked
                        selectedComponents.motherboard = null; 
                        selectedComponents.ram.type = null; 
                        // reset other motherboard-dependent items
                    }
                }
                
                populateOptions(); 
                updateVisualSelections();
                updateTotal();
            });
            return container;
        }
        
        function createCheckboxOptionElement(item, category, isSoftware = false) { 
            const div = document.createElement('div');
            div.className = 'checkbox-option-item';
            // Software (isSoftware=true) is usually not stock-limited, peripherals (isSoftware=false) are.
            if (item.stock !== undefined && item.stock <= 0 && !isSoftware) div.classList.add('disabled');

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `${category}-${item.id}`; // Category here is 'peripherals' or 'software' (not software sub-category)
            checkbox.dataset.id = item.id; 
            checkbox.dataset.price = item.price;
            checkbox.disabled = (item.stock !== undefined && item.stock <= 0 && !isSoftware);

            const label = document.createElement('label');
            label.htmlFor = checkbox.id;
            const iconHtml = item.icon ? `<i class="${item.icon} mr-2"></i>` : ''; // Removed inline style
            label.innerHTML = `${iconHtml}${item.name} <span class="text-xs text-gray-500 dark:text-gray-400">(${formatPrice(item.price)})</span>`;
            
            if (item.description) {
                const descP = document.createElement('p');
                descP.className = 'text-xs text-gray-600 dark:text-gray-400 ml-8 -mt-1'; // Adjusted margin for icon presence
                 descP.style.marginLeft = item.icon ? 'calc(1.25em + 0.75em + 0.5rem)' : '0.75em'; // Dynamic margin on presence of icon
                descP.textContent = item.description;
                label.appendChild(descP);
            }


            div.appendChild(checkbox);
            div.appendChild(label);

            checkbox.addEventListener('change', (e) => {
                currentPresetName = "Personalizado";
                document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;
                if (e.target.checked) {
                    if (!selectedComponents[category].includes(item.id)) {
                        selectedComponents[category].push(item.id);
                    }
                } else {
                    selectedComponents[category] = selectedComponents[category].filter(id => id !== item.id);
                }
                updateTotal();
            });
            return div;
        }
        
        function getFilteredOptions(category, currentPlatform, softwareCategoryName = null) { 
            let sourceArray;
            if (category === 'software' && softwareCategoryName) {
                sourceArray = softwareCategories[softwareCategoryName] ? [...softwareCategories[softwareCategoryName]] : [];
            } else {
                sourceArray = components[category] ? [...components[category]] : [];
            }
            
            let filtered = sourceArray.filter(item => isComponentVisible(item, currentMode, currentPlatform));
            
            const selectedMb = getComponentById('motherboard', selectedComponents.motherboard);

            if (category === 'motherboard' && selectedPlatform) { 
                 filtered = filtered.filter(item => item.platform === selectedPlatform);
            } else if (category === 'cpu' && selectedMb) {
                filtered = filtered.filter(item => item.socket === selectedMb.cpu_socket);
            } else if (category === 'ram' && selectedMb) { 
                filtered = filtered.filter(item => item.type === selectedMb.ram_type);
            } else if (category === 'storage') {
                if (selectedMb) {
                    let currentNvmeCount = 0; let currentSataCount = 0;
                    const s1 = getComponentById('storage',selectedComponents.storage1.type);
                    const s2 = getComponentById('storage',selectedComponents.storage2.type);

                    if (s1?.interface === 'NVMe') currentNvmeCount++; 
                    if (s1?.interface === 'SATA') currentSataCount++;
                    if (s2?.interface === 'NVMe') currentNvmeCount++; 
                    if (s2?.interface === 'SATA') currentSataCount++;
                    
                    filtered = filtered.filter(item => {
                        if (item.id === selectedComponents.storage1.type || item.id === selectedComponents.storage2.type) return true;
                        if (selectedMb.nvme_slots === undefined || selectedMb.sata_ports === undefined) return true;
                        if (item.interface === 'NVMe' && currentNvmeCount >= selectedMb.nvme_slots) return false;
                        if (item.interface === 'SATA' && currentSataCount >= selectedMb.sata_ports) return false;
                        if (item.interface === 'NVMe' && item.pcie_gen && selectedMb.pcie_gen) {
                            const itemGenNum = parseInt(item.pcie_gen.replace('Gen',''));
                            const moboGenNum = parseInt(selectedMb.pcie_gen.replace('Gen',''));
                            if (itemGenNum > moboGenNum) return false; 
                        }
                        return true;
                    });
                }
            } else if (category === 'gpu') {
                // CORRECTION: Removed broken/ineffective filter logic for GPU.
                // GPU backward/forward compatibility is generally good, so complex filtering
                // isn't as critical as for CPU sockets or RAM types and is better left open.
            } else if (category === 'software') { // This part is generic to ALL software, should be applied AFTER category selection.
                const mainOS = getComponentById('os', selectedComponents.os);
                if(mainOS && mainOS.id !== 'os-none') {
                    filtered = filtered.filter(sw => sw.os_req && sw.os_req.includes(mainOS.id));
                } else {
                    filtered = []; 
                }
            }
            return filtered;
        }

        function populateOptions() {
            const platformContainer = document.getElementById('platform-options');
            platformContainer.innerHTML = '';
            components.platform.forEach(item => platformContainer.appendChild(createOptionElement(item, 'platform')));
            
            const categoriesToPopulate = ['casing', 'motherboard', 'cpu', 'gpu', 'display', 'keyboard', 'os', 'battery']; // Adaptador de rede removido pois est√° integrado na placa m√£e
            categoriesToPopulate.forEach(category => {
                const container = document.getElementById(`${category}-options`);
                const helperTextEl = document.getElementById(`${category}-helper-text`);
                if (!container) return;
                container.innerHTML = ''; 
                let options;
                if ((category === 'motherboard' && !selectedPlatform) || (category === 'cpu' && !selectedComponents.motherboard)) {
                    if(helperTextEl) helperTextEl.style.display = 'block'; options = [];
                } else {
                   if(helperTextEl) helperTextEl.style.display = 'none';
                   options = getFilteredOptions(category, selectedPlatform);
                }
                 if(options.length === 0 && helperTextEl && category !== 'motherboard' && category !== 'cpu') { // If no options and not the platform/cpu initial state
                    if(container) container.innerHTML = `<p class="text-sm text-gray-500 dark:text-gray-400">Nenhuma op√ß√£o compat√≠vel dispon√≠vel no momento. Verifique as sele√ß√µes anteriores ou o modo (B√°sico/Avan√ßado).</p>`;
                 } else {
                    options.forEach(item => container.appendChild(createOptionElement(item, category)));
                 }
            });

            const ramTypeSelect = document.getElementById('ram-type-select');
            const ramHelperEl = document.getElementById('ram-type-helper-text');
            const currentRamTypeVal = selectedComponents.ram.type; // Save current value before clearing
            ramTypeSelect.innerHTML = '<option value="">Selecione o M√≥dulo...</option>';
            const selectedMbForRam = getComponentById('motherboard', selectedComponents.motherboard);

            if (selectedMbForRam) {
                ramHelperEl.style.display = 'none'; ramTypeSelect.disabled = false;
                const ramOptions = getFilteredOptions('ram', selectedPlatform); 
                ramOptions.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.id;
                    const stockInfo = item.stock <=0 ? '(Esgotado!)' : `(Est: ${item.stock})`
                    option.textContent = `${item.name} - ${formatPrice(item.price)} ${stockInfo}`;
                    if (item.stock <= 0) option.disabled = true;
                    ramTypeSelect.appendChild(option);
                });
                // Restore selection if option still exists and is not disabled
                const existingOption = ramTypeSelect.querySelector(`option[value="${currentRamTypeVal}"]`);
                if (existingOption && !existingOption.disabled) {
                    ramTypeSelect.value = currentRamTypeVal;
                } else { // If not, reset selection in state
                    selectedComponents.ram.type = null;
                    ramTypeSelect.value = ""; 
                }
            } else {
                 ramHelperEl.style.display = 'block'; ramTypeSelect.disabled = true; selectedComponents.ram.type = null;
                 ramTypeSelect.value = "";
            }
            const ramQuantityInput = document.getElementById('ram-quantity-input');
            document.getElementById('ram-max-modules').textContent = selectedMbForRam ? selectedMbForRam.ram_slots : 'X';
            ramQuantityInput.max = selectedMbForRam ? selectedMbForRam.ram_slots : 4;
            if (parseInt(ramQuantityInput.value) > parseInt(ramQuantityInput.max)) {
                ramQuantityInput.value = ramQuantityInput.max;
                selectedComponents.ram.quantity = parseInt(ramQuantityInput.max);
            }


            ['storage1', 'storage2'].forEach(storageCat => {
                const sContainer = document.getElementById(`${storageCat}-options`);
                const currentVal = selectedComponents[storageCat]?.type;
                sContainer.innerHTML = '';
                if (storageCat === 'storage2') { 
                     const noneOptData = { id: 'none', name: 'Nenhum', price: 0, description_basic: 'N√£o adicionar armazenamento secund√°rio.', description_advanced: 'N√£o adicionar armazenamento secund√°rio. Deixar este slot vazio ou n√£o utilizar uma segunda baia SATA/NVMe.', stock: 999, icon: 'fas fa-ban', interface: 'N/A' }; 
                    const noneOpt = createOptionElement(noneOptData, 'storage2');
                    sContainer.appendChild(noneOpt);
                }
                const sOptions = getFilteredOptions('storage', selectedPlatform); 
                sOptions.forEach(item => { if(item.id !== 'none') sContainer.appendChild(createOptionElement(item, storageCat)); });
                
                const currentOptionElement = sContainer.querySelector(`.option-item[data-id="${currentVal}"]`);
                if (currentOptionElement && !currentOptionElement.classList.contains('disabled')) {
                    // It's valid, selection will be handled by updateVisualSelections
                } else if (storageCat === 'storage2') { // Default to none if current selection is invalid or unavailable
                    selectedComponents.storage2.type = 'none';
                } else { // For storage1, if invalid, it should be null
                     selectedComponents.storage1.type = null; 
                }
            });
            
            const periContainer = document.getElementById('peripherals-options');
            periContainer.innerHTML = '';
            getFilteredOptions('peripherals', selectedPlatform).forEach(item => {
                if (item.id !== 'peri-none') { 
                    const optEl = createCheckboxOptionElement(item, 'peripherals');
                    periContainer.appendChild(optEl);
                }
            });
            
            updateDualBootUI(); 
            // populateDetailedSoftwareOptions is called when OS changes or on initial load
            updateVisualSelections(); // Crucial: Call this after all options are populated to reflect selections
            updateTotal(); 
        }
        
        function populateDetailedSoftwareOptions() {
            const mainSoftwareSection = document.getElementById('detailed-software-section');
            const helperText = document.getElementById('detailed-software-helper-text');
            const selectedOSItem = getComponentById('os', selectedComponents.os);

            if (!selectedOSItem || selectedOSItem.id === 'os-none') {
                mainSoftwareSection.style.display = 'none'; // Hide the entire section
                helperText.textContent = 'Selecione um Sistema Operacional para ver op√ß√µes de software.';
                helperText.style.display = 'block';
                 if(selectedComponents.software.length > 0) { // If OS was unselected, clear software
                    selectedComponents.software = [];
                    updateTotal(); // And update total price
                }
                return;
            }
            
            mainSoftwareSection.style.display = 'block';
            helperText.style.display = 'none';
            let anySoftwareAvailable = false;

            Object.keys(softwareCategories).forEach(catName => {
                const containerId = `software-${catName}-tab`;
                const container = document.getElementById(containerId);
                if (!container) { console.warn(`Software tab container not found: ${containerId}`); return;}
                container.innerHTML = ''; // Clear previous items

                const softwareItemsForCategory = getFilteredOptions('software', selectedPlatform, catName); // Gets OS-filtered items for THIS category

                if (softwareItemsForCategory.length > 0) {
                    anySoftwareAvailable = true;
                    softwareItemsForCategory.forEach(item => {
                        const optEl = createCheckboxOptionElement(item, 'software', true); 
                         // Check global selectedComponents.software
                        if (selectedComponents.software.includes(item.id)) {
                            optEl.querySelector('input[type="checkbox"]').checked = true;
                        }
                        container.appendChild(optEl);
                    });
                } else {
                    container.innerHTML = `<p class="text-sm text-gray-500 dark:text-gray-400 p-2 col-span-full">Nenhum software nesta categoria compat√≠vel com o SO ${selectedOSItem.name} ou dispon√≠vel no modo atual.</p>`;
                }
            });

            // If no software is available at all for the selected OS, hide the section
            if(!anySoftwareAvailable && mainSoftwareSection.style.display === 'block'){
                 helperText.textContent = `Nenhum software adicional compat√≠vel com ${selectedOSItem.name} dispon√≠vel no momento.`;
                 helperText.style.display = 'block';
                 // Keep mainSoftwareSection display as block, but individual tabs will show messages
            }
             // Ensure the current software tab is active or default to multimedia
            switchSoftwareTab(currentSoftwareTab); 
            updateTotal(); // To reflect any changes due to software (e.g. if previous selections were deselected due to OS change)
        }


        function switchSoftwareTab(tabName) {
            currentSoftwareTab = tabName;
            document.querySelectorAll('.software-tab-button').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });
            document.querySelectorAll('.software-tab-content').forEach(content => {
                content.classList.toggle('active', content.id === `software-${tabName}-tab`);
            });
        }

        function updateDualBootUI() {
            const dualBootSection = document.getElementById('dualboot-section');
            const dualBootCheckbox = document.getElementById('dualboot-checkbox');
            const os2SelectionDiv = document.getElementById('dualboot-os2-selection');
            const os2Select = document.getElementById('os2-select');
            const dualBootDiskSelect = document.getElementById('dualboot-disk-select');
            const additionalDiskOption = document.getElementById('dualboot-additional-disk-option');

            const mainOsSelected = selectedComponents.os && selectedComponents.os !== 'os-none';
            dualBootSection.style.display = mainOsSelected ? 'block' : 'none';

            if (!mainOsSelected) {
                dualBootCheckbox.checked = false; 
                selectedComponents.os2 = null;
            }
            
            os2SelectionDiv.style.display = dualBootCheckbox.checked ? 'block' : 'none';

            if (dualBootCheckbox.checked) {
                const currentOs2Val = selectedComponents.os2;
                os2Select.innerHTML = '<option value="">Selecione o segundo SO...</option>';
                components.os.forEach(os => {
                    if (os.id !== selectedComponents.os && os.id !== 'os-none') { 
                        const option = document.createElement('option');
                        option.value = os.id;
                        option.textContent = `${os.name} (${formatPrice(os.price)}) (Est: ${os.stock})`;
                        if (os.stock <= 0) option.disabled = true;
                        os2Select.appendChild(option);
                    }
                });
                if (currentOs2Val && os2Select.querySelector(`option[value="${currentOs2Val}"]`)) {
                    os2Select.value = currentOs2Val;
                } else {
                    selectedComponents.os2 = null; 
                     os2Select.value = ''; // Ensure placeholder selected if old value is gone
                }

                if (selectedComponents.storage2 && selectedComponents.storage2.type !== 'none' && getComponentById('storage', selectedComponents.storage2.type).stock > 0) {
                    additionalDiskOption.disabled = false;
                } else {
                    additionalDiskOption.disabled = true;
                    if (selectedComponents.dualboot_disk === 'additional') {
                        selectedComponents.dualboot_disk = 'same'; 
                        dualBootDiskSelect.value = 'same';
                    }
                }
            } else {
                selectedComponents.os2 = null; 
                selectedComponents.dualboot_disk = 'same';
            }
        }
        
        function populateServices() {
            const container = document.getElementById('services-options-container');
            container.innerHTML = '';
            services.forEach(service => {
                const serviceEl = document.createElement('div');
                serviceEl.className = 'service-item card p-4'; 
                serviceEl.innerHTML = `
                    <div class="flex items-center mb-2">
                        <input type="checkbox" id="service-${service.id}" data-service-id="${service.id}" class="mr-3 custom-service-checkbox" style="width: 1.25em; height: 1.25em; flex-shrink:0;">
                        <label for="service-${service.id}" class="flex-grow cursor-pointer">
                            <h4 class="text-lg"><i class="${service.icon || 'fas fa-cog'} section-icon mr-2"></i>${service.name}</h4>
                        </label>
                        <span class="price text-lg ml-auto">${service.id === 'serv-iptv-test' ? 'Gr√°tis (Teste)' : formatPrice(service.basePrice)}</span>
                    </div>
                    <p class="text-sm text-gray-600 body.dark-mode:text-gray-400" style="margin-left: calc(1.25em + 0.75rem + 0.5rem);">${service.description}</p>
                    ${service.details ? `
                    <details class="mt-2" style="margin-left: calc(1.25em + 0.75rem + 0.5rem);">
                        <summary class="details-toggle hover:underline text-xs">Mais Detalhes/Tutorial <i class="fas fa-chevron-down text-xs ml-1"></i></summary>
                        <div class="details-content tutorial-details">
                            ${service.details.replace(/\n/g, '<br>')}
                        </div>
                    </details>
                    ` : ''}
                `;
                container.appendChild(serviceEl);
                observer.observe(serviceEl);


                serviceEl.querySelector('input[type="checkbox"]').addEventListener('change', (e) => {
                    const serviceId = e.target.dataset.serviceId;
                    if (e.target.checked) {
                        if (!selectedServices.includes(serviceId)) selectedServices.push(serviceId);
                    } else {
                        selectedServices = selectedServices.filter(id => id !== serviceId);
                    }
                    updateTotal(); 
                });
            });
            updateTotal(); // Initial update of services total
        }        function toggleAdvancedModeTabs() {
            const aiTab = document.getElementById('tab-ai-integration');
            const budgetTab = document.getElementById('tab-specific-budget');
            const advancedInfoSection = document.getElementById('advanced-info-section');
            
            if (currentMode === 'advanced') {
                aiTab.style.display = 'inline-block'; 
                budgetTab.style.display = 'inline-block';
                advancedInfoSection.classList.remove('hidden');
                updateAdvancedInfo();
            } else {
                aiTab.style.display = 'none';
                budgetTab.style.display = 'none';
                advancedInfoSection.classList.add('hidden');
                if (activeTab === 'specific-budget') { // If advanced tab was active, switch to configure
                    showTab('configure'); 
                }
            }
        }
        
        function updateAdvancedInfo() {
            // Calcular TDP total
            let totalTDP = 0;
            let idlePower = 5; // Base do sistema
            let maxPower = 10; // Base do sistema
            
            const cpuComponent = getComponentById('cpu', selectedComponents.cpu);
            const gpuComponent = getComponentById('gpu', selectedComponents.gpu);
            const ramComponent = getComponentById('ram', selectedComponents.ram);
            const storageComponent = getComponentById('storage', selectedComponents.storage1);
            const displayComponent = getComponentById('display', selectedComponents.display);
            const batteryComponent = getComponentById('battery', selectedComponents.battery);
            
            // Calcular consumo dos componentes
            if (cpuComponent) {
                const cpuTDP = cpuComponent.name.includes('i3') ? 15 : 
                              cpuComponent.name.includes('i5') ? 28 : 
                              cpuComponent.name.includes('i7') ? 45 : 
                              cpuComponent.name.includes('i9') ? 55 : 
                              cpuComponent.name.includes('Ryzen 3') ? 15 : 
                              cpuComponent.name.includes('Ryzen 5') ? 35 : 
                              cpuComponent.name.includes('Ryzen 7') ? 45 : 55;
                totalTDP += cpuTDP;
                idlePower += cpuTDP * 0.1;
                maxPower += cpuTDP;
            }
            
            if (gpuComponent && gpuComponent.id !== 'integrated') {
                const gpuTDP = gpuComponent.name.includes('1650') ? 35 : 
                              gpuComponent.name.includes('3050') ? 45 : 
                              gpuComponent.name.includes('4060') ? 50 : 
                              gpuComponent.name.includes('4070') ? 65 : 
                              gpuComponent.name.includes('4080') ? 80 : 
                              gpuComponent.name.includes('6600') ? 35 : 
                              gpuComponent.name.includes('7600') ? 45 : 
                              gpuComponent.name.includes('7700') ? 55 : 35;
                totalTDP += gpuTDP;
                idlePower += gpuTDP * 0.05;
                maxPower += gpuTDP;
            }
            
            if (ramComponent) {
                const ramPower = ramComponent.name.includes('DDR5') ? 5 : 3;
                idlePower += ramPower;
                maxPower += ramPower;
            }
            
            if (storageComponent) {
                const storagePower = storageComponent.name.includes('NVMe') ? 8 : 5;
                idlePower += storagePower;
                maxPower += storagePower;
            }
            
            if (displayComponent) {
                const displayPower = displayComponent.name.includes('OLED') ? 15 : 
                                   displayComponent.name.includes('4K') ? 12 : 
                                   displayComponent.name.includes('QHD') ? 10 : 8;
                idlePower += displayPower;
                maxPower += displayPower;
            }
            
            // Atualizar UI
            document.getElementById('total-tdp').textContent = `${totalTDP}W`;
            document.getElementById('idle-power').textContent = `${idlePower}W`;
            document.getElementById('max-power').textContent = `${maxPower}W`;
            
            // Calcular autonomia estimada
            const batteryCapacity = batteryComponent ? 
                parseInt(batteryComponent.name.match(/(\d+)Wh/)?.[1] || '45') : 45;
            const estimatedBattery = Math.round(batteryCapacity / idlePower * 10) / 10;
            document.getElementById('battery-estimate').textContent = `${estimatedBattery}h`;
            
            // Atualizar barra t√©rmica
            const thermalLoad = Math.min(totalTDP / 150 * 100, 100);
            const thermalBar = document.getElementById('thermal-bar');
            thermalBar.style.width = `${thermalLoad}%`;
            thermalBar.className = `h-2 rounded-full ${thermalLoad < 30 ? 'bg-green-500' : 
                                                      thermalLoad < 60 ? 'bg-yellow-500' : 'bg-red-500'}`;
            
            document.getElementById('heat-dissipation').textContent = 
                thermalLoad < 30 ? 'Baixa' : thermalLoad < 60 ? 'Moderada' : 'Alta';
            
            // Calcular scores de benchmark estimados
            const performanceScore = calculateTotalPerformance();
            const cinebenchScore = Math.round(performanceScore * 50);
            const timespyScore = Math.round(performanceScore * 30);
            const pcmarkScore = Math.round(performanceScore * 40);
            
            document.getElementById('cinebench-score').textContent = `${cinebenchScore} pts`;
            document.getElementById('timespy-score').textContent = `${timespyScore} pts`;
            document.getElementById('pcmark-score').textContent = `${pcmarkScore} pts`;
            
            // Gerar recomenda√ß√µes inteligentes
            generateSmartRecommendations();
            
            // Atualizar gr√°fico radar de performance
            updatePerformanceRadarChart();
        }
        
        function generateSmartRecommendations() {
            const recommendations = [];
            const cpuComponent = getComponentById('cpu', selectedComponents.cpu);
            const gpuComponent = getComponentById('gpu', selectedComponents.gpu);
            const ramComponent = getComponentById('ram', selectedComponents.ram);
            const storageComponent = getComponentById('storage', selectedComponents.storage1);
            
            // An√°lise de gargalos
            if (cpuComponent && gpuComponent && cpuComponent.performance_score < gpuComponent.performance_score * 0.7) {
                recommendations.push('CPU pode ser um gargalo para a GPU selecionada. Considere um processador mais potente.');
            }
            
            if (ramComponent && ramComponent.name.includes('8GB') && (cpuComponent?.name.includes('i7') || cpuComponent?.name.includes('Ryzen 7'))) {
                recommendations.push('Para CPUs high-end, recomendamos 16GB ou mais de RAM para melhor performance.');
            }
            
            if (storageComponent && storageComponent.name.includes('SATA') && cpuComponent?.name.includes('i7')) {
                recommendations.push('SSD NVMe ofereceria significativo ganho de performance para esta configura√ß√£o.');
            }
            
            if (gpuComponent && gpuComponent.id === 'integrated' && selectedComponents.display && 
                selectedComponents.display.includes('144Hz')) {
                recommendations.push('GPU integrada pode n√£o aproveitar totalmente telas de alta taxa de atualiza√ß√£o.');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('Configura√ß√£o bem balanceada! Todos os componentes trabalham em harmonia.');
            }
            
            const listElement = document.getElementById('recommendations-list');
            listElement.innerHTML = recommendations.map(rec => `<li>${rec}</li>`).join('');
        }
        
        function updatePerformanceRadarChart() {
            const ctx = document.getElementById('performanceRadarChart');
            if (!ctx) return;
            
            // Destruir gr√°fico existente se houver
            if (window.performanceChart) {
                window.performanceChart.destroy();
            }
            
            const cpuScore = getComponentById('cpu', selectedComponents.cpu)?.performance_score || 0;
            const gpuScore = getComponentById('gpu', selectedComponents.gpu)?.performance_score || 0;
            const ramScore = getComponentById('ram', selectedComponents.ram)?.performance_score || 0;
            const storageScore = getComponentById('storage', selectedComponents.storage1)?.performance_score || 0;
            
            if (typeof Chart !== 'undefined') {
                window.performanceChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['CPU', 'GPU', 'RAM', 'Storage', 'Overall'],
                        datasets: [{
                            label: 'Performance Score',
                            data: [cpuScore, gpuScore, ramScore, storageScore, calculateTotalPerformance()],
                            backgroundColor: 'rgba(17, 138, 178, 0.2)',
                            borderColor: 'rgb(17, 138, 178)',
                            pointBackgroundColor: 'rgb(17, 138, 178)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(17, 138, 178)'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        elements: {
                            line: {
                                borderWidth: 2
                            }
                        },
                        scales: {
                            r: {
                                angleLines: {
                                    display: true
                                },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }
        }


        // EVENT LISTENERS
        function setupEventListeners() {
            document.getElementById('quality-slider').addEventListener('input', (event) => {
                const value = parseInt(event.target.value);
                applyQualityPreset(value);
                document.querySelectorAll('#quality-slider-section .flex span').forEach(span => span.classList.remove('quality-label-active'));
                document.getElementById(`quality-label-${value}`).classList.add('quality-label-active');
            });
            
            document.getElementById('ram-quantity-input').addEventListener('input', (event) => {
                let quantity = parseInt(event.target.value);
                const minRam = parseInt(document.getElementById('ram-quantity-input').min) || 1;
                const maxRam = parseInt(document.getElementById('ram-quantity-input').max) || 4; 
                if (isNaN(quantity) || quantity < minRam) quantity = minRam;
                if (quantity > maxRam) quantity = maxRam;
                selectedComponents.ram.quantity = quantity;
                event.target.value = quantity; 
                updateTotal();
                currentPresetName = "Personalizado"; document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;
            });

            document.getElementById('ram-type-select').addEventListener('change', (event) => {
                selectedComponents.ram.type = event.target.value || null;
                updateTotal();
                currentPresetName = "Personalizado"; document.getElementById('current-preset-display').textContent = `Preset Ativo: ${currentPresetName}`;
            });


            document.getElementById('assisted-mode-btn').addEventListener('click', () => {
                if (currentMode === 'assisted') return;
                currentMode = 'assisted';
                document.getElementById('assisted-mode-btn').classList.add('active');
                document.getElementById('basic-mode-btn').classList.remove('active');
                document.getElementById('advanced-mode-btn').classList.remove('active');
                
                // Mostrar modal de assist√™ncia
                const assistedModal = document.createElement('div');
                assistedModal.className = 'modal';
                assistedModal.style.display = 'flex';
                assistedModal.innerHTML = `
                    <div class="modal-content" style="max-width: 600px;">
                        <span class="close-button">√ó</span>
                        <h2 class="text-2xl font-bold mb-4"><i class="fas fa-robot text-[var(--color-primary)] mr-2"></i>Assistente de Configura√ß√£o</h2>
                        <p class="mb-4">Ol√°! Estou aqui para ajudar voc√™ a escolher o notebook ideal para suas necessidades.</p>
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold mb-2">Para qual finalidade voc√™ usar√° o notebook?</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="work"><i class="fas fa-briefcase mr-2"></i>Trabalho/Produtividade</button>
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="study"><i class="fas fa-graduation-cap mr-2"></i>Estudo</button>
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="gaming"><i class="fas fa-gamepad mr-2"></i>Jogos</button>
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="design"><i class="fas fa-paint-brush mr-2"></i>Design/Cria√ß√£o</button>
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="programming"><i class="fas fa-code mr-2"></i>Programa√ß√£o</button>
                                <button class="purpose-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-purpose="general"><i class="fas fa-laptop mr-2"></i>Uso Geral</button>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold mb-2">Qual √© o seu or√ßamento aproximado?</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <button class="budget-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-budget="low"><i class="fas fa-coins mr-2"></i>At√© R$ 3.000</button>
                                <button class="budget-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-budget="medium"><i class="fas fa-money-bill-wave mr-2"></i>R$ 3.000 a R$ 5.000</button>
                                <button class="budget-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-budget="high"><i class="fas fa-gem mr-2"></i>Acima de R$ 5.000</button>
                            </div>
                        </div>
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold mb-2">Voc√™ precisa de portabilidade?</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <button class="portability-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-portability="high"><i class="fas fa-suitcase mr-2"></i>Sim, levo para v√°rios lugares</button>
                                <button class="portability-btn p-3 border rounded-lg hover:bg-[var(--color-primary-light)] transition-all" data-portability="low"><i class="fas fa-home mr-2"></i>N√£o, uso principalmente em casa</button>
                            </div>
                        </div>
                        <button id="get-recommendation-btn" class="w-full btn btn-primary mt-4 py-3 font-bold text-lg"><i class="fas fa-magic mr-2"></i>Obter Recomenda√ß√£o</button>
                    </div>
                `;
                document.body.appendChild(assistedModal);
                
                const closeBtn = assistedModal.querySelector('.close-button');
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(assistedModal);
                    // Voltar para o modo b√°sico se o modal for fechado
                    document.getElementById('basic-mode-btn').click();
                });
                
                // Vari√°veis para armazenar as escolhas do usu√°rio
                let selectedPurpose = null;
                let selectedBudget = null;
                let selectedPortability = null;
                
                // Adicionar eventos aos bot√µes de finalidade
                const purposeBtns = assistedModal.querySelectorAll('.purpose-btn');
                purposeBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        purposeBtns.forEach(b => b.classList.remove('bg-[var(--color-primary-light)]'));
                        btn.classList.add('bg-[var(--color-primary-light)]');
                        selectedPurpose = btn.dataset.purpose;
                    });
                });
                
                // Adicionar eventos aos bot√µes de or√ßamento
                const budgetBtns = assistedModal.querySelectorAll('.budget-btn');
                budgetBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        budgetBtns.forEach(b => b.classList.remove('bg-[var(--color-primary-light)]'));
                        btn.classList.add('bg-[var(--color-primary-light)]');
                        selectedBudget = btn.dataset.budget;
                    });
                });
                
                // Adicionar eventos aos bot√µes de portabilidade
                const portabilityBtns = assistedModal.querySelectorAll('.portability-btn');
                portabilityBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        portabilityBtns.forEach(b => b.classList.remove('bg-[var(--color-primary-light)]'));
                        btn.classList.add('bg-[var(--color-primary-light)]');
                        selectedPortability = btn.dataset.portability;
                    });
                });
                
                // Adicionar evento ao bot√£o de obter recomenda√ß√£o
                const getRecommendationBtn = assistedModal.querySelector('#get-recommendation-btn');
                getRecommendationBtn.addEventListener('click', () => {
                    if (!selectedPurpose || !selectedBudget || !selectedPortability) {
                        // Usar um alerta mais amig√°vel
                        const alertDiv = document.createElement('div');
                        alertDiv.className = 'p-3 mb-4 bg-red-100 text-red-700 rounded-lg';
                        alertDiv.innerHTML = '<i class="fas fa-exclamation-circle mr-2"></i>Por favor, selecione todas as op√ß√µes para obter uma recomenda√ß√£o personalizada.';
                        
                        // Verificar se j√° existe um alerta e remov√™-lo
                        const existingAlert = assistedModal.querySelector('.bg-red-100');
                        if (existingAlert) {
                            existingAlert.remove();
                        }
                        
                        // Inserir o alerta no topo do conte√∫do do modal
                        const modalContent = assistedModal.querySelector('.modal-content');
                        modalContent.insertBefore(alertDiv, modalContent.firstChild.nextSibling);
                        return;
                    }
                    
                    // Fechar o modal
                    document.body.removeChild(assistedModal);
                    
                    // Aplicar preset com base nas escolhas do usu√°rio
                    let presetIndex = 1; // Padr√£o: Balanceado
                    
                    // L√≥gica para determinar o preset com base nas escolhas
                    if (selectedPurpose === 'gaming' || selectedPurpose === 'design') {
                        presetIndex = 2; // Performance
                    } else if (selectedBudget === 'low' || (selectedPortability === 'high' && selectedPurpose !== 'programming')) {
                        presetIndex = 0; // Econ√¥mico
                    }
                    
                    // Aplicar o preset recomendado
                    applyQualityPreset(presetIndex);
                    document.getElementById('quality-slider').value = presetIndex.toString();
                    document.querySelectorAll('#quality-slider-section .flex span').forEach(span => span.classList.remove('quality-label-active'));
                    document.getElementById(`quality-label-${presetIndex}`).classList.add('quality-label-active');
                    
                    // Mostrar recomenda√ß√£o ao usu√°rio
                    const recommendationModal = document.createElement('div');
                    recommendationModal.className = 'modal';
                    recommendationModal.style.display = 'flex';
                    
                    let presetName = '';
                    if (presetIndex === 0) presetName = 'Econ√¥mico';
                    else if (presetIndex === 1) presetName = 'Balanceado';
                    else presetName = 'Performance';
                    
                    let purposeText = '';
                    let purposeIcon = '';
                    if (selectedPurpose === 'work') { purposeText = 'trabalho e produtividade'; purposeIcon = 'fa-briefcase'; }
                    else if (selectedPurpose === 'study') { purposeText = 'estudo'; purposeIcon = 'fa-graduation-cap'; }
                    else if (selectedPurpose === 'gaming') { purposeText = 'jogos'; purposeIcon = 'fa-gamepad'; }
                    else if (selectedPurpose === 'design') { purposeText = 'design e cria√ß√£o'; purposeIcon = 'fa-paint-brush'; }
                    else if (selectedPurpose === 'programming') { purposeText = 'programa√ß√£o'; purposeIcon = 'fa-code'; }
                    else { purposeText = 'uso geral'; purposeIcon = 'fa-laptop'; }
                    
                    let presetDescription = '';
                    let presetIcon = '';
                    if (presetIndex === 0) {
                        presetDescription = 'Configura√ß√£o econ√¥mica ideal para tarefas b√°sicas com boa rela√ß√£o custo-benef√≠cio.';
                        presetIcon = 'fa-seedling';
                    } else if (presetIndex === 1) {
                        presetDescription = 'Configura√ß√£o equilibrada que atende √† maioria das necessidades com bom desempenho.';
                        presetIcon = 'fa-balance-scale';
                    } else {
                        presetDescription = 'Configura√ß√£o de alto desempenho para tarefas exigentes e multitarefa intensiva.';
                        presetIcon = 'fa-rocket';
                    }
                    
                    recommendationModal.innerHTML = `
                        <div class="modal-content" style="max-width: 600px;">
                            <span class="close-button">√ó</span>
                            <div class="text-center mb-4">
                                <i class="fas fa-check-circle text-4xl text-green-500 mb-2"></i>
                                <h2 class="text-2xl font-bold">Sua Recomenda√ß√£o Personalizada</h2>
                            </div>
                            <div class="bg-[var(--color-primary-light)] p-4 rounded-lg mb-4">
                                <div class="flex items-center mb-2">
                                    <i class="fas ${purposeIcon} text-[var(--color-primary)] mr-2"></i>
                                    <span>Finalidade: <strong>${purposeText}</strong></span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas ${presetIcon} text-[var(--color-primary)] mr-2"></i>
                                    <span>Configura√ß√£o recomendada: <strong>${presetName}</strong></span>
                                </div>
                            </div>
                            <p class="mb-4">${presetDescription}</p>
                            <p class="mb-4">Voc√™ pode ajustar os componentes individualmente conforme necess√°rio ou explorar outras op√ß√µes usando os controles abaixo.</p>
                            <p class="mb-4">Se precisar de mais ajuda, voc√™ pode voltar ao Modo Assistido a qualquer momento.</p>
                            <button class="w-full btn btn-primary mt-4 py-3 font-bold"><i class="fas fa-thumbs-up mr-2"></i>Entendi e Quero Continuar</button>
                        </div>
                    `;
                    document.body.appendChild(recommendationModal);
                    
                    const closeRecommendationBtn = recommendationModal.querySelector('.close-button');
                    const confirmRecommendationBtn = recommendationModal.querySelector('button');
                    
                    closeRecommendationBtn.addEventListener('click', () => {
                        document.body.removeChild(recommendationModal);
                    });
                    
                    confirmRecommendationBtn.addEventListener('click', () => {
                        document.body.removeChild(recommendationModal);
                    });
                    
                    // Voltar para o modo b√°sico ap√≥s aplicar a recomenda√ß√£o
                    document.getElementById('basic-mode-btn').click();
                    
                    // Garantir que as op√ß√µes sejam selecion√°veis
                    populateOptions();
                    updateVisualSelections();
                });
                
                toggleAdvancedModeTabs();
                populateOptions(); populateDetailedSoftwareOptions(); updateVisualSelections();
            });

            document.getElementById('basic-mode-btn').addEventListener('click', () => {
                if (currentMode === 'basic') return; currentMode = 'basic';
                document.getElementById('basic-mode-btn').classList.add('active'); 
                document.getElementById('advanced-mode-btn').classList.remove('active');
                document.getElementById('assisted-mode-btn').classList.remove('active');
                toggleAdvancedModeTabs();
                populateOptions(); populateDetailedSoftwareOptions(); updateVisualSelections();
            });

            document.getElementById('advanced-mode-btn').addEventListener('click', () => {
                if (currentMode === 'advanced') return; currentMode = 'advanced';
                document.getElementById('advanced-mode-btn').classList.add('active'); 
                document.getElementById('basic-mode-btn').classList.remove('active');
                document.getElementById('assisted-mode-btn').classList.remove('active');
                toggleAdvancedModeTabs();
                populateOptions(); populateDetailedSoftwareOptions(); updateVisualSelections();
            });
            
            // CORRECTION: Changed to use event.currentTarget for robustness.
            document.getElementById('software-tabs-container').addEventListener('click', (event) => {
                const button = event.target.closest('.software-tab-button');
                if (button) {
                    switchSoftwareTab(button.dataset.tab);
                }
            });

            document.getElementById('dualboot-checkbox').addEventListener('change', (e) => {
                updateDualBootUI();
                updateTotal(); 
            });
            document.getElementById('os2-select').addEventListener('change', (e) => {
                selectedComponents.os2 = e.target.value || null;
                updateTotal();
            });
            document.getElementById('dualboot-disk-select').addEventListener('change', (e) => {
                selectedComponents.dualboot_disk = e.target.value;
            });

            document.getElementById('calculate-tradein').addEventListener('click', () => {
                const conditionEl = document.getElementById('tradein-condition');
                const ageEl = document.getElementById('tradein-age');
                const specsEl = document.getElementById('tradein-specs');

                const condition = conditionEl.value;
                const age = ageEl.value;
                const specs = specsEl.value;
                let baseValue = 0;

                if (specs === 'high-end') baseValue = 900; 
                else if (specs === 'mid-range') baseValue = 450; 
                else baseValue = 150;

                if (age === '<1year') baseValue *= 0.9;
                else if (age === '1-2years') baseValue *= 0.7; 
                else if (age === '2-3years') baseValue *= 0.5; 
                else if (age === '>3years') baseValue *= 0.2;

                if (condition === 'excellent') baseValue *= 1;
                else if (condition === 'good') baseValue *= 0.8; 
                else if (condition === 'fair') baseValue *= 0.5; 
                else if (condition === 'poor') baseValue *= 0.15;

                tradeInCredit = Math.max(0, Math.round(baseValue / 10) * 10); 
                document.getElementById('tradein-value-display').textContent = `Valor Estimado: ${formatPrice(tradeInCredit)}`;
                updateTotal();
            });
            
            document.getElementById('upload-info-btn').addEventListener('click', () => {
                const fileInput = document.getElementById('system-info-file'); const file = fileInput.files[0];
                const resultDisplay = document.getElementById('file-evaluation-result');
                if (!file) { resultDisplay.textContent = "Por favor, selecione um arquivo."; resultDisplay.style.color = 'var(--color-accent-red)'; return; }
                
                resultDisplay.textContent = "Processando relat√≥rio..."; resultDisplay.style.color = 'var(--color-primary)';
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const content = e.target.result.toLowerCase(); 
                    let fileValue = Math.random() * 100 + 50; 
                    
                    if (content.includes('rtx 4090') || content.includes('rtx 4080ti') || content.includes('i9-14900') || content.includes('i9-13900') || content.includes('ryzen 9 7950') || content.includes('threadripper pro')) fileValue += 1200;
                    else if (content.includes('rtx 4080') || content.includes('rtx 3080ti') || content.includes('rtx 3090') || content.includes('rx 7900xtx') || content.includes('rx 6950xt')) fileValue += 900;
                    else if (content.includes('rtx 4070 ti') || content.includes('rtx 3080') || content.includes('rx 7900 xt') ||  content.includes('rx 6900 xt') || content.includes('i7-14700') || content.includes('i7-13700') || content.includes('ryzen 7 7800x3d')) fileValue += 600;
                    else if (content.includes('rtx 4060 ti') || content.includes('rtx 3070') || content.includes('rx 7800 xt')|| content.includes('rx 6800 xt')) fileValue += 450;
                     else if (content.includes('rtx 4060') || content.includes('rtx 3060ti') || content.includes('rx 7700 xt') || content.includes('rx 6700xt')) fileValue += 300;
                    
                    if (content.includes('64gb') && (content.includes('ddr5'))) fileValue += 350;
                    else if (content.includes('32gb') && (content.includes('ddr5') || content.includes('ddr4'))) fileValue += 200;
                    else if (content.includes('16gb') && (content.includes('ddr5') || content.includes('ddr4'))) fileValue += 100;
                    
                    if (content.includes('nvme') && (content.includes('pcie 5.0') || content.includes('gen5')) && (content.includes('2tb') || content.includes('4tb'))) fileValue += 250;
                    else if (content.includes('nvme') && (content.includes('pcie 4.0') || content.includes('gen4')) && (content.includes('2tb') || content.includes('4tb'))) fileValue += 180;
                    else if (content.includes('nvme') && (content.includes('pcie 4.0') || content.includes('gen4')) && content.includes('1tb')) fileValue += 120;
                    else if (content.includes('nvme') && content.includes('1tb')) fileValue += 80;


                    let estimatedPartsValue = fileValue; 
                    let tradeInOfferFromFile = estimatedPartsValue * 0.50; // Simulate 50% of market value of used parts

                    tradeInCredit = Math.max(tradeInCredit, Math.round(tradeInOfferFromFile / 10) * 10); 
                    document.getElementById('tradein-value-display').textContent = `Valor Estimado (Arquivo): ${formatPrice(tradeInCredit)}`;
                    resultDisplay.textContent = "Relat√≥rio processado! Cr√©dito de troca atualizado com base no arquivo (se maior que a estimativa anterior)."; 
                    resultDisplay.style.color = 'var(--color-secondary)';
                    updateTotal();
                };
                reader.onerror = () => { resultDisplay.textContent = "Erro ao ler o arquivo."; resultDisplay.style.color = 'var(--color-accent-red)';};
                reader.readAsText(file);
            });


            const whatsappButtonCart = document.getElementById('whatsapp-order-button');
            const finalizeConfigButtonFooter = document.getElementById('finalize-config-button');
            const orderModal = document.getElementById('order-modal');
            const modalCloseButton = document.getElementById('modal-close-button');
            const mainCloseButton = orderModal.querySelector('.close-button');

            const openConfigOrderModal = () => {
                let allRequiredSelected = true;
                // Removido 'network_adapter' dos campos obrigat√≥rios pois est√° integrado na placa-m√£e
                const requiredFields = ['platform', 'casing', 'motherboard', 'cpu', 'ram', 'storage1', 'gpu', 'display', 'keyboard', 'os', 'battery'];
                let missingFields = [];
                let modalMessageText = "";

                 if (activeTab !== 'configure'){
                    alert("Por favor, finalize sua configura√ß√£o na aba 'Configurar Novo' para usar este bot√£o.");
                    return;
                }

                requiredFields.forEach(cat => {
                    const fieldVal = (cat === 'ram') ? selectedComponents.ram.type : (cat === 'storage1' ? selectedComponents.storage1.type : selectedComponents[cat]);
                    if (!fieldVal) { 
                        allRequiredSelected = false; 
                        const fieldTranslations = { platform: "Plataforma", casing: "Carca√ßa", motherboard: "Placa M√£e", cpu: "CPU", ram: "Tipo de RAM", storage1: "Armazenamento Principal", gpu: "Placa de V√≠deo", display: "Tela", keyboard: "Teclado", os: "Sistema Operacional", battery: "Bateria"};
                        missingFields.push(fieldTranslations[cat] || cat);
                    }
                });
                
                const modalTitleEl = document.getElementById('modal-title');
                const modalMessageContentEl = document.getElementById('modal-message-content');
                const modalOrderSummaryEl = document.getElementById('modal-order-summary');
                modalOrderSummaryEl.innerHTML = '';

                if (!allRequiredSelected) {
                    modalTitleEl.textContent = "Campos Obrigat√≥rios Faltando";
                    modalMessageText = `<p class="text-[var(--color-accent-red)]"><strong>Aten√ß√£o:</strong> Para um or√ßamento preciso de um notebook novo, por favor, selecione todos os componentes obrigat√≥rios: <br><strong>${missingFields.join(', ')}</strong>.</p><p>Voc√™ ainda pode gerar uma mensagem para WhatsApp, mas o or√ßamento pode ser incompleto.</p>`;
                } else {
                    modalTitleEl.textContent = "Revis√£o do Pedido para WhatsApp";
                    modalMessageText = `<p>Seu pedido de or√ßamento para notebook est√° pronto. Verifique os itens abaixo:</p>`;
                }
                modalMessageContentEl.innerHTML = modalMessageText;

                let message = `Ol√° DeiviTech! Gostaria de solicitar um or√ßamento para o seguinte notebook personalizado:\n\n*CONFIGURA√á√ÉO DEIVITECH:*\n`;
                const getCompName = (cat, id) => getComponentById(cat, id)?.name || 'N/A';

                const addMsg = (label, value) => { if (value && value !== 'N/A') message += `* ${label}: ${value}\n`; };
                
                if(selectedComponents.platform) addMsg('Plataforma', getCompName('platform',selectedComponents.platform));
                if(selectedComponents.casing) addMsg('Carca√ßa', getCompName('casing',selectedComponents.casing));
                if(selectedComponents.motherboard) addMsg('Placa M√£e', getCompName('motherboard',selectedComponents.motherboard));
                if(selectedComponents.cpu) addMsg('CPU', getCompName('cpu',selectedComponents.cpu));
                if (selectedComponents.ram.type) addMsg('RAM', `${selectedComponents.ram.quantity}x ${getCompName('ram',selectedComponents.ram.type)}`);
                if (selectedComponents.storage1.type) addMsg('Armazenamento 1', getCompName('storage',selectedComponents.storage1.type));
                if (selectedComponents.storage2.type && selectedComponents.storage2.type !== 'none') addMsg('Armazenamento 2', getCompName('storage',selectedComponents.storage2.type));
                else if (selectedComponents.storage2.type === 'none' && selectedComponents.platform) addMsg('Armazenamento 2', 'Nenhum'); 
                
                if(selectedComponents.gpu) addMsg('GPU', getCompName('gpu',selectedComponents.gpu));
                if(selectedComponents.display) addMsg('Tela', getCompName('display',selectedComponents.display));
                if(selectedComponents.keyboard) addMsg('Teclado', getCompName('keyboard',selectedComponents.keyboard));
                if(selectedComponents.os) addMsg('Sistema Op.', getCompName('os',selectedComponents.os));
                if (document.getElementById('dualboot-checkbox').checked && selectedComponents.os2) {
                    addMsg('Dual Boot com', getCompName('os', selectedComponents.os2) + (selectedComponents.dualboot_disk === 'additional' ? ' (em disco adicional)' : ' (mesmo disco)'));
                }
                if (selectedComponents.software.length > 0) { 
                    addMsg('Software Adicional', selectedComponents.software.map(id => getComponentById('software', id)?.name).filter(name => name).join(', '));
                }
                if(selectedComponents.network_adapter) addMsg('Rede Wi-Fi/BT', getCompName('network_adapter',selectedComponents.network_adapter));
                if(selectedComponents.battery) addMsg('Bateria', getCompName('battery',selectedComponents.battery));
                if (selectedComponents.peripherals.length > 0) { addMsg('Perif√©ricos', selectedComponents.peripherals.map(id => getCompName('peripherals', id)).join(', ')); }
                else if (selectedComponents.platform) { addMsg('Perif√©ricos', 'Nenhum'); }

                if (tradeInCredit > 0) message += `\n* Cr√©dito de Troca Solicitado/Estimado: ${formatPrice(tradeInCredit)}\n`;
                const totalPrice = parseFloat(document.getElementById('total-price-display').textContent.replace('R$ ', '').replace('.', '').replace(',', '.'));
                message += `\n*OR√áAMENTO TOTAL ESTIMADO DO NOTEBOOK: ${formatPrice(totalPrice)}*\n`;
                
                if (!allRequiredSelected) {
                     message += `\n*AVISO: Alguns componentes obrigat√≥rios n√£o foram selecionados (${missingFields.join(', ')}). Este or√ßamento pode estar incompleto.*\n`;
                }
                if (currentPresetName !== "Personalizado") {
                    message += `\nPreset Base Utilizado: ${currentPresetName}\n`;
                }
                message += `\nAguardo o contato para confirma√ß√£o e pr√≥ximos passos!`;

                modalOrderSummaryEl.innerHTML = message.replace(/\n/g, '<br>').replace(/\*(.*?)\*/g, '<strong>$1</strong>');
                
                let sendToWhatsAppButton = orderModal.querySelector('#send-whatsapp-btn');
                if (sendToWhatsAppButton) sendToWhatsAppButton.remove(); 

                sendToWhatsAppButton = document.createElement('button');
                sendToWhatsAppButton.id = 'send-whatsapp-btn';
                sendToWhatsAppButton.className = 'mt-4 w-full btn btn-primary flex items-center justify-center';
                sendToWhatsAppButton.innerHTML = '<i class="fab fa-whatsapp mr-2"></i> Confirmar e Enviar para WhatsApp';
                
                const modalCloseButtonEl = document.getElementById('modal-close-button');
                modalCloseButtonEl.parentNode.insertBefore(sendToWhatsAppButton, modalCloseButtonEl);
                
                sendToWhatsAppButton.onclick = () => {
                    const whatsappUrl = `https://wa.me/5575981231019?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                    orderModal.style.display = 'none';
                };
                
                document.getElementById('modal-total-price').textContent = document.getElementById('total-price-display').textContent;
                orderModal.style.display = 'flex';
            }

            whatsappButtonCart.addEventListener('click', openConfigOrderModal);
            finalizeConfigButtonFooter.addEventListener('click', openConfigOrderModal);


            mainCloseButton.addEventListener('click', () => { orderModal.style.display = 'none'; });
            modalCloseButton.addEventListener('click', () => { orderModal.style.display = 'none'; });
            window.addEventListener('click', (event) => { if (event.target === orderModal) orderModal.style.display = 'none'; });

            document.getElementById('login-placeholder-btn').addEventListener('click', () => {
                const loginModal = document.createElement('div');
                loginModal.className = 'modal';
                loginModal.style.display = 'flex';
                loginModal.innerHTML = `
                    <div class="modal-content" style="max-width: 450px;">
                        <span class="close-button">√ó</span>
                        <h2 class="text-2xl font-bold mb-4">Em Breve</h2>
                        <p class="mb-4">Futuramente, esta √°rea permitir√° que voc√™ acesse seu hist√≥rico de or√ßamentos e configura√ß√µes.</p>
                        <p class="mb-4">Para trocas de notebooks, o login poder√° agilizar o processo de autentica√ß√£o e avalia√ß√£o do seu equipamento antigo.</p>
                        <p class="mb-4">Fique de olho nas atualiza√ß√µes!</p>
                        <button class="w-full btn btn-primary mt-4">Entendi</button>
                    </div>
                `;
                document.body.appendChild(loginModal);
                
                const closeBtn = loginModal.querySelector('.close-button');
                const confirmBtn = loginModal.querySelector('button');
                
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(loginModal);
                });
                
                confirmBtn.addEventListener('click', () => {
                    document.body.removeChild(loginModal);
                });
                
                loginModal.addEventListener('click', (e) => {
                    if (e.target === loginModal) {
                        document.body.removeChild(loginModal);
                    }
                });
            });

            document.getElementById('whatsapp-services-order-button').addEventListener('click', () => {
                let message = "Ol√° DeiviTech! Gostaria de solicitar um or√ßamento para os seguintes servi√ßos:\n\n";
                let servicesTotal = 0;
                if (selectedServices.length === 0) {
                    message += "Nenhum servi√ßo selecionado para or√ßamento no momento.\nSe desejar, pode descrever o servi√ßo que precisa aqui.";
                } else {
                    selectedServices.forEach(serviceId => {
                        const service = getServiceById(serviceId);
                        if (service) {
                            message += `* ${service.name}${service.id === 'serv-iptv-test' ? ' (Teste Gr√°tis)' : ` - ${formatPrice(service.basePrice)}`}\n`;
                            servicesTotal += service.basePrice;
                        }
                    });
                     if (selectedServices.length > 0 && !(selectedServices.length === 1 && selectedServices[0] === 'serv-iptv-test')) { // Dont show total if only IPTV test
                        message += `\n*TOTAL ESTIMADO DOS SERVI√áOS: ${formatPrice(servicesTotal)}*\n`;
                     }
                }
                message += "\nAguardo contato para mais detalhes e agendamento.";
                const whatsappUrl = `https://wa.me/5575981231019?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            });

            document.getElementById('send-specific-budget-request').addEventListener('click', () => {
                const requestText = document.getElementById('specific-budget-request').value;
                if (!requestText.trim()) {
                    alert("Por favor, descreva sua solicita√ß√£o no campo de texto.");
                    return;
                }
                let message = "Ol√° DeiviTech! Tenho uma solicita√ß√£o de or√ßamento espec√≠fico:\n\n";
                message += requestText.trim();
                message += "\n\nAguardo contato para discutirmos as possibilidades.";
                const whatsappUrl = `https://wa.me/5575981231019?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            });

            const themeToggleButton = document.getElementById('theme-toggle');
            const body = document.body;
            const themeIcon = themeToggleButton.querySelector('i');
             // Function to get the RGB values for a CSS variable (simplified, assumes hex or direct rgb)
            const getRgbFromCssVar = (cssVarName) => {
                const colorValue = getComputedStyle(body).getPropertyValue(cssVarName).trim();
                if (colorValue.startsWith('#')) { // Hex
                    const r = parseInt(colorValue.substring(1, 3), 16);
                    const g = parseInt(colorValue.substring(3, 5), 16);
                    const b = parseInt(colorValue.substring(5, 7), 16);
                    return `${r}, ${g}, ${b}`;
                } else if (colorValue.startsWith('rgb')) { // rgb(a)
                    return colorValue.match(/\(([^)]+)\)/)[1];
                }
                return '6, 214, 160'; // Default fallback
            };


            const currentTheme = localStorage.getItem('theme');
            if (currentTheme === 'dark') {
                body.classList.add('dark-mode');
                themeIcon.classList.remove('fa-lightbulb');
                themeIcon.classList.add('fa-moon');
            } else {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-lightbulb');
            }
            body.style.setProperty('--color-secondaryRgbForAlpha', getRgbFromCssVar('--color-secondary'));


            themeToggleButton.addEventListener('click', function() {
                body.classList.toggle('dark-mode');
                if (body.classList.contains('dark-mode')) {
                    localStorage.setItem('theme', 'dark');
                    themeIcon.classList.remove('fa-lightbulb');
                    themeIcon.classList.add('fa-moon');
                } else {
                    localStorage.setItem('theme', 'light');
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-lightbulb');
                }
                body.style.setProperty('--color-secondaryRgbForAlpha', getRgbFromCssVar('--color-secondary'));
                
                // Force repaint para garantir que as mudan√ßas de estilo sejam aplicadas
                document.documentElement.style.display = 'none';
                document.documentElement.offsetHeight; // Trigger reflow
                document.documentElement.style.display = '';
            });
        }

        // Fun√ß√£o para atualizar o painel integrado de recursos
        function updateIntegratedDisplay() {
            const integratedBar = document.getElementById('integrated-performance-bar');
            const integratedText = document.getElementById('integrated-performance-text');
            const integratedPercentage = document.getElementById('integrated-performance-percentage');
            const integratedComponentsList = document.getElementById('integrated-components-list');
            const integratedTotalPrice = document.getElementById('integrated-total-price');
            
            // Obter a porcentagem de desempenho do elemento principal
            const mainBar = document.getElementById('performance-bar');
            const mainText = document.getElementById('performance-text-display');
            
            if (mainBar && integratedBar) {
                const percentage = mainBar.style.width;
                integratedBar.style.width = percentage;
                integratedBar.style.backgroundColor = mainBar.style.backgroundColor;
                if (integratedPercentage) {
                    integratedPercentage.textContent = mainBar.textContent;
                }
            }
            
            if (mainText && integratedText) {
                integratedText.textContent = mainText.textContent;
            }
            
            // Atualizar a lista de componentes
            if (integratedComponentsList) {
                integratedComponentsList.innerHTML = '';
                
                // Adicionar componentes principais
                const componentsToShow = [
                    { category: 'cpu', label: 'CPU', icon: 'fas fa-microchip' },
                    { category: 'gpu', label: 'GPU', icon: 'fas fa-gamepad' },
                    { category: 'ram', label: 'RAM', isRam: true, icon: 'fas fa-microchip' },
                    { category: 'storage1', label: 'SSD', isStorage: true, icon: 'fas fa-hdd' },
                    { category: 'display', label: 'Tela', icon: 'fas fa-desktop' },
                    { category: 'os', label: 'S.O.', icon: 'fas fa-window-maximize' }
                ];
                
                componentsToShow.forEach(comp => {
                    let componentName = 'N√£o selecionado';
                    let componentIcon = comp.icon || '';
                    let componentStatus = 'text-gray-400';
                    
                    if (comp.isRam && selectedComponents.ram.type) {
                        const ramItem = getComponentById('ram', selectedComponents.ram.type);
                        if (ramItem) {
                            componentName = `${ramItem.name} (${selectedComponents.ram.quantity}x)`;
                            componentIcon = ramItem.icon || componentIcon;
                            componentStatus = 'text-[var(--color-text-card)]';
                        }
                    } else if (comp.isStorage && selectedComponents.storage1.type) {
                        const storageItem = getComponentById('storage', selectedComponents.storage1.type);
                        if (storageItem) {
                            componentName = storageItem.name;
                            componentIcon = storageItem.icon || componentIcon;
                            componentStatus = 'text-[var(--color-text-card)]';
                        }
                    } else if (selectedComponents[comp.category]) {
                        const item = getComponentById(comp.category, selectedComponents[comp.category]);
                        if (item) {
                            componentName = item.name;
                            componentIcon = item.icon || componentIcon;
                            componentStatus = 'text-[var(--color-text-card)]';
                        }
                    }
                    
                    const componentEl = document.createElement('div');
                    componentEl.className = `flex items-center ${componentStatus} mb-1 pb-1 border-b border-gray-100 dark:border-gray-800`;
                    componentEl.innerHTML = `
                        <i class="${componentIcon} mr-2 text-[var(--color-primary)]"></i>
                        <div class="flex flex-col">
                            <span class="font-semibold text-xs">${comp.label}</span>
                            <span class="text-xs truncate">${componentName}</span>
                        </div>
                    `;
                    integratedComponentsList.appendChild(componentEl);
                });
            }
            
            // Atualizar o pre√ßo total
            if (integratedTotalPrice) {
                integratedTotalPrice.textContent = document.getElementById('total-price-display').textContent;
            }
        }
        
        // Fun√ß√£o para inicializar os gr√°ficos na aba de conceito
        function initNotebookCharts() {
            // Verifica se o Chart.js j√° foi carregado
            if (typeof Chart === 'undefined') {
                // Se n√£o estiver carregado, carrega dinamicamente
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
                script.onload = function() {
                    // Verifica novamente se o Chart.js foi carregado corretamente
                    if (typeof Chart !== 'undefined') {
                        createCharts();
                    } else {
                        console.error('Erro ao carregar Chart.js');
                    }
                };
                script.onerror = function() {
                    console.error('Falha ao carregar Chart.js');
                };
                document.head.appendChild(script);
            } else {
                // Se j√° estiver carregado, cria os gr√°ficos
                createCharts();
            }
        }
          function createCharts() {
            try {
                // Limpa gr√°ficos existentes para evitar duplica√ß√£o
                if (Chart.instances && Chart.instances.length > 0) {
                    Chart.helpers.each(Chart.instances, function(instance) {
                        instance.destroy();
                    });
                }
            
            // Gr√°fico 1: CPU Mobile vs Desktop - Efici√™ncia Energ√©tica
            const cpuEfficiencyCtx = document.getElementById('cpuEfficiencyChart');
            if (cpuEfficiencyCtx && cpuEfficiencyCtx.getContext) {
                new Chart(cpuEfficiencyCtx, {
                    type: 'bar',
                    data: {
                        labels: ['i3 Mobile', 'i5 Mobile', 'i7 Mobile', 'i5 Desktop', 'i7 Desktop'],
                        datasets: [{
                            label: 'Performance Score',
                            data: [40, 65, 85, 70, 100],
                            backgroundColor: 'rgba(17, 138, 178, 0.7)',
                            borderColor: 'rgb(17, 138, 178)',
                            borderWidth: 1
                        }, {
                            label: 'Consumo (W)',
                            data: [15, 28, 45, 65, 95],
                            backgroundColor: 'rgba(255, 107, 107, 0.7)',
                            borderColor: 'rgb(255, 107, 107)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Score / Watts'
                                }
                            }
                        }
                    }
                });
            }
            
            // Gr√°fico 2: Autonomia de Bateria por Tipo de Uso
            const batteryLifeCtx = document.getElementById('batteryLifeChart');
            if (batteryLifeCtx && batteryLifeCtx.getContext) {
                new Chart(batteryLifeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Navega√ß√£o Web', 'Escrit√≥rio', 'V√≠deo Streaming', 'Gaming', 'Renderiza√ß√£o'],
                        datasets: [{
                            data: [10, 8, 6, 3, 2],
                            backgroundColor: [
                                'rgba(6, 214, 160, 0.8)',
                                'rgba(17, 138, 178, 0.8)',
                                'rgba(255, 209, 102, 0.8)',
                                'rgba(255, 107, 107, 0.8)',
                                'rgba(153, 102, 255, 0.8)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
            
            // Gr√°fico 3: Performance GPUs Mobile - Gaming 1080p
            const gpuPerformanceCtx = document.getElementById('gpuPerformanceChart');
            if (gpuPerformanceCtx && gpuPerformanceCtx.getContext) {
                new Chart(gpuPerformanceCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Integrada', 'GTX 1650M', 'RTX 3050M', 'RTX 4060M', 'RTX 4070M'],
                        datasets: [{
                            label: 'FPS M√©dio (1080p)',
                            data: [25, 45, 60, 80, 95],
                            backgroundColor: 'rgba(76, 175, 80, 0.7)',
                            borderColor: 'rgb(76, 175, 80)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'FPS'
                                }
                            }
                        }
                    }
                });
            }
            
            // Gr√°fico 4: Velocidade de Armazenamento
            const storageSpeedCtx = document.getElementById('storageSpeedChart');
            if (storageSpeedCtx && storageSpeedCtx.getContext) {
                new Chart(storageSpeedCtx, {
                    type: 'line',
                    data: {
                        labels: ['HDD 5400', 'HDD 7200', 'SSD SATA', 'NVMe Gen3', 'NVMe Gen4', 'NVMe Gen5'],
                        datasets: [{
                            label: 'Velocidade de Leitura (MB/s)',
                            data: [80, 120, 550, 3500, 7000, 12000],
                            borderColor: 'rgb(255, 193, 7)',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'MB/s'
                                }
                            }
                        }
                    }
                });            }
            
            } catch (error) {
                console.error('Erro ao criar gr√°ficos:', error);
            }
        }
        
        // INITIALIZATION on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            showTab('concept'); 
            applyQualityPreset(1); 
            document.getElementById('quality-slider').value = "1";
            document.querySelectorAll('#quality-slider-section .flex span').forEach(span => span.classList.remove('quality-label-active'));
            document.getElementById(`quality-label-1`).classList.add('quality-label-active');
            
            populateOptions(); 
            populateDetailedSoftwareOptions(); 
            setupEventListeners();
            updateTotal(); 
            updateVisualSelections(); 
            observeSections(); 
            toggleAdvancedModeTabs(); 
            switchSoftwareTab('multimedia'); // Set initial software sub-tab
            
            // Inicializar o painel integrado
            updateIntegratedDisplay();
        });
        
        // --- GEMINI API INTEGRATION ---
        async function callGemini(prompt, outputElement, buttonElement) {
            outputElement.textContent = 'Analisando...';
            buttonElement.disabled = true;
            
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                    outputElement.textContent = result.candidates[0].content.parts[0].text;
                } else {
                     outputElement.textContent = "Erro ao obter resposta da IA. Verifique o console.";
                     console.error("API Response Error:", result);
                }
            } catch(error) {
                outputElement.textContent = "Falha na comunica√ß√£o com a IA.";
                console.error("Fetch Error:", error);
            } finally {
                buttonElement.disabled = false;
            }
        }
        
        function setupAIIntegration() {
            const analyzeBtn = document.getElementById('analyzeBtn');
            const upgradeBtn = document.getElementById('upgradeBtn');
            const aiResultDiv = document.getElementById('ai-result');
            const upgradeResultDiv = document.getElementById('upgrade-result');
            
            if (analyzeBtn && upgradeBtn) {                analyzeBtn.addEventListener('click', () => {
                    // Construir informa√ß√µes do hardware baseado nos componentes selecionados
                    const cpu = selectedComponents.cpu ? getComponentById('cpu', selectedComponents.cpu)?.name || 'CPU n√£o selecionada' : 'CPU n√£o selecionada';
                    const ram = selectedComponents.ram ? `${selectedComponents.ram.quantity || '1'}x ${getComponentById('ram', selectedComponents.ram)?.name || 'RAM n√£o selecionada'}` : 'RAM n√£o selecionada';
                    const gpu = selectedComponents.gpu ? getComponentById('gpu', selectedComponents.gpu)?.name || 'GPU n√£o selecionada' : 'GPU n√£o selecionada';
                    const storage = selectedComponents.storage1 ? getComponentById('storage', selectedComponents.storage1)?.name || 'Armazenamento n√£o selecionado' : 'Armazenamento n√£o selecionado';
                    
                    const hardwareInfo = `CPU: ${cpu}, RAM: ${ram}, GPU: ${gpu}, Armazenamento: ${storage}`;
                    const performanceScore = `Score de Performance Total: ${calculateTotalPerformance()}`;
                    
                    const prompt = `Aja como um analista de hardware de PC. Com base nos dados a seguir, identifique o principal gargalo de performance em jogos e explique o porqu√™ de forma concisa (2-3 frases). Hardware: ${hardwareInfo}. ${performanceScore}. Responda em portugu√™s.`;
                    callGemini(prompt, aiResultDiv, analyzeBtn);
                });                upgradeBtn.addEventListener('click', () => {
                    // Construir informa√ß√µes do hardware baseado nos componentes selecionados
                    const cpu = selectedComponents.cpu ? getComponentById('cpu', selectedComponents.cpu)?.name || 'CPU n√£o selecionada' : 'CPU n√£o selecionada';
                    const ram = selectedComponents.ram ? `${selectedComponents.ram.quantity || '1'}x ${getComponentById('ram', selectedComponents.ram)?.name || 'RAM n√£o selecionada'}` : 'RAM n√£o selecionada';
                    const gpu = selectedComponents.gpu ? getComponentById('gpu', selectedComponents.gpu)?.name || 'GPU n√£o selecionada' : 'GPU n√£o selecionada';
                    const storage = selectedComponents.storage1 ? getComponentById('storage', selectedComponents.storage1)?.name || 'Armazenamento n√£o selecionado' : 'Armazenamento n√£o selecionado';
                    
                    const hardwareInfo = `CPU: ${cpu}, RAM: ${ram}, GPU: ${gpu}, Armazenamento: ${storage}`;
                    const budget = 'Or√ßamento para upgrade: R$ 1500,00';
                    
                    const prompt = `Aja como um especialista em hardware de PC. Para o sistema ${hardwareInfo}, qual √© a recomenda√ß√£o de upgrade com melhor custo-benef√≠cio para um salto significativo em performance? Considere ${budget}. Sugira componentes espec√≠ficos e explique brevemente o motivo. Responda em portugu√™s.`;
                    callGemini(prompt, upgradeResultDiv, upgradeBtn);
                });
            }
        }
        
        // Inicializar integra√ß√£o com IA quando a aba for exibida
        document.getElementById('tab-ai-integration').addEventListener('click', () => {
            // Pequeno atraso para garantir que os elementos estejam renderizados
            setTimeout(() => {
                setupAIIntegration();
                initializeAICharts();
            }, 100);
        });
        
        // Inicializar os gr√°ficos na aba de integra√ß√£o com IA
        function initializeAICharts() {
            // Gr√°fico de performance em jogos
            const gamingChartCtx = document.getElementById('gaming-chart');
            if (gamingChartCtx && gamingChartCtx.getContext) {
                // Verificar se j√° existe um gr√°fico e destru√≠-lo
                if (window.gamingChart instanceof Chart) {
                    window.gamingChart.destroy();
                }
                
                // Calcular valores baseados na performance atual
                const performanceScore = calculateTotalPerformance();
                const multiplier = performanceScore / 100;
                
                window.gamingChart = new Chart(gamingChartCtx, {
                    type: 'bar',
                    data: {
                        labels: ['CS:GO', 'Fortnite', 'Cyberpunk 2077', 'Minecraft', 'GTA V', 'Valorant'],
                        datasets: [{
                            label: 'FPS Estimado (1080p)',
                            data: [
                                Math.round(240 * multiplier),
                                Math.round(180 * multiplier),
                                Math.round(80 * multiplier),
                                Math.round(200 * multiplier),
                                Math.round(120 * multiplier),
                                Math.round(220 * multiplier)
                            ],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.7)',
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(255, 206, 86, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)',
                                'rgba(255, 159, 64, 0.7)'
                            ],
                            borderColor: [
                                'rgb(255, 99, 132)',
                                'rgb(54, 162, 235)',
                                'rgb(255, 206, 86)',
                                'rgb(75, 192, 192)',
                                'rgb(153, 102, 255)',
                                'rgb(255, 159, 64)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'FPS'
                                }
                            }
                        }
                    }
                });
            }
            
            // Gr√°fico de comparativo de sistemas operacionais
            const osChartCtx = document.getElementById('os-chart');
            if (osChartCtx && osChartCtx.getContext) {
                // Verificar se j√° existe um gr√°fico e destru√≠-lo
                if (window.osChart instanceof Chart) {
                    window.osChart.destroy();
                }
                
                window.osChart = new Chart(osChartCtx, {
                    type: 'radar',
                    data: {
                        labels: ['Jogos', 'Produtividade', 'Compatibilidade', 'Desempenho', 'Personaliza√ß√£o', 'Seguran√ßa'],
                        datasets: [
                            {
                                label: 'Windows',
                                data: [90, 85, 95, 80, 70, 75],
                                fill: true,
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                borderColor: 'rgb(54, 162, 235)',
                                pointBackgroundColor: 'rgb(54, 162, 235)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(54, 162, 235)'
                            },
                            {
                                label: 'Linux',
                                data: [70, 80, 65, 90, 95, 85],
                                fill: true,
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                borderColor: 'rgb(255, 99, 132)',
                                pointBackgroundColor: 'rgb(255, 99, 132)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(255, 99, 132)'
                            },
                            {
                                label: 'macOS',
                                data: [50, 90, 75, 85, 80, 90],
                                fill: true,
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                borderColor: 'rgb(75, 192, 192)',
                                pointBackgroundColor: 'rgb(75, 192, 192)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(75, 192, 192)'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        elements: {
                            line: {
                                borderWidth: 3
                            }
                        },
                        scales: {
                            r: {
                                angleLines: {
                                    display: true
                                },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>
